(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9712],{3070:(e,s,a)=>{"use strict";a.d(s,{Jd:()=>o,Nu:()=>h,Qc:()=>m,Tk:()=>u,iY:()=>x,kp:()=>d,xJ:()=>j});var r=a(32960),t=a(26715),l=a(5041),i=a(56671),c=a(25667);let n={all:["users"],lists:()=>[...n.all,"list"],list:e=>[...n.lists(),{filters:e}],details:()=>[...n.all,"detail"],detail:e=>[...n.details(),e],current:()=>[...n.all,"current"],sessions:e=>[...n.all,"sessions",e],audit:e=>[...n.all,"audit",e]};function d(e){return(0,r.I)({queryKey:n.list(null==e?void 0:e.filters),queryFn:()=>c.Dv.getUsers(e),staleTime:3e5,gcTime:6e5})}function o(e){let s=!(arguments.length>1)||void 0===arguments[1]||arguments[1];return(0,r.I)({queryKey:n.detail(e),queryFn:()=>c.Dv.getUserById(e),enabled:s&&!!e,staleTime:3e5,gcTime:6e5})}function u(){let e=(0,t.jE)();return(0,l.n)({mutationFn:e=>c.Dv.createUser(e),onSuccess:s=>{e.invalidateQueries({queryKey:n.lists()}),e.setQueryData(n.detail(s.id),s),i.o.success("Usu\xe1rio criado com sucesso!")},onError:e=>{var s,a;let r=(null==e||null==(a=e.response)||null==(s=a.data)?void 0:s.detail)||"Erro ao criar usu\xe1rio";i.o.error(r)}})}function m(){let e=(0,t.jE)();return(0,l.n)({mutationFn:e=>{let{id:s,userData:a}=e;return c.Dv.updateUser(s,a)},onSuccess:s=>{e.setQueryData(n.detail(s.id),s),e.invalidateQueries({queryKey:n.lists()});let a=e.getQueryData(n.current());a&&a.id===s.id&&e.setQueryData(n.current(),s),i.o.success("Usu\xe1rio atualizado com sucesso!")},onError:e=>{var s,a;let r=(null==e||null==(a=e.response)||null==(s=a.data)?void 0:s.detail)||"Erro ao atualizar usu\xe1rio";i.o.error(r)}})}function x(){let e=(0,t.jE)();return(0,l.n)({mutationFn:e=>c.Dv.deleteUser(e),onSuccess:(s,a)=>{e.removeQueries({queryKey:n.detail(a)}),e.invalidateQueries({queryKey:n.lists()}),i.o.success("Usu\xe1rio removido com sucesso!")},onError:e=>{var s,a;let r=(null==e||null==(a=e.response)||null==(s=a.data)?void 0:s.detail)||"Erro ao remover usu\xe1rio";i.o.error(r)}})}function h(){let e=(0,t.jE)();return(0,l.n)({mutationFn:e=>{let{id:s,isActive:a}=e;return c.Dv.toggleUserStatus(s,a)},onSuccess:s=>{e.setQueryData(n.detail(s.id),s),e.invalidateQueries({queryKey:n.lists()});let a=s.is_active?"ativado":"desativado";i.o.success("Usu\xe1rio ".concat(a," com sucesso!"))},onError:e=>{var s,a;let r=(null==e||null==(a=e.response)||null==(s=a.data)?void 0:s.detail)||"Erro ao alterar status do usu\xe1rio";i.o.error(r)}})}function j(){let e=(0,t.jE)();return(0,l.n)({mutationFn:e=>c.Dv.unlockUser(e),onSuccess:s=>{e.setQueryData(n.detail(s.id),s),e.invalidateQueries({queryKey:n.lists()}),i.o.success("Conta desbloqueada com sucesso!")},onError:e=>{var s,a;let r=(null==e||null==(a=e.response)||null==(s=a.data)?void 0:s.detail)||"Erro ao desbloquear conta";i.o.error(r)}})}},4197:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>C});var r=a(95155),t=a(12115),l=a(35695),i=a(1243),c=a(71007),n=a(35169),d=a(13717),o=a(62525),u=a(75525),m=a(79397),x=a(69803),h=a(3070),j=a(55502),p=a(97168),v=a(88145),N=a(88482),y=a(34964),g=a(27737),f=a(69663),b=a(76037),w=a(6874),E=a.n(w),A=a(56671),T=a(63008),k=a(4573);function C(){let e=(0,l.useParams)(),s=(0,l.useRouter)(),a=e.id,{getUserById:w,deleteUser:C,toggleUserStatus:D,resetPassword:S}=(0,h.kp)(),{getUserPermissions:F}=(0,j.Sk)(),{data:U,isLoading:q,error:R}=w(a),{data:Q,isLoading:Z}=F(a),[L,P]=(0,t.useState)(!1),z=async()=>{if(U&&window.confirm('Tem certeza que deseja excluir o usu\xe1rio "'.concat(U.name,'"? Esta a\xe7\xe3o n\xe3o pode ser desfeita.'))){P(!0);try{await C.mutateAsync(a),A.o.success("Usu\xe1rio exclu\xeddo com sucesso!"),s.push("/dashboard/users")}catch(e){A.o.error("Erro ao excluir usu\xe1rio")}finally{P(!1)}}},_=async()=>{if(U)try{await D.mutateAsync({userId:a,status:"active"===U.status?"inactive":"active"}),A.o.success("Status do usu\xe1rio atualizado!")}catch(e){A.o.error("Erro ao atualizar status")}},K=async()=>{if(U&&window.confirm('Tem certeza que deseja resetar a senha de "'.concat(U.name,'"? Uma nova senha ser\xe1 enviada por email.')))try{await S.mutateAsync(a),A.o.success("Senha resetada! Nova senha enviada por email.")}catch(e){A.o.error("Erro ao resetar senha")}};return R?(0,r.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,r.jsx)(N.Zp,{className:"border-red-200 bg-red-50",children:(0,r.jsx)(N.Wu,{className:"pt-6",children:(0,r.jsxs)("div",{className:"text-center text-red-600",children:[(0,r.jsx)(i.A,{className:"mx-auto h-12 w-12 mb-4"}),(0,r.jsx)("p",{className:"font-medium",children:"Erro ao carregar usu\xe1rio"}),(0,r.jsx)("p",{className:"text-sm mt-1",children:R.message}),(0,r.jsx)(p.$,{variant:"outline",className:"mt-4",onClick:()=>s.push("/dashboard/users"),children:"Voltar para Lista"})]})})})}):q?(0,r.jsxs)("div",{className:"container mx-auto px-4 py-8 space-y-6",children:[(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsx)(g.E,{className:"h-10 w-10"}),(0,r.jsx)(g.E,{className:"h-8 w-64"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,r.jsxs)("div",{className:"lg:col-span-2 space-y-6",children:[(0,r.jsx)(g.E,{className:"h-64 w-full"}),(0,r.jsx)(g.E,{className:"h-96 w-full"})]}),(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsx)(g.E,{className:"h-48 w-full"}),(0,r.jsx)(g.E,{className:"h-32 w-full"})]})]})]}):U?(0,r.jsxs)("div",{className:"container mx-auto px-4 py-8 space-y-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsx)(p.$,{variant:"ghost",size:"icon",onClick:()=>s.push("/dashboard/users"),children:(0,r.jsx)(n.A,{className:"h-4 w-4"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:U.name}),(0,r.jsx)("p",{className:"text-gray-600",children:U.email})]})]}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)(E(),{href:"/dashboard/users/".concat(a,"/edit"),children:(0,r.jsxs)(p.$,{variant:"outline",className:"gap-2",children:[(0,r.jsx)(d.A,{className:"h-4 w-4"}),"Editar"]})}),(0,r.jsx)(p.$,{variant:"outline",onClick:_,className:"active"===U.status?"text-red-600 hover:text-red-700":"text-green-600 hover:text-green-700",children:"active"===U.status?"Desativar":"Ativar"}),(0,r.jsxs)(p.$,{variant:"destructive",onClick:z,disabled:L,className:"gap-2",children:[(0,r.jsx)(o.A,{className:"h-4 w-4"}),L?"Excluindo...":"Excluir"]})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,r.jsx)("div",{className:"lg:col-span-2",children:(0,r.jsxs)(y.Tabs,{defaultValue:"overview",className:"space-y-6",children:[(0,r.jsxs)(y.TabsList,{className:"grid w-full grid-cols-4",children:[(0,r.jsx)(y.TabsTrigger,{value:"overview",children:"Vis\xe3o Geral"}),(0,r.jsx)(y.TabsTrigger,{value:"permissions",children:"Permiss\xf5es"}),(0,r.jsx)(y.TabsTrigger,{value:"activity",children:"Atividade"}),(0,r.jsx)(y.TabsTrigger,{value:"security",children:"Seguran\xe7a"})]}),(0,r.jsx)(y.TabsContent,{value:"overview",className:"space-y-6",children:(0,r.jsxs)(N.Zp,{children:[(0,r.jsx)(N.aR,{children:(0,r.jsxs)(N.ZB,{className:"flex items-center gap-2",children:[(0,r.jsx)(c.A,{className:"h-5 w-5"}),"Informa\xe7\xf5es Pessoais"]})}),(0,r.jsx)(N.Wu,{className:"space-y-4",children:(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-sm font-medium text-gray-500",children:"Nome Completo"}),(0,r.jsx)("p",{className:"text-gray-900",children:U.name})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-sm font-medium text-gray-500",children:"Email"}),(0,r.jsx)("p",{className:"text-gray-900",children:U.email})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-sm font-medium text-gray-500",children:"Telefone"}),(0,r.jsx)("p",{className:"text-gray-900",children:U.phone||"N\xe3o informado"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-sm font-medium text-gray-500",children:"CPF"}),(0,r.jsx)("p",{className:"text-gray-900",children:U.cpf||"N\xe3o informado"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-sm font-medium text-gray-500",children:"CRM"}),(0,r.jsx)("p",{className:"text-gray-900",children:U.crm||"N\xe3o aplic\xe1vel"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-sm font-medium text-gray-500",children:"Especialidade"}),(0,r.jsx)("p",{className:"text-gray-900",children:U.specialty||"N\xe3o aplic\xe1vel"})]})]})})]})}),(0,r.jsx)(y.TabsContent,{value:"permissions",className:"space-y-6",children:(0,r.jsxs)(N.Zp,{children:[(0,r.jsx)(N.aR,{children:(0,r.jsxs)(N.ZB,{className:"flex items-center gap-2",children:[(0,r.jsx)(u.A,{className:"h-5 w-5"}),"Permiss\xf5es do Usu\xe1rio"]})}),(0,r.jsx)(N.Wu,{children:Z?(0,r.jsx)("div",{className:"space-y-2",children:Array.from({length:5}).map((e,s)=>(0,r.jsx)(g.E,{className:"h-4 w-full"},s))}):Q&&Q.length>0?(0,r.jsx)("div",{className:"space-y-4",children:Q.map(e=>(0,r.jsxs)("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"font-medium",children:e.name}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:e.description})]}),(0,r.jsx)(v.E,{variant:"outline",children:e.module})]},e.id))}):(0,r.jsx)("p",{className:"text-gray-600",children:"Nenhuma permiss\xe3o espec\xedfica atribu\xedda."})})]})}),(0,r.jsx)(y.TabsContent,{value:"activity",className:"space-y-6",children:(0,r.jsxs)(N.Zp,{children:[(0,r.jsx)(N.aR,{children:(0,r.jsxs)(N.ZB,{className:"flex items-center gap-2",children:[(0,r.jsx)(m.A,{className:"h-5 w-5"}),"Atividade Recente"]})}),(0,r.jsx)(N.Wu,{children:(0,r.jsx)("p",{className:"text-gray-600",children:"Hist\xf3rico de atividades ser\xe1 implementado em breve."})})]})}),(0,r.jsx)(y.TabsContent,{value:"security",className:"space-y-6",children:(0,r.jsxs)(N.Zp,{children:[(0,r.jsx)(N.aR,{children:(0,r.jsxs)(N.ZB,{className:"flex items-center gap-2",children:[(0,r.jsx)(x.A,{className:"h-5 w-5"}),"Configura\xe7\xf5es de Seguran\xe7a"]})}),(0,r.jsxs)(N.Wu,{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"font-medium",children:"Autentica\xe7\xe3o 2FA"}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:"Prote\xe7\xe3o adicional da conta"})]}),(0,r.jsx)(v.E,{variant:U.twoFactorEnabled?"default":"secondary",children:U.twoFactorEnabled?"Ativado":"Desativado"})]}),(0,r.jsx)("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"font-medium",children:"\xdaltimo Login"}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:U.lastLoginAt?(0,T.GP)(new Date(U.lastLoginAt),"dd/MM/yyyy '\xe0s' HH:mm",{locale:k.F}):"Nunca fez login"})]})}),(0,r.jsxs)(p.$,{variant:"outline",onClick:K,className:"w-full gap-2",children:[(0,r.jsx)(x.A,{className:"h-4 w-4"}),"Resetar Senha"]})]})]})})]})}),(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsx)(N.Zp,{children:(0,r.jsx)(N.Wu,{className:"pt-6",children:(0,r.jsxs)("div",{className:"text-center space-y-4",children:[(0,r.jsxs)(f.Avatar,{className:"h-24 w-24 mx-auto",children:[(0,r.jsx)(f.AvatarImage,{src:U.avatar,alt:U.name}),(0,r.jsx)(f.AvatarFallback,{className:"text-2xl",children:U.name.split(" ").map(e=>e[0]).join("").toUpperCase()})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"font-semibold text-lg",children:U.name}),(0,r.jsx)("p",{className:"text-gray-600",children:U.email})]}),(0,r.jsxs)("div",{className:"flex justify-center gap-2",children:[(0,r.jsx)(v.E,{className:(e=>{switch(e){case"active":return"bg-green-100 text-green-800";case"inactive":return"bg-red-100 text-red-800";case"pending":return"bg-yellow-100 text-yellow-800";default:return"bg-gray-100 text-gray-800"}})(U.status),children:"active"===U.status?"Ativo":"inactive"===U.status?"Inativo":"Pendente"}),(0,r.jsx)(v.E,{className:(e=>{switch(e){case"admin":return"bg-purple-100 text-purple-800";case"doctor":return"bg-blue-100 text-blue-800";case"nurse":return"bg-green-100 text-green-800";case"receptionist":return"bg-orange-100 text-orange-800";default:return"bg-gray-100 text-gray-800"}})(U.role),children:"admin"===U.role?"Administrador":"doctor"===U.role?"M\xe9dico":"nurse"===U.role?"Enfermeiro":"Recepcionista"})]})]})})}),(0,r.jsxs)(N.Zp,{children:[(0,r.jsx)(N.aR,{children:(0,r.jsx)(N.ZB,{className:"text-lg",children:"Estat\xedsticas"})}),(0,r.jsxs)(N.Wu,{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("span",{className:"text-sm text-gray-600",children:"Criado em"}),(0,r.jsx)("span",{className:"text-sm font-medium",children:(0,T.GP)(new Date(U.createdAt),"dd/MM/yyyy",{locale:k.F})})]}),(0,r.jsx)(b.Separator,{}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("span",{className:"text-sm text-gray-600",children:"\xdaltimo acesso"}),(0,r.jsx)("span",{className:"text-sm font-medium",children:U.lastLoginAt?(0,T.GP)(new Date(U.lastLoginAt),"dd/MM/yyyy",{locale:k.F}):"Nunca"})]}),(0,r.jsx)(b.Separator,{}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("span",{className:"text-sm text-gray-600",children:"Sess\xf5es ativas"}),(0,r.jsx)("span",{className:"text-sm font-medium",children:U.activeSessions||0})]})]})]})]})]})]}):(0,r.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,r.jsx)(N.Zp,{children:(0,r.jsx)(N.Wu,{className:"pt-6",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)(c.A,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),(0,r.jsx)("p",{className:"font-medium text-gray-900",children:"Usu\xe1rio n\xe3o encontrado"}),(0,r.jsx)("p",{className:"text-gray-600 mt-1",children:"O usu\xe1rio solicitado n\xe3o existe ou foi removido."}),(0,r.jsx)(p.$,{variant:"outline",className:"mt-4",onClick:()=>s.push("/dashboard/users"),children:"Voltar para Lista"})]})})})})}},27737:(e,s,a)=>{"use strict";a.d(s,{E:()=>l});var r=a(95155),t=a(53999);function l(e){let{className:s,...a}=e;return(0,r.jsx)("div",{className:(0,t.cn)("animate-pulse rounded-md bg-muted",s),...a})}},69663:(e,s,a)=>{"use strict";a.d(s,{Avatar:()=>c,AvatarFallback:()=>d,AvatarImage:()=>n});var r=a(95155),t=a(12115),l=a(54011),i=a(53999);let c=t.forwardRef((e,s)=>{let{className:a,...t}=e;return(0,r.jsx)(l.bL,{ref:s,className:(0,i.cn)("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",a),...t})});c.displayName=l.bL.displayName;let n=t.forwardRef((e,s)=>{let{className:a,...t}=e;return(0,r.jsx)(l._V,{ref:s,className:(0,i.cn)("aspect-square h-full w-full",a),...t})});n.displayName=l._V.displayName;let d=t.forwardRef((e,s)=>{let{className:a,...t}=e;return(0,r.jsx)(l.H4,{ref:s,className:(0,i.cn)("flex h-full w-full items-center justify-center rounded-full bg-muted",a),...t})});d.displayName=l.H4.displayName},76037:(e,s,a)=>{"use strict";a.d(s,{Separator:()=>c});var r=a(95155),t=a(12115),l=a(87489),i=a(53999);let c=t.forwardRef((e,s)=>{let{className:a,orientation:t="horizontal",decorative:c=!0,...n}=e;return(0,r.jsx)(l.b,{ref:s,decorative:c,orientation:t,className:(0,i.cn)("shrink-0 bg-border","horizontal"===t?"h-[1px] w-full":"h-full w-[1px]",a),...n})});c.displayName=l.b.displayName},99533:(e,s,a)=>{Promise.resolve().then(a.bind(a,4197))}},e=>{e.O(0,[3455,3942,6671,5954,6967,2960,3464,6874,7127,3008,7998,5865,6393,8441,5964,7358],()=>e(e.s=99533)),_N_E=e.O()}]);