(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7538],{10119:(e,a,t)=>{"use strict";t.d(a,{z:()=>l});var s=t(37223),r=t(63008),i=t(9107),n=t(94458),o=t(4573);class c{async getPatientMetrics(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"month";try{let a=new Date;return this.getStartDate(a,e),[{id:"total-patients",title:"Total de Pacientes",value:1250,change:8.5,trend:"up",period:e,icon:"users"},{id:"new-patients",title:"Novos Pacientes",value:45,change:12.3,trend:"up",period:e,icon:"user-plus"},{id:"active-patients",title:"Pacientes Ativos",value:980,change:5.2,trend:"up",period:e,icon:"user-check"},{id:"inactive-patients",title:"Pacientes Inativos",value:270,change:-2.1,trend:"down",period:e,icon:"user-x"}]}catch(e){throw e}}async getPatientDemographics(){try{return{ageGroups:[{range:"0-18",count:125,percentage:10},{range:"19-30",count:250,percentage:20},{range:"31-45",count:375,percentage:30},{range:"46-60",count:312,percentage:25},{range:"60+",count:188,percentage:15}],genderDistribution:[{gender:"Feminino",count:675,percentage:54},{gender:"Masculino",count:575,percentage:46}],locationDistribution:[{city:"S\xe3o Paulo",count:450,percentage:36},{city:"Rio de Janeiro",count:200,percentage:16},{city:"Belo Horizonte",count:150,percentage:12},{city:"Bras\xedlia",count:125,percentage:10},{city:"Outros",count:325,percentage:26}]}}catch(e){throw e}}async getPatientTrends(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"year";try{return{registrationTrend:this.generateTrendData(e),monthlyGrowth:8.5,yearlyGrowth:15.2}}catch(e){throw e}}async getPatientsBySpecialty(){try{return[{specialty:"Cardiologia",patientCount:245,activePatients:198,newPatients:12},{specialty:"Ortopedia",patientCount:189,activePatients:156,newPatients:8},{specialty:"Neurologia",patientCount:167,activePatients:134,newPatients:15},{specialty:"Pediatria",patientCount:156,activePatients:142,newPatients:18},{specialty:"Ginecologia",patientCount:134,activePatients:118,newPatients:9}]}catch(e){throw e}}async getPatientMedicalStats(){try{return{averageVisitsPerPatient:4.2,mostCommonConditions:[{condition:"Hipertens\xe3o",count:234},{condition:"Diabetes",count:189},{condition:"Ansiedade",count:156},{condition:"Artrite",count:134},{condition:"Asma",count:98}],averageAge:42.5,patientRetentionRate:85.3}}catch(e){throw e}}async getPatientKPIs(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];try{return[{id:"patient-satisfaction",title:"Satisfa\xe7\xe3o do Paciente",value:4.6,target:4.5,unit:"/5",trend:"up",change:2.2,status:"good"},{id:"patient-retention",title:"Taxa de Reten\xe7\xe3o",value:85.3,target:80,unit:"%",trend:"up",change:3.1,status:"good"},{id:"new-patient-conversion",title:"Convers\xe3o Novos Pacientes",value:72.8,target:75,unit:"%",trend:"down",change:-1.5,status:"warning"},{id:"patient-lifetime-value",title:"Valor M\xe9dio por Paciente",value:2450,target:2200,unit:"R$",trend:"up",change:8.7,status:"good"}]}catch(e){throw e}}async getPatientAgeChart(){try{return[{name:"0-18",value:125,percentage:10},{name:"19-30",value:250,percentage:20},{name:"31-45",value:375,percentage:30},{name:"46-60",value:312,percentage:25},{name:"60+",value:188,percentage:15}]}catch(e){throw e}}async getMonthlyGrowthChart(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:12;try{let a=[],t=new Date;for(let i=e-1;i>=0;i--){let e=(0,s.a)(t,i),n=(0,r.Yq)(e,"MMM",{locale:o.F}),c=Math.floor(50*Math.random())+20;a.push({name:n,value:c,date:(0,r.Yq)(e,"yyyy-MM-dd")})}return a}catch(e){throw e}}async getPatientReport(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"month";try{let[a,t,s,r,i,n]=await Promise.all([this.getPatientMetrics(e),this.getPatientDemographics(),this.getPatientTrends(e),this.getPatientsBySpecialty(),this.getPatientMedicalStats(),this.getPatientKPIs(e)]);return{metrics:a,demographics:t,trends:s,specialties:r,medicalStats:i,kpis:n,generatedAt:new Date().toISOString()}}catch(e){throw e}}getStartDate(e,a){switch(a){case"week":return(0,i.e)(e,7);case"month":default:return(0,s.a)(e,1);case"quarter":return(0,s.a)(e,3);case"year":return(0,n.d)(e,1)}}generateTrendData(e){let a=[];for(let t=("year"===e?12:"quarter"===e?3:4)-1;t>=0;t--){let n="year"===e?(0,s.a)(new Date,t):(0,i.e)(new Date,7*t),c="year"===e?(0,r.Yq)(n,"MMM",{locale:o.F}):(0,r.Yq)(n,"dd/MM");a.push({name:c,value:Math.floor(40*Math.random())+10,date:(0,r.Yq)(n,"yyyy-MM-dd")})}return a}}let l=new c},16891:(e,a,t)=>{"use strict";t.d(a,{F:()=>o});var s=t(95155),r=t(12115),i=t(47655),n=t(53999);let o=r.forwardRef((e,a)=>{let{className:t,children:r,...o}=e;return(0,s.jsxs)(i.bL,{ref:a,className:(0,n.cn)("relative overflow-hidden",t),...o,children:[(0,s.jsx)(i.LM,{className:"h-full w-full rounded-[inherit]",children:r}),(0,s.jsx)(c,{}),(0,s.jsx)(i.OK,{})]})});o.displayName=i.bL.displayName;let c=r.forwardRef((e,a)=>{let{className:t,orientation:r="vertical",...o}=e;return(0,s.jsx)(i.VM,{ref:a,orientation:r,className:(0,n.cn)("flex touch-none select-none transition-colors","vertical"===r&&"h-full w-2.5 border-l border-l-transparent p-[1px]","horizontal"===r&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",t),...o,children:(0,s.jsx)(i.lr,{className:"relative flex-1 rounded-full bg-border"})})});c.displayName=i.VM.displayName},28168:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>e9});var s=t(95155),r=t(12115),i=t(53999),n=t(88482),o=t(97168),c=t(88145),l=t(34964),d=t(95784),u=t(82714),m=t(76037),h=t(84616),g=t(91788),p=t(53904),x=t(92657),y=t(381),v=t(17580),b=t(55868),f=t(36643),j=t(51976),w=t(1243),N=t(54653),A=t(15968),C=t(72713),R=t(16785),S=t(46697),k=t(75525),D=t(56671),E=function(e){return e.COUNTER="counter",e.GAUGE="gauge",e.HISTOGRAM="histogram",e.RATE="rate",e.RATIO="ratio",e.PERCENTAGE="percentage",e.CURRENCY="currency",e.DURATION="duration",e.COUNT="count",e}({}),T=function(e){return e.NUMBER="number",e.COUNT="count",e.PERCENTAGE="percentage",e.RATIO="ratio",e.BRL="BRL",e.USD="USD",e.EUR="EUR",e.SECONDS="seconds",e.MINUTES="minutes",e.HOURS="hours",e.DAYS="days",e.WEEKS="weeks",e.MONTHS="months",e.PER_SECOND="per_second",e.PER_MINUTE="per_minute",e.PER_HOUR="per_hour",e.PER_DAY="per_day",e.BYTES="bytes",e.KILOBYTES="kilobytes",e.MEGABYTES="megabytes",e.GIGABYTES="gigabytes",e}({}),M=t(47761),P=t(74890),I=t(81284),F=t(85339),L=t(71539),_=t(14186),B=t(40646),z=t(5623),U=t(54416),q=t(23861),O=t(66932),V=t(67133),W=t(95139),K=t(16891),G=t(80425);class ${async getAppointmentMetrics(e){try{return(await G.A.get("".concat(this.baseUrl,"/metrics"),{params:e})).data}catch(e){return this.getMockMetrics()}}async getAppointmentTrends(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"daily",a=arguments.length>1?arguments[1]:void 0;try{return(await G.A.get("".concat(this.baseUrl,"/trends"),{params:{period:e,...a}})).data}catch(e){return this.getMockTrends()}}async getDoctorPerformance(e){try{return(await G.A.get("".concat(this.baseUrl,"/doctor-performance"),{params:e})).data}catch(e){return this.getMockDoctorPerformance()}}async getAppointmentAnalytics(e){try{return(await G.A.get("".concat(this.baseUrl,"/analytics"),{params:e})).data}catch(e){return this.getMockAnalytics()}}async getAppointmentKPIs(e){try{let a=await this.getAppointmentMetrics(e);return[{id:"total-appointments",title:"Total de Agendamentos",value:a.totalAppointments,target:1e3,unit:"agendamentos",trend:"up",change:12.5,period:"mensal",status:"good"},{id:"occupancy-rate",title:"Taxa de Ocupa\xe7\xe3o",value:a.occupancyRate,target:85,unit:"%",trend:"up",change:5.2,period:"mensal",status:a.occupancyRate>=80?"good":a.occupancyRate>=60?"warning":"critical"},{id:"completion-rate",title:"Taxa de Conclus\xe3o",value:a.completedAppointments/a.totalAppointments*100,target:90,unit:"%",trend:"stable",change:.8,period:"mensal",status:"good"},{id:"no-show-rate",title:"Taxa de Faltas",value:a.noShowAppointments/a.totalAppointments*100,target:5,unit:"%",trend:"down",change:-2.1,period:"mensal",status:"good"}]}catch(e){return this.getMockKPIs()}}async getAppointmentChartData(e,a){try{return(await G.A.get("".concat(this.baseUrl,"/charts/").concat(e),{params:a})).data}catch(a){return this.getMockChartData(e)}}getMockMetrics(){return{totalAppointments:1247,completedAppointments:1089,cancelledAppointments:98,noShowAppointments:60,averageDuration:45,occupancyRate:78.5,patientSatisfaction:4.6,revenuePerAppointment:150.75}}getMockTrends(){return{daily:(()=>{let e=[];for(let a=30;a>=0;a--){let t=new Date;t.setDate(t.getDate()-a),e.push({date:t.toISOString().split("T")[0],value:Math.floor(50*Math.random())+20,label:t.toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit"})})}return e})(),weekly:[{date:"2024-01-01",value:245,label:"Sem 1"},{date:"2024-01-08",value:289,label:"Sem 2"},{date:"2024-01-15",value:312,label:"Sem 3"},{date:"2024-01-22",value:298,label:"Sem 4"}],monthly:[{date:"2024-01",value:1247,label:"Jan"},{date:"2024-02",value:1189,label:"Fev"},{date:"2024-03",value:1356,label:"Mar"}],hourly:[{hour:8,count:45},{hour:9,count:67},{hour:10,count:89},{hour:11,count:78},{hour:14,count:92},{hour:15,count:85},{hour:16,count:73},{hour:17,count:56}]}}getMockDoctorPerformance(){return[{doctorId:1,doctorName:"Dr. Jo\xe3o Silva",totalAppointments:234,completedRate:92.3,cancelledRate:5.1,noShowRate:2.6,averageRating:4.8,revenue:35250},{doctorId:2,doctorName:"Dra. Maria Santos",totalAppointments:198,completedRate:89.4,cancelledRate:7.1,noShowRate:3.5,averageRating:4.6,revenue:29700},{doctorId:3,doctorName:"Dr. Carlos Oliveira",totalAppointments:156,completedRate:94.2,cancelledRate:3.8,noShowRate:2,averageRating:4.9,revenue:23400}]}getMockAnalytics(){return{metrics:this.getMockMetrics(),trends:this.getMockTrends(),doctorPerformance:this.getMockDoctorPerformance(),busyHours:[{hour:9,count:67},{hour:10,count:89},{hour:14,count:92},{hour:15,count:85}],busyDays:[{day:"Segunda",count:245},{day:"Ter\xe7a",count:289},{day:"Quarta",count:267},{day:"Quinta",count:298},{day:"Sexta",count:234}],statusDistribution:[{status:"Conclu\xeddo",count:1089,percentage:87.3},{status:"Cancelado",count:98,percentage:7.9},{status:"Faltou",count:60,percentage:4.8}],typeDistribution:[{type:"Consulta",count:789,percentage:63.3},{type:"Retorno",count:298,percentage:23.9},{type:"Exame",count:160,percentage:12.8}]}}getMockKPIs(){return[{id:"total-appointments",title:"Total de Agendamentos",value:1247,target:1e3,unit:"agendamentos",trend:"up",change:12.5,period:"mensal",status:"good"},{id:"occupancy-rate",title:"Taxa de Ocupa\xe7\xe3o",value:78.5,target:85,unit:"%",trend:"up",change:5.2,period:"mensal",status:"warning"}]}getMockChartData(e){switch(e){case"status":return{type:"pie",data:[{name:"Conclu\xeddo",value:1089,color:"#10b981"},{name:"Cancelado",value:98,color:"#f59e0b"},{name:"Faltou",value:60,color:"#ef4444"}],title:"Distribui\xe7\xe3o por Status"};case"trends":return{type:"line",data:this.getMockTrends().daily.map(e=>({name:e.label,value:e.value})),title:"Tend\xeancia de Agendamentos"};case"doctors":return{type:"bar",data:this.getMockDoctorPerformance().map(e=>({name:e.doctorName,value:e.totalAppointments})),title:"Agendamentos por M\xe9dico"};case"hours":return{type:"bar",data:this.getMockTrends().hourly.map(e=>({name:"".concat(e.hour,"h"),value:e.count})),title:"Agendamentos por Hor\xe1rio"};default:return{type:"line",data:[],title:"Dados n\xe3o encontrados"}}}constructor(){this.baseUrl="/api/bi/appointments"}}let H=new $,Q={async getMetrics(e){try{return(await G.A.get("/billing/bi/metrics",{params:{period:e}})).data}catch(e){return{totalRevenue:125e3,monthlyRevenue:45e3,pendingAmount:18500,overdueAmount:7200,totalInvoices:342,paidInvoices:298,overdueInvoices:23,averageInvoiceValue:365.5,paymentRate:87.1,overdueRate:6.7,collectionEfficiency:92.3,daysToPayment:12.5}}},async getTrends(e){try{return(await G.A.get("/billing/bi/trends",{params:{period:e}})).data}catch(e){return{revenueByMonth:[{month:"2024-01",revenue:38e3,invoices:95,payments:88},{month:"2024-02",revenue:42e3,invoices:108,payments:102},{month:"2024-03",revenue:45e3,invoices:123,payments:115}],paymentMethodDistribution:[{method:"CREDIT_CARD",amount:65e3,count:180,percentage:52},{method:"CASH",amount:35e3,count:95,percentage:28},{method:"BANK_TRANSFER",amount:25e3,count:67,percentage:20}],statusDistribution:[{status:InvoiceStatus.PAID,count:298,amount:108800,percentage:87.1},{status:InvoiceStatus.PENDING,count:21,amount:7700,percentage:6.1},{status:InvoiceStatus.OVERDUE,count:23,amount:8500,percentage:6.7}]}}},async getPaymentAnalytics(e){try{return(await G.A.get("/billing/bi/payments",{params:{period:e}})).data}catch(e){return{averagePaymentTime:12.5,paymentSuccessRate:94.2,refundRate:2.1,partialPaymentRate:8.3,paymentsByDay:[{day:"2024-03-01",amount:1500,count:4},{day:"2024-03-02",amount:2200,count:6},{day:"2024-03-03",amount:1800,count:5}],topPaymentMethods:[{method:"CREDIT_CARD",usage:52,amount:65e3},{method:"CASH",usage:28,amount:35e3},{method:"BANK_TRANSFER",usage:20,amount:25e3}]}}},async getOverdueAnalytics(e){try{return(await G.A.get("/billing/bi/overdue",{params:{period:e}})).data}catch(e){return{totalOverdueAmount:7200,overdueInvoicesCount:23,averageOverdueDays:18.5,overdueByAgeGroup:[{ageGroup:"1-30 dias",count:12,amount:3200},{ageGroup:"31-60 dias",count:7,amount:2500},{ageGroup:"60+ dias",count:4,amount:1500}],overdueByPatient:[{patientId:"1",patientName:"Jo\xe3o Silva",overdueAmount:850,overdueCount:2,oldestOverdueDays:45},{patientId:"2",patientName:"Maria Santos",overdueAmount:620,overdueCount:1,oldestOverdueDays:32}]}}},async getAnalytics(e){try{let[a,t,s,r]=await Promise.all([this.getMetrics(e),this.getTrends(e),this.getPaymentAnalytics(e),this.getOverdueAnalytics(e)]);return{metrics:a,trends:t,payments:s,overdue:r,forecast:{nextMonthRevenue:1.08*a.monthlyRevenue,expectedCollections:.85*a.pendingAmount,riskAmount:.3*a.overdueAmount}}}catch(e){throw e}},async getKPIs(e){let a=await this.getMetrics(e);return{revenue:{current:a.totalRevenue,target:15e4,trend:8.5},collectionRate:{current:a.paymentRate,target:90,trend:2.1},overdueRate:{current:a.overdueRate,target:5,trend:-1.2},averagePaymentTime:{current:a.daysToPayment,target:10,trend:-.8}}},async getChartData(e,a){switch(e){case"revenue-trend":return(await this.getTrends(a)).revenueByMonth.map(e=>({name:e.month,value:e.revenue,invoices:e.invoices}));case"payment-methods":return(await this.getTrends(a)).paymentMethodDistribution.map(e=>({name:e.method,value:e.amount,percentage:e.percentage}));case"invoice-status":return(await this.getTrends(a)).statusDistribution.map(e=>({name:e.status,value:e.count,amount:e.amount}));default:return[]}}};class Z{async getBedMetrics(e){return{totalBeds:120,occupiedBeds:95,availableBeds:18,maintenanceBeds:4,blockedBeds:2,cleaningBeds:1,occupancyRate:79.2,averageStayDuration:4.5,turnoverRate:2.1,revenuePerBed:850}}async getBedOccupancyTrends(e){let a=[],t=new Date;for(let e=29;e>=0;e--){let s=new Date(t);s.setDate(s.getDate()-e),a.push({date:s.toISOString().split("T")[0],totalBeds:120,occupiedBeds:Math.floor(30*Math.random())+70,availableBeds:Math.floor(20*Math.random())+15,occupancyRate:20*Math.random()+70,admissions:Math.floor(15*Math.random())+5,discharges:Math.floor(12*Math.random())+3,transfers:Math.floor(5*Math.random())+1})}return a}async getDepartmentBedAnalytics(e){return[{departmentId:"1",departmentName:"UTI",totalBeds:20,occupiedBeds:18,occupancyRate:90,averageStayDuration:7.2,revenue:45e3,patientSatisfaction:4.5},{departmentId:"2",departmentName:"Cl\xednica M\xe9dica",totalBeds:40,occupiedBeds:32,occupancyRate:80,averageStayDuration:3.8,revenue:28e3,patientSatisfaction:4.2},{departmentId:"3",departmentName:"Cirurgia",totalBeds:30,occupiedBeds:25,occupancyRate:83.3,averageStayDuration:2.5,revenue:35e3,patientSatisfaction:4.7},{departmentId:"4",departmentName:"Pediatria",totalBeds:25,occupiedBeds:18,occupancyRate:72,averageStayDuration:4.1,revenue:18e3,patientSatisfaction:4.8},{departmentId:"5",departmentName:"Maternidade",totalBeds:15,occupiedBeds:12,occupancyRate:80,averageStayDuration:2.8,revenue:15e3,patientSatisfaction:4.6}]}async getBedTypeAnalytics(e){return[{bedType:"STANDARD",totalBeds:70,occupiedBeds:55,occupancyRate:78.6,averageStayDuration:3.2,revenue:85e3,demandRate:85},{bedType:"ICU",totalBeds:25,occupiedBeds:22,occupancyRate:88,averageStayDuration:8.5,revenue:12e4,demandRate:95},{bedType:"SEMI_ICU",totalBeds:15,occupiedBeds:12,occupancyRate:80,averageStayDuration:5.8,revenue:45e3,demandRate:78},{bedType:"ISOLATION",totalBeds:10,occupiedBeds:6,occupancyRate:60,averageStayDuration:6.2,revenue:25e3,demandRate:65}]}async getBedAnalytics(e){let[a,t,s,r]=await Promise.all([this.getBedMetrics(e),this.getBedOccupancyTrends(e),this.getDepartmentBedAnalytics(e),this.getBedTypeAnalytics(e)]);return{metrics:a,trends:t,departmentAnalytics:s,bedTypeAnalytics:r,alerts:{highOccupancy:a.occupancyRate>85,maintenanceNeeded:a.maintenanceBeds>5,lowTurnover:a.turnoverRate<1.5,revenueDecline:a.revenuePerBed<800}}}async getBedKPIs(e){let a=await this.getBedMetrics(e);return{occupancyRate:{value:a.occupancyRate,target:80,trend:"up",format:"percentage"},averageStay:{value:a.averageStayDuration,target:4,trend:"stable",format:"decimal"},turnoverRate:{value:a.turnoverRate,target:2,trend:"up",format:"decimal"},revenuePerBed:{value:a.revenuePerBed,target:900,trend:"down",format:"currency"}}}async getBedChartData(e,a){switch(e){case"occupancy-trends":return this.getBedOccupancyTrends(a);case"department-comparison":return this.getDepartmentBedAnalytics(a);case"bed-type-analysis":return this.getBedTypeAnalytics(a);default:return[]}}constructor(){this.baseUrl="/api/bi/beds"}}let Y=new Z;var J=t(10119);class X{initializeMetrics(){this.metrics=[{id:"bed_occupancy_rate",name:"Taxa de Ocupa\xe7\xe3o de Leitos",description:"Percentual de leitos ocupados",category:"beds",dataType:"percentage",unit:"%",getCurrentValue:async()=>{let e=await Y.getBedStats();return e.occupied/e.total*100}},{id:"overdue_bills_count",name:"Faturas em Atraso",description:"N\xfamero de faturas vencidas",category:"billing",dataType:"number",unit:"faturas",getCurrentValue:async()=>(await Q.getOverdueBills()).length},{id:"cancelled_appointments_today",name:"Agendamentos Cancelados Hoje",description:"N\xfamero de agendamentos cancelados no dia atual",category:"appointments",dataType:"number",unit:"agendamentos",getCurrentValue:async()=>{let e=new Date;return(await H.getAppointmentStats(e,e)).cancelled}},{id:"daily_revenue",name:"Receita Di\xe1ria",description:"Receita total do dia",category:"billing",dataType:"number",unit:"R$",getCurrentValue:async()=>{let e=new Date;return await Q.getDailyRevenue(e)}},{id:"available_beds",name:"Leitos Dispon\xedveis",description:"N\xfamero de leitos dispon\xedveis",category:"beds",dataType:"number",unit:"leitos",getCurrentValue:async()=>(await Y.getBedStats()).available},{id:"total_patients",name:"Total de Pacientes",description:"N\xfamero total de pacientes cadastrados",category:"patients",dataType:"number",unit:"pacientes",getCurrentValue:async()=>{let e=(await J.z.getPatientMetrics()).find(e=>"total-patients"===e.id);return(null==e?void 0:e.value)||0}},{id:"new_patients_today",name:"Novos Pacientes Hoje",description:"N\xfamero de pacientes cadastrados hoje",category:"patients",dataType:"number",unit:"pacientes",getCurrentValue:async()=>{let e=(await J.z.getPatientMetrics("day")).find(e=>"new-patients"===e.id);return(null==e?void 0:e.value)||0}},{id:"inactive_patients",name:"Pacientes Inativos",description:"N\xfamero de pacientes sem atividade recente",category:"patients",dataType:"number",unit:"pacientes",getCurrentValue:async()=>{let e=(await J.z.getPatientMetrics()).find(e=>"inactive-patients"===e.id);return(null==e?void 0:e.value)||0}},{id:"patient_growth_rate",name:"Taxa de Crescimento de Pacientes",description:"Taxa de crescimento mensal de pacientes",category:"patients",dataType:"percentage",unit:"%",getCurrentValue:async()=>(await J.z.getPatientTrends()).monthlyGrowth}]}loadDefaultRules(){[{name:"Ocupa\xe7\xe3o Cr\xedtica de Leitos",description:"Alerta quando a ocupa\xe7\xe3o de leitos excede 90%",type:"bed_occupancy",severity:"critical",conditions:[{metric:"bed_occupancy_rate",operator:"gt",value:90}],actions:[{type:"notification",target:"system"}]},{name:"Faturas em Atraso",description:"Alerta quando h\xe1 mais de 5 faturas em atraso",type:"billing_overdue",severity:"high",conditions:[{metric:"overdue_bills_count",operator:"gt",value:5}],actions:[{type:"notification",target:"billing_team"}]},{name:"Muitos Cancelamentos",description:"Alerta quando h\xe1 mais de 10 cancelamentos no dia",type:"appointment_cancelled",severity:"medium",conditions:[{metric:"cancelled_appointments_today",operator:"gt",value:10}],actions:[{type:"notification",target:"reception"}]},{name:"Poucos Leitos Dispon\xedveis",description:"Alerta quando h\xe1 menos de 3 leitos dispon\xedveis",type:"bed_occupancy",severity:"high",conditions:[{metric:"available_beds",operator:"lt",value:3}],actions:[{type:"notification",target:"management"}]},{name:"Muitos Pacientes Inativos",description:"Alerta quando h\xe1 mais de 100 pacientes inativos",type:"patient_inactive",severity:"medium",conditions:[{metric:"inactive_patients",operator:"gt",value:100}],actions:[{type:"notification",target:"patient_care"}]},{name:"Baixo Crescimento de Pacientes",description:"Alerta quando o crescimento mensal \xe9 menor que 2%",type:"patient_growth",severity:"low",conditions:[{metric:"patient_growth_rate",operator:"lt",value:2}],actions:[{type:"notification",target:"marketing"}]},{name:"Poucos Novos Pacientes",description:"Alerta quando h\xe1 menos de 5 novos pacientes no dia",type:"patient_registration",severity:"low",conditions:[{metric:"new_patients_today",operator:"lt",value:5}],actions:[{type:"notification",target:"reception"}]}].forEach(e=>{this.createRule(e)})}startMonitoring(){this.monitoringInterval&&clearInterval(this.monitoringInterval),this.monitoringInterval=setInterval(()=>{this.checkAllRules()},3e5),setTimeout(()=>this.checkAllRules(),1e3)}async checkAllRules(){for(let e of this.rules.filter(e=>e.isActive))try{await this.checkRule(e)}catch(e){}}async checkRule(e){let a=!0;for(let t of e.conditions){let e=this.metrics.find(e=>e.id===t.metric);if(!e)continue;let s=await e.getCurrentValue();if(!this.evaluateCondition(s,t)){a=!1;break}}a&&(this.notifications.find(a=>a.ruleId===e.id&&!a.isResolved)||await this.triggerAlert(e))}evaluateCondition(e,a){let{operator:t,value:s}=a;if("number"==typeof e&&"number"==typeof s)switch(t){case"gt":return e>s;case"lt":return e<s;case"gte":return e>=s;case"lte":return e<=s;case"eq":return e===s;case"ne":return e!==s;default:return!1}return"eq"===t?e===s:"ne"===t&&e!==s}async triggerAlert(e){let a={id:"alert_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9)),ruleId:e.id,ruleName:e.name,type:e.type,severity:e.severity,title:e.name,message:e.description,data:{},isRead:!1,isResolved:!1,triggeredAt:new Date};for(let t of(this.notifications.unshift(a),e.actions))await this.executeAction(t,a);this.notifyListeners()}async executeAction(e,a){e.type}notifyListeners(){this.listeners.forEach(e=>{e([...this.notifications])})}async getRules(){return[...this.rules]}async getNotifications(e){let a=[...this.notifications];return e&&(e.severity&&(a=a.filter(a=>e.severity.includes(a.severity))),e.type&&(a=a.filter(a=>e.type.includes(a.type))),void 0!==e.isRead&&(a=a.filter(a=>a.isRead===e.isRead)),void 0!==e.isResolved&&(a=a.filter(a=>a.isResolved===e.isResolved)),e.dateRange&&(a=a.filter(a=>a.triggeredAt>=e.dateRange.start&&a.triggeredAt<=e.dateRange.end))),a}async getMetrics(){return[...this.metrics]}async createRule(e){let a={id:"rule_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9)),...e,isActive:!0,conditions:e.conditions.map(e=>({...e,id:"condition_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9))})),actions:e.actions.map(e=>({...e,id:"action_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9))})),createdAt:new Date,updatedAt:new Date,createdBy:"system"};return this.rules.push(a),a}async updateRule(e){let a=this.rules.findIndex(a=>a.id===e.id);if(-1===a)throw Error("Regra n\xe3o encontrada");let t=this.rules[a];return this.rules[a]={...t,...e,updatedAt:new Date},this.rules[a]}async deleteRule(e){let a=this.rules.findIndex(a=>a.id===e);if(-1===a)throw Error("Regra n\xe3o encontrada");this.rules.splice(a,1)}async markAsRead(e){let a=this.notifications.find(a=>a.id===e);a&&(a.isRead=!0,this.notifyListeners())}async markAsResolved(e,a){let t=this.notifications.find(a=>a.id===e);t&&(t.isResolved=!0,t.resolvedAt=new Date,t.resolvedBy=a,this.notifyListeners())}async getStats(){let e=this.notifications,a=e.length,t=e.filter(e=>!e.isRead).length,s=e.filter(e=>!e.isResolved).length;return{total:a,unread:t,unresolved:s,bySeverity:e.reduce((e,a)=>(e[a.severity]=(e[a.severity]||0)+1,e),{}),byType:e.reduce((e,a)=>(e[a.type]=(e[a.type]||0)+1,e),{}),recentTrends:[]}}addListener(e){return this.listeners.push(e),()=>{let a=this.listeners.indexOf(e);a>-1&&this.listeners.splice(a,1)}}stopMonitoring(){this.monitoringInterval&&(clearInterval(this.monitoringInterval),this.monitoringInterval=null)}constructor(){this.rules=[],this.notifications=[],this.metrics=[],this.monitoringInterval=null,this.listeners=[],this.initializeMetrics(),this.loadDefaultRules(),this.startMonitoring()}}let ee=new X;function ea(){let[e,a]=(0,r.useState)({rules:[],notifications:[],metrics:[],isLoading:!0,error:null}),[t,s]=(0,r.useState)(null),[i,n]=(0,r.useState)(null),[o,c]=(0,r.useState)([]),l=(0,r.useCallback)(async()=>{try{a(e=>({...e,isLoading:!0,error:null}));let[e,t,r,n]=await Promise.all([ee.getRules(),ee.getNotifications(),ee.getMetrics(),ee.getStats()]);c(t),s(n),a({rules:e,notifications:i?await ee.getNotifications(i):t,metrics:r,isLoading:!1,error:null})}catch(e){a(a=>({...a,isLoading:!1,error:e instanceof Error?e.message:"Erro ao carregar alertas"}))}},[i]);(0,r.useEffect)(()=>ee.addListener(e=>{c(e),i?ee.getNotifications(i).then(e=>{a(a=>({...a,notifications:e}))}):a(a=>({...a,notifications:e})),ee.getStats().then(s)}),[i]),(0,r.useEffect)(()=>{l()},[l]);let d=(0,r.useCallback)(async e=>{try{await ee.createRule(e),await l()}catch(e){throw a(a=>({...a,error:e instanceof Error?e.message:"Erro ao criar regra"})),e}},[l]),u=(0,r.useCallback)(async e=>{try{await ee.updateRule(e),await l()}catch(e){throw a(a=>({...a,error:e instanceof Error?e.message:"Erro ao atualizar regra"})),e}},[l]),m=(0,r.useCallback)(async e=>{try{await ee.deleteRule(e),await l()}catch(e){throw a(a=>({...a,error:e instanceof Error?e.message:"Erro ao excluir regra"})),e}},[l]),h=(0,r.useCallback)(async t=>{try{let a=e.rules.find(e=>e.id===t);if(!a)throw Error("Regra n\xe3o encontrada");await ee.updateRule({id:t,isActive:!a.isActive}),await l()}catch(e){throw a(a=>({...a,error:e instanceof Error?e.message:"Erro ao alterar status da regra"})),e}},[e.rules,l]),g=(0,r.useCallback)(async e=>{try{await ee.markAsRead(e)}catch(e){a(a=>({...a,error:e instanceof Error?e.message:"Erro ao marcar como lida"}))}},[]),p=(0,r.useCallback)(async(e,t)=>{try{await ee.markAsResolved(e,t)}catch(e){a(a=>({...a,error:e instanceof Error?e.message:"Erro ao marcar como resolvida"}))}},[]),x=(0,r.useCallback)(async()=>{try{let a=e.notifications.filter(e=>!e.isRead);await Promise.all(a.map(e=>ee.markAsRead(e.id)))}catch(e){a(a=>({...a,error:e instanceof Error?e.message:"Erro ao marcar todas como lidas"}))}},[e.notifications]),y=(0,r.useCallback)(e=>{n(e)},[]),v=(0,r.useCallback)(()=>{n(null)},[]),b=(0,r.useCallback)(async()=>{await l()},[l]);return{rules:e.rules,notifications:e.notifications,metrics:e.metrics,stats:t,isLoading:e.isLoading,error:e.error,createRule:d,updateRule:u,deleteRule:m,toggleRule:h,markAsRead:g,markAsResolved:p,markAllAsRead:x,applyFilters:y,clearFilters:v,refresh:b}}var et=t(15891),es=t(4573);let er={low:{icon:I.A,color:"bg-blue-100 text-blue-800 border-blue-200",bgColor:"bg-blue-50"},medium:{icon:F.A,color:"bg-yellow-100 text-yellow-800 border-yellow-200",bgColor:"bg-yellow-50"},high:{icon:w.A,color:"bg-orange-100 text-orange-800 border-orange-200",bgColor:"bg-orange-50"},critical:{icon:L.A,color:"bg-red-100 text-red-800 border-red-200",bgColor:"bg-red-50"}},ei={bed_occupancy:"Ocupa\xe7\xe3o de Leitos",billing_overdue:"Faturamento em Atraso",appointment_cancelled:"Agendamentos Cancelados",patient_inactive:"Pacientes Inativos",revenue_drop:"Queda de Receita",system_performance:"Performance do Sistema",custom:"Personalizado"};function en(e){let{notification:a,onMarkAsRead:t,onMarkAsResolved:r}=e,i=er[a.severity],n=i.icon;return(0,s.jsx)("div",{className:"p-4 border rounded-lg transition-all hover:shadow-sm ".concat(a.isRead?"bg-gray-50":i.bgColor," ").concat(a.isResolved?"opacity-60":""),children:(0,s.jsxs)("div",{className:"flex items-start justify-between gap-3",children:[(0,s.jsxs)("div",{className:"flex items-start gap-3 flex-1",children:[(0,s.jsx)("div",{className:"p-2 rounded-full ".concat(i.color),children:(0,s.jsx)(n,{className:"h-4 w-4"})}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,s.jsx)("h4",{className:"font-medium text-sm ".concat(a.isRead?"text-gray-700":"text-gray-900"),children:a.title}),(0,s.jsx)(c.E,{variant:"outline",className:"text-xs ".concat(i.color),children:a.severity.toUpperCase()}),!a.isRead&&(0,s.jsx)("div",{className:"w-2 h-2 bg-blue-500 rounded-full"})]}),(0,s.jsx)("p",{className:"text-sm mb-2 ".concat(a.isRead?"text-gray-600":"text-gray-700"),children:a.message}),(0,s.jsxs)("div",{className:"flex items-center gap-4 text-xs text-gray-500",children:[(0,s.jsxs)("span",{className:"flex items-center gap-1",children:[(0,s.jsx)(_.A,{className:"h-3 w-3"}),(0,et.m)(a.triggeredAt,{addSuffix:!0,locale:es.F})]}),(0,s.jsx)(c.E,{variant:"secondary",className:"text-xs",children:ei[a.type]}),a.isResolved&&(0,s.jsxs)("span",{className:"flex items-center gap-1 text-green-600",children:[(0,s.jsx)(B.A,{className:"h-3 w-3"}),"Resolvido"]})]})]})]}),(0,s.jsxs)(V.rI,{children:[(0,s.jsx)(V.ty,{asChild:!0,children:(0,s.jsx)(o.$,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",children:(0,s.jsx)(z.A,{className:"h-4 w-4"})})}),(0,s.jsxs)(V.SQ,{align:"end",children:[!a.isRead&&(0,s.jsxs)(V._2,{onClick:()=>t(a.id),children:[(0,s.jsx)(B.A,{className:"h-4 w-4 mr-2"}),"Marcar como lida"]}),!a.isResolved&&(0,s.jsxs)(V._2,{onClick:()=>r(a.id),children:[(0,s.jsx)(U.A,{className:"h-4 w-4 mr-2"}),"Marcar como resolvida"]}),(0,s.jsx)(V.mB,{}),(0,s.jsxs)(V._2,{className:"text-gray-500",children:[(0,s.jsx)(I.A,{className:"h-4 w-4 mr-2"}),"Ver detalhes"]})]})]})]})})}function eo(e){let{onFiltersChange:a}=e,[t,i]=(0,r.useState)([]),[n,c]=(0,r.useState)([]),[l,u]=(0,r.useState)(!1),[m,h]=(0,r.useState)(!1);return r.useEffect(()=>{let e={};t.length>0&&(e.severity=t),n.length>0&&(e.type=n),l&&(e.isRead=!1),m&&(e.isResolved=!1),a(Object.keys(e).length>0?e:null)},[t,n,l,m]),(0,s.jsxs)("div",{className:"space-y-4 p-4 border-b",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("h3",{className:"font-medium text-sm",children:"Filtros"}),(0,s.jsx)(o.$,{variant:"ghost",size:"sm",onClick:()=>{i([]),c([]),u(!1),h(!1),a(null)},children:"Limpar"})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-xs font-medium text-gray-700 mb-2 block",children:"Severidade"}),(0,s.jsxs)(d.l6,{value:t.join(","),onValueChange:e=>i(e?e.split(","):[]),children:[(0,s.jsx)(d.bq,{className:"h-8",children:(0,s.jsx)(d.yv,{placeholder:"Todas"})}),(0,s.jsxs)(d.gC,{children:[(0,s.jsx)(d.eb,{value:"critical",children:"Cr\xedtica"}),(0,s.jsx)(d.eb,{value:"high",children:"Alta"}),(0,s.jsx)(d.eb,{value:"medium",children:"M\xe9dia"}),(0,s.jsx)(d.eb,{value:"low",children:"Baixa"})]})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-xs font-medium text-gray-700 mb-2 block",children:"Tipo"}),(0,s.jsxs)(d.l6,{value:n.join(","),onValueChange:e=>c(e?e.split(","):[]),children:[(0,s.jsx)(d.bq,{className:"h-8",children:(0,s.jsx)(d.yv,{placeholder:"Todos"})}),(0,s.jsxs)(d.gC,{children:[(0,s.jsx)(d.eb,{value:"bed_occupancy",children:"Ocupa\xe7\xe3o de Leitos"}),(0,s.jsx)(d.eb,{value:"billing_overdue",children:"Faturamento"}),(0,s.jsx)(d.eb,{value:"appointment_cancelled",children:"Agendamentos"}),(0,s.jsx)(d.eb,{value:"patient_inactive",children:"Pacientes"})]})]})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(W.S,{id:"unread",checked:l,onCheckedChange:u}),(0,s.jsx)("label",{htmlFor:"unread",className:"text-xs text-gray-700",children:"Apenas n\xe3o lidas"})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(W.S,{id:"unresolved",checked:m,onCheckedChange:h}),(0,s.jsx)("label",{htmlFor:"unresolved",className:"text-xs text-gray-700",children:"Apenas n\xe3o resolvidas"})]})]})]})}function ec(e){let{className:a="",maxHeight:t="600px",showFilters:i=!0,showStats:l=!0}=e,{notifications:d,stats:u,isLoading:m,error:h,markAsRead:g,markAsResolved:p,markAllAsRead:x,applyFilters:y,clearFilters:v}=ea(),[b,f]=(0,r.useState)(!1);return m?(0,s.jsx)(n.Zp,{className:a,children:(0,s.jsx)(n.Wu,{className:"p-6",children:(0,s.jsx)("div",{className:"flex items-center justify-center",children:(0,s.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})})})}):h?(0,s.jsx)(n.Zp,{className:a,children:(0,s.jsx)(n.Wu,{className:"p-6",children:(0,s.jsxs)("div",{className:"text-center text-red-600",children:[(0,s.jsx)(w.A,{className:"h-8 w-8 mx-auto mb-2"}),(0,s.jsx)("p",{children:h})]})})}):(0,s.jsxs)(n.Zp,{className:a,children:[(0,s.jsxs)(n.aR,{className:"pb-3",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(q.A,{className:"h-5 w-5"}),(0,s.jsx)(n.ZB,{className:"text-lg",children:"Alertas"}),u&&u.unread>0&&(0,s.jsx)(c.E,{variant:"destructive",className:"text-xs",children:u.unread})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[i&&(0,s.jsx)(o.$,{variant:"outline",size:"sm",onClick:()=>f(!b),children:(0,s.jsx)(O.A,{className:"h-4 w-4"})}),u&&u.unread>0&&(0,s.jsx)(o.$,{variant:"outline",size:"sm",onClick:x,children:"Marcar todas como lidas"})]})]}),l&&u&&(0,s.jsxs)("div",{className:"flex items-center gap-4 text-sm text-gray-600 mt-2",children:[(0,s.jsxs)("span",{children:["Total: ",u.total]}),(0,s.jsxs)("span",{children:["N\xe3o lidas: ",u.unread]}),(0,s.jsxs)("span",{children:["N\xe3o resolvidas: ",u.unresolved]})]})]}),b&&(0,s.jsx)(eo,{onFiltersChange:y}),(0,s.jsx)(n.Wu,{className:"p-0",children:(0,s.jsx)(K.F,{style:{maxHeight:t},children:0===d.length?(0,s.jsxs)("div",{className:"p-8 text-center text-gray-500",children:[(0,s.jsx)(q.A,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),(0,s.jsx)("p",{children:"Nenhum alerta encontrado"})]}):(0,s.jsx)("div",{className:"space-y-2 p-4",children:d.map(e=>(0,s.jsx)(en,{notification:e,onMarkAsRead:g,onMarkAsResolved:p},e.id))})})})]})}var el=t(28883),ed=t(46767),eu=t(62525),em=t(4229),eh=t(13717),eg=t(89852),ep=t(99474),ex=t(90088),ey=t(99840);let ev=[{value:"low",label:"Baixa",color:"bg-blue-100 text-blue-800"},{value:"medium",label:"M\xe9dia",color:"bg-yellow-100 text-yellow-800"},{value:"high",label:"Alta",color:"bg-orange-100 text-orange-800"},{value:"critical",label:"Cr\xedtica",color:"bg-red-100 text-red-800"}],eb=[{value:"bed_occupancy",label:"Ocupa\xe7\xe3o de Leitos"},{value:"billing_overdue",label:"Faturamento em Atraso"},{value:"appointment_cancelled",label:"Agendamentos Cancelados"},{value:"patient_inactive",label:"Pacientes Inativos"},{value:"revenue_drop",label:"Queda de Receita"},{value:"system_performance",label:"Performance do Sistema"},{value:"custom",label:"Personalizado"}],ef=[{value:"greater_than",label:"Maior que (>)"},{value:"less_than",label:"Menor que (<)"},{value:"equal",label:"Igual a (=)"},{value:"greater_equal",label:"Maior ou igual (>=)"},{value:"less_equal",label:"Menor ou igual (<=)"},{value:"not_equal",label:"Diferente de (!=)"}],ej=[{value:"notification",label:"Notifica\xe7\xe3o",icon:q.A},{value:"email",label:"Email",icon:el.A},{value:"sms",label:"SMS",icon:ed.A}];function ew(e){var a;let{rule:t,onSave:i,onCancel:l}=e,[g,p]=(0,r.useState)({name:(null==t?void 0:t.name)||"",description:(null==t?void 0:t.description)||"",type:(null==t?void 0:t.type)||"custom",severity:(null==t?void 0:t.severity)||"medium",isActive:null==(a=null==t?void 0:t.isActive)||a,conditions:(null==t?void 0:t.conditions)||[{metric:"",operator:"greater_than",value:0,timeWindow:300}],actions:(null==t?void 0:t.actions)||[{type:"notification",config:{}}]}),x=(e,a,t)=>{p(s=>({...s,conditions:s.conditions.map((s,r)=>r===e?{...s,[a]:t}:s)}))};return(0,s.jsxs)("form",{onSubmit:e=>{e.preventDefault(),i(g)},className:"space-y-6",children:[(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(u.Label,{htmlFor:"name",children:"Nome da Regra"}),(0,s.jsx)(eg.p,{id:"name",value:g.name,onChange:e=>p(a=>({...a,name:e.target.value})),placeholder:"Ex: Ocupa\xe7\xe3o cr\xedtica de leitos",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(u.Label,{htmlFor:"type",children:"Tipo"}),(0,s.jsxs)(d.l6,{value:g.type,onValueChange:e=>p(a=>({...a,type:e})),children:[(0,s.jsx)(d.bq,{children:(0,s.jsx)(d.yv,{})}),(0,s.jsx)(d.gC,{children:eb.map(e=>(0,s.jsx)(d.eb,{value:e.value,children:e.label},e.value))})]})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(u.Label,{htmlFor:"description",children:"Descri\xe7\xe3o"}),(0,s.jsx)(ep.T,{id:"description",value:g.description,onChange:e=>p(a=>({...a,description:e.target.value})),placeholder:"Descreva quando este alerta deve ser disparado...",rows:3})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(u.Label,{htmlFor:"severity",children:"Severidade"}),(0,s.jsxs)(d.l6,{value:g.severity,onValueChange:e=>p(a=>({...a,severity:e})),children:[(0,s.jsx)(d.bq,{children:(0,s.jsx)(d.yv,{})}),(0,s.jsx)(d.gC,{children:ev.map(e=>(0,s.jsx)(d.eb,{value:e.value,children:(0,s.jsx)("div",{className:"flex items-center gap-2",children:(0,s.jsx)(c.E,{className:e.color,children:e.label})})},e.value))})]})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-2 pt-6",children:[(0,s.jsx)(ex.Switch,{id:"isActive",checked:g.isActive,onCheckedChange:e=>p(a=>({...a,isActive:e}))}),(0,s.jsx)(u.Label,{htmlFor:"isActive",children:"Regra ativa"})]})]})]}),(0,s.jsx)(m.Separator,{}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("h3",{className:"font-medium flex items-center gap-2",children:[(0,s.jsx)(R.A,{className:"h-4 w-4"}),"Condi\xe7\xf5es"]}),(0,s.jsxs)(o.$,{type:"button",variant:"outline",size:"sm",onClick:()=>{p(e=>({...e,conditions:[...e.conditions,{metric:"",operator:"greater_than",value:0,timeWindow:300}]}))},children:[(0,s.jsx)(h.A,{className:"h-4 w-4 mr-2"}),"Adicionar Condi\xe7\xe3o"]})]}),g.conditions.map((e,a)=>(0,s.jsx)(n.Zp,{className:"p-4",children:(0,s.jsxs)("div",{className:"grid grid-cols-4 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(u.Label,{children:"M\xe9trica"}),(0,s.jsx)(eg.p,{value:e.metric,onChange:e=>x(a,"metric",e.target.value),placeholder:"Ex: bed_occupancy_rate"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(u.Label,{children:"Operador"}),(0,s.jsxs)(d.l6,{value:e.operator,onValueChange:e=>x(a,"operator",e),children:[(0,s.jsx)(d.bq,{children:(0,s.jsx)(d.yv,{})}),(0,s.jsx)(d.gC,{children:ef.map(e=>(0,s.jsx)(d.eb,{value:e.value,children:e.label},e.value))})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(u.Label,{children:"Valor"}),(0,s.jsx)(eg.p,{type:"number",value:e.value,onChange:e=>x(a,"value",parseFloat(e.target.value)),placeholder:"0"})]}),(0,s.jsxs)("div",{className:"flex items-end gap-2",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)(u.Label,{children:"Janela (seg)"}),(0,s.jsx)(eg.p,{type:"number",value:e.timeWindow,onChange:e=>x(a,"timeWindow",parseInt(e.target.value)),placeholder:"300"})]}),g.conditions.length>1&&(0,s.jsx)(o.$,{type:"button",variant:"outline",size:"sm",onClick:()=>{p(e=>({...e,conditions:e.conditions.filter((e,t)=>t!==a)}))},children:(0,s.jsx)(eu.A,{className:"h-4 w-4"})})]})]})},a))]}),(0,s.jsx)(m.Separator,{}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("h3",{className:"font-medium flex items-center gap-2",children:[(0,s.jsx)(q.A,{className:"h-4 w-4"}),"A\xe7\xf5es"]}),(0,s.jsxs)(o.$,{type:"button",variant:"outline",size:"sm",onClick:()=>{p(e=>({...e,actions:[...e.actions,{type:"notification",config:{}}]}))},children:[(0,s.jsx)(h.A,{className:"h-4 w-4 mr-2"}),"Adicionar A\xe7\xe3o"]})]}),g.actions.map((e,a)=>(0,s.jsx)(n.Zp,{className:"p-4",children:(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)(u.Label,{children:"Tipo de A\xe7\xe3o"}),(0,s.jsxs)(d.l6,{value:e.type,onValueChange:e=>{p(t=>({...t,actions:t.actions.map((t,s)=>s===a?{...t,type:e}:t)}))},children:[(0,s.jsx)(d.bq,{children:(0,s.jsx)(d.yv,{})}),(0,s.jsx)(d.gC,{children:ej.map(e=>{let a=e.icon;return(0,s.jsx)(d.eb,{value:e.value,children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(a,{className:"h-4 w-4"}),e.label]})},e.value)})})]})]}),g.actions.length>1&&(0,s.jsx)(o.$,{type:"button",variant:"outline",size:"sm",onClick:()=>{p(e=>({...e,actions:e.actions.filter((e,t)=>t!==a)}))},children:(0,s.jsx)(eu.A,{className:"h-4 w-4"})})]})},a))]}),(0,s.jsxs)("div",{className:"flex justify-end gap-2 pt-4",children:[(0,s.jsxs)(o.$,{type:"button",variant:"outline",onClick:l,children:[(0,s.jsx)(U.A,{className:"h-4 w-4 mr-2"}),"Cancelar"]}),(0,s.jsxs)(o.$,{type:"submit",children:[(0,s.jsx)(em.A,{className:"h-4 w-4 mr-2"}),t?"Atualizar":"Criar"," Regra"]})]})]})}function eN(e){let{rule:a,onEdit:t,onDelete:r,onToggle:i}=e,l=ev.find(e=>e.value===a.severity),d=eb.find(e=>e.value===a.type);return(0,s.jsx)(n.Zp,{className:"transition-all ".concat(a.isActive?"":"opacity-60"),children:(0,s.jsxs)(n.Wu,{className:"p-4",children:[(0,s.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,s.jsx)("h3",{className:"font-medium",children:a.name}),(0,s.jsx)(c.E,{className:null==l?void 0:l.color,children:null==l?void 0:l.label}),!a.isActive&&(0,s.jsx)(c.E,{variant:"secondary",children:"Inativa"})]}),(0,s.jsx)("p",{className:"text-sm text-gray-600 mb-2",children:a.description}),(0,s.jsxs)("div",{className:"flex items-center gap-4 text-xs text-gray-500",children:[(0,s.jsxs)("span",{children:["Tipo: ",null==d?void 0:d.label]}),(0,s.jsxs)("span",{children:["Condi\xe7\xf5es: ",a.conditions.length]}),(0,s.jsxs)("span",{children:["A\xe7\xf5es: ",a.actions.length]})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(ex.Switch,{checked:a.isActive,onCheckedChange:e=>i(a.id,e)}),(0,s.jsx)(o.$,{variant:"ghost",size:"sm",onClick:()=>t(a),children:(0,s.jsx)(eh.A,{className:"h-4 w-4"})}),(0,s.jsx)(o.$,{variant:"ghost",size:"sm",onClick:()=>r(a.id),className:"text-red-600 hover:text-red-700",children:(0,s.jsx)(eu.A,{className:"h-4 w-4"})})]})]}),(0,s.jsxs)("div",{className:"space-y-1",children:[a.conditions.slice(0,2).map((e,a)=>{var t;return(0,s.jsx)("div",{className:"text-xs bg-gray-50 p-2 rounded",children:(0,s.jsxs)("code",{children:[e.metric," ",null==(t=ef.find(a=>a.value===e.operator))?void 0:t.label.split(" ")[0]," ",e.value]})},a)}),a.conditions.length>2&&(0,s.jsxs)("div",{className:"text-xs text-gray-500",children:["+",a.conditions.length-2," condi\xe7\xf5es adicionais"]})]})]})})}function eA(e){let{className:a=""}=e,{rules:t,isLoading:i,error:c,createRule:l,updateRule:d,deleteRule:u,toggleRule:m}=ea(),[g,p]=(0,r.useState)(!1),[x,v]=(0,r.useState)(null),b=async e=>{try{await l(e),p(!1)}catch(e){}},f=async e=>{if(x)try{await d(x.id,e),v(null)}catch(e){}},j=async e=>{if(confirm("Tem certeza que deseja excluir esta regra?"))try{await u(e)}catch(e){}},N=async(e,a)=>{try{await m(e,a)}catch(e){}};return i?(0,s.jsx)(n.Zp,{className:a,children:(0,s.jsx)(n.Wu,{className:"p-6",children:(0,s.jsx)("div",{className:"flex items-center justify-center",children:(0,s.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})})})}):c?(0,s.jsx)(n.Zp,{className:a,children:(0,s.jsx)(n.Wu,{className:"p-6",children:(0,s.jsxs)("div",{className:"text-center text-red-600",children:[(0,s.jsx)(w.A,{className:"h-8 w-8 mx-auto mb-2"}),(0,s.jsx)("p",{children:c})]})})}):(0,s.jsxs)(n.Zp,{className:a,children:[(0,s.jsx)(n.aR,{children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(y.A,{className:"h-5 w-5"}),(0,s.jsx)(n.ZB,{children:"Configura\xe7\xe3o de Alertas"})]}),(0,s.jsxs)(ey.lG,{open:g,onOpenChange:p,children:[(0,s.jsx)(ey.zM,{asChild:!0,children:(0,s.jsxs)(o.$,{children:[(0,s.jsx)(h.A,{className:"h-4 w-4 mr-2"}),"Nova Regra"]})}),(0,s.jsxs)(ey.Cf,{className:"max-w-4xl max-h-[90vh]",children:[(0,s.jsx)(ey.c7,{children:(0,s.jsx)(ey.L3,{children:"Criar Nova Regra de Alerta"})}),(0,s.jsx)(K.F,{className:"max-h-[70vh]",children:(0,s.jsx)(ew,{onSave:b,onCancel:()=>p(!1)})})]})]})]})}),(0,s.jsxs)(n.Wu,{children:[0===t.length?(0,s.jsxs)("div",{className:"text-center py-8",children:[(0,s.jsx)(y.A,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),(0,s.jsx)("p",{className:"text-gray-500 mb-4",children:"Nenhuma regra de alerta configurada"}),(0,s.jsxs)(o.$,{onClick:()=>p(!0),children:[(0,s.jsx)(h.A,{className:"h-4 w-4 mr-2"}),"Criar Primeira Regra"]})]}):(0,s.jsx)("div",{className:"space-y-4",children:t.map(e=>(0,s.jsx)(eN,{rule:e,onEdit:v,onDelete:j,onToggle:N},e.id))}),(0,s.jsx)(ey.lG,{open:!!x,onOpenChange:()=>v(null),children:(0,s.jsxs)(ey.Cf,{className:"max-w-4xl max-h-[90vh]",children:[(0,s.jsx)(ey.c7,{children:(0,s.jsx)(ey.L3,{children:"Editar Regra de Alerta"})}),(0,s.jsx)(K.F,{className:"max-h-[70vh]",children:x&&(0,s.jsx)(ew,{rule:x,onSave:f,onCancel:()=>v(null)})})]})})]})]})}let eC=(0,r.createContext)(void 0),eR={low:{icon:I.A,color:"text-blue-600",bgColor:"bg-blue-50",borderColor:"border-blue-200"},medium:{icon:F.A,color:"text-yellow-600",bgColor:"bg-yellow-50",borderColor:"border-yellow-200"},high:{icon:w.A,color:"text-orange-600",bgColor:"bg-orange-50",borderColor:"border-orange-200"},critical:{icon:L.A,color:"text-red-600",bgColor:"bg-red-50",borderColor:"border-red-200"}};function eS(e){let{notification:a,onMarkAsRead:t}=e,r=eR[a.severity],i=r.icon;return(0,s.jsxs)("div",{className:"flex items-start gap-3 p-4 rounded-lg border ".concat(r.bgColor," ").concat(r.borderColor," max-w-md"),children:[(0,s.jsx)("div",{className:"p-2 rounded-full ".concat(r.color),children:(0,s.jsx)(i,{className:"h-4 w-4"})}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,s.jsx)("h4",{className:"font-medium text-sm text-gray-900",children:a.title}),(0,s.jsx)("button",{onClick:()=>t(a.id),className:"text-gray-400 hover:text-gray-600 transition-colors",children:(0,s.jsx)(U.A,{className:"h-4 w-4"})})]}),(0,s.jsx)("p",{className:"text-sm text-gray-700 mb-2",children:a.message}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("span",{className:"text-xs font-medium px-2 py-1 rounded ".concat(r.color," ").concat(r.bgColor),children:a.severity.toUpperCase()}),(0,s.jsx)("button",{onClick:()=>t(a.id),className:"text-xs text-blue-600 hover:text-blue-700 font-medium",children:"Marcar como lida"})]})]})]})}function ek(e){let{children:a}=e,[t,i]=(0,r.useState)(!0),[n,o]=(0,r.useState)(!0),[c,l]=(0,r.useState)(null),{notifications:d,markAsRead:u}=ea(),m=(0,r.useCallback)(e=>{if(n)try{let a=new(window.AudioContext||window.webkitAudioContext),t=a.createOscillator(),s=a.createGain();t.connect(s),s.connect(a.destination);let r={low:440,medium:523,high:659,critical:880};t.frequency.setValueAtTime(r[e],a.currentTime),t.type="critical"===e?"sawtooth":"sine";let i={low:.1,medium:.2,high:.3,critical:.4};s.gain.setValueAtTime(i[e],a.currentTime),s.gain.exponentialRampToValueAtTime(.01,a.currentTime+.5),t.start(a.currentTime),t.stop(a.currentTime+.5),"critical"===e&&setTimeout(()=>{let t=a.createOscillator(),s=a.createGain();t.connect(s),s.connect(a.destination),t.frequency.setValueAtTime(r[e],a.currentTime),t.type="sawtooth",s.gain.setValueAtTime(i[e],a.currentTime),s.gain.exponentialRampToValueAtTime(.01,a.currentTime+.5),t.start(a.currentTime),t.stop(a.currentTime+.5)},600)}catch(e){}},[n]),h=(0,r.useCallback)(e=>{if(!t)return;m(e.severity);let a=D.o.custom((0,s.jsx)(eS,{notification:e,onMarkAsRead:e=>{u(e),D.o.dismiss(a)}}),{duration:"critical"===e.severity?1e4:"high"===e.severity?7e3:"medium"===e.severity?5e3:4e3,position:"top-right"});if("Notification"in window&&"granted"===Notification.permission){let a=new Notification(e.title,{body:e.message,icon:"/favicon.ico",tag:e.id,requireInteraction:"critical"===e.severity});a.onclick=()=>{window.focus(),a.close(),u(e.id)},setTimeout(()=>{a.close()},"critical"===e.severity?1e4:5e3)}},[t,m,u]),g=(0,r.useCallback)(function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info",t={success:B.A,error:w.A,warning:F.A,info:I.A}[a];D.o.custom((0,s.jsxs)("div",{className:"flex items-center gap-3 p-4 bg-white rounded-lg border shadow-lg",children:[(0,s.jsx)(t,{className:"h-5 w-5 ".concat({success:"text-green-600",error:"text-red-600",warning:"text-yellow-600",info:"text-blue-600"}[a])}),(0,s.jsx)("span",{className:"text-sm text-gray-900",children:e})]}),{duration:3e3,position:"bottom-right"})},[]);return(0,r.useEffect)(()=>{if(0===d.length)return;let e=d.filter(e=>!e.isRead).sort((e,a)=>new Date(a.triggeredAt).getTime()-new Date(e.triggeredAt).getTime())[0];e&&e.id!==c&&(l(e.id),h(e))},[d,c,h]),(0,r.useEffect)(()=>{"Notification"in window&&"default"===Notification.permission&&Notification.requestPermission()},[]),(0,s.jsx)(eC.Provider,{value:{showNotification:h,showToast:g,isEnabled:t,setEnabled:i,soundEnabled:n,setSoundEnabled:o},children:a})}var eD=t(15273),eE=t(9771),eT=t(81497),eM=t(75021);function eP(e){let{className:a}=e,{isEnabled:t,setEnabled:i,soundEnabled:l,setSoundEnabled:d,showToast:h,showNotification:g}=function(){let e=(0,r.useContext)(eC);if(void 0===e)throw Error("useNotifications deve ser usado dentro de um NotificationProvider");return e}(),p=e=>{g({low:{id:"test-".concat(Date.now()),title:"Teste - Informa\xe7\xe3o",message:"Esta \xe9 uma notifica\xe7\xe3o de teste com severidade baixa.",severity:"low",type:"info",triggeredAt:new Date().toISOString(),isRead:!1,ruleId:"test-rule",ruleName:"Teste",actions:[]},medium:{id:"test-".concat(Date.now()),title:"Teste - Aten\xe7\xe3o",message:"Esta \xe9 uma notifica\xe7\xe3o de teste com severidade m\xe9dia.",severity:"medium",type:"warning",triggeredAt:new Date().toISOString(),isRead:!1,ruleId:"test-rule",ruleName:"Teste",actions:[]},high:{id:"test-".concat(Date.now()),title:"Teste - Importante",message:"Esta \xe9 uma notifica\xe7\xe3o de teste com severidade alta.",severity:"high",type:"warning",triggeredAt:new Date().toISOString(),isRead:!1,ruleId:"test-rule",ruleName:"Teste",actions:[]},critical:{id:"test-".concat(Date.now()),title:"Teste - Cr\xedtico",message:"Esta \xe9 uma notifica\xe7\xe3o de teste com severidade cr\xedtica.",severity:"critical",type:"error",triggeredAt:new Date().toISOString(),isRead:!1,ruleId:"test-rule",ruleName:"Teste",actions:[]}}[e])},x="Notification"in window?Notification.permission:"unsupported",v=async()=>{"Notification"in window&&("granted"===await Notification.requestPermission()?h("Permiss\xe3o para notifica\xe7\xf5es concedida!","success"):h("Permiss\xe3o para notifica\xe7\xf5es negada.","error"))};return(0,s.jsx)("div",{className:a,children:(0,s.jsxs)(n.Zp,{children:[(0,s.jsxs)(n.aR,{children:[(0,s.jsxs)(n.ZB,{className:"flex items-center gap-2",children:[(0,s.jsx)(y.A,{className:"h-5 w-5"}),"Configura\xe7\xf5es de Notifica\xe7\xe3o"]}),(0,s.jsx)(n.BT,{children:"Configure como voc\xea deseja receber alertas e notifica\xe7\xf5es do sistema."})]}),(0,s.jsxs)(n.Wu,{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("h3",{className:"text-sm font-medium text-gray-900",children:"Configura\xe7\xf5es Gerais"}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)(q.A,{className:"h-4 w-4 text-gray-500"}),(0,s.jsxs)("div",{children:[(0,s.jsx)(u.Label,{htmlFor:"notifications-enabled",className:"text-sm font-medium",children:"Ativar Notifica\xe7\xf5es"}),(0,s.jsx)("p",{className:"text-xs text-gray-500",children:"Receber alertas e notifica\xe7\xf5es do sistema"})]})]}),(0,s.jsx)(ex.Switch,{id:"notifications-enabled",checked:t,onCheckedChange:i})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[l?(0,s.jsx)(eD.A,{className:"h-4 w-4 text-gray-500"}):(0,s.jsx)(eE.A,{className:"h-4 w-4 text-gray-500"}),(0,s.jsxs)("div",{children:[(0,s.jsx)(u.Label,{htmlFor:"sound-enabled",className:"text-sm font-medium",children:"Sons de Notifica\xe7\xe3o"}),(0,s.jsx)("p",{className:"text-xs text-gray-500",children:"Reproduzir sons quando receber alertas"})]})]}),(0,s.jsx)(ex.Switch,{id:"sound-enabled",checked:l,onCheckedChange:d,disabled:!t})]})]}),(0,s.jsx)(m.Separator,{}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("h3",{className:"text-sm font-medium text-gray-900",children:"Notifica\xe7\xf5es do Navegador"}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)(ed.A,{className:"h-4 w-4 text-gray-500"}),(0,s.jsxs)("div",{children:[(0,s.jsx)(u.Label,{className:"text-sm font-medium",children:"Notifica\xe7\xf5es do Sistema"}),(0,s.jsx)("p",{className:"text-xs text-gray-500",children:"Mostrar notifica\xe7\xf5es mesmo quando a aba n\xe3o estiver ativa"})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(c.E,{variant:"granted"===x?"default":"denied"===x?"destructive":"secondary",children:"granted"===x?"Ativado":"denied"===x?"Negado":"default"===x?"Pendente":"N\xe3o Suportado"}),"granted"!==x&&"unsupported"!==x&&(0,s.jsx)(o.$,{size:"sm",variant:"outline",onClick:v,children:"Ativar"})]})]})]}),(0,s.jsx)(m.Separator,{}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("h3",{className:"text-sm font-medium text-gray-900",children:"Canais de Notifica\xe7\xe3o"}),(0,s.jsx)("p",{className:"text-xs text-gray-500 mb-4",children:"Funcionalidades futuras para integra\xe7\xe3o com outros sistemas."}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3 p-3 border rounded-lg opacity-50",children:[(0,s.jsx)(el.A,{className:"h-4 w-4 text-gray-400"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium text-gray-400",children:"Email"}),(0,s.jsx)("p",{className:"text-xs text-gray-400",children:"Em breve"})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-3 p-3 border rounded-lg opacity-50",children:[(0,s.jsx)(eT.A,{className:"h-4 w-4 text-gray-400"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium text-gray-400",children:"SMS"}),(0,s.jsx)("p",{className:"text-xs text-gray-400",children:"Em breve"})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-3 p-3 border rounded-lg opacity-50",children:[(0,s.jsx)(q.A,{className:"h-4 w-4 text-gray-400"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium text-gray-400",children:"Push"}),(0,s.jsx)("p",{className:"text-xs text-gray-400",children:"Em breve"})]})]})]})]}),(0,s.jsx)(m.Separator,{}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("h3",{className:"text-sm font-medium text-gray-900 flex items-center gap-2",children:[(0,s.jsx)(eM.A,{className:"h-4 w-4"}),"Testar Notifica\xe7\xf5es"]}),(0,s.jsx)("p",{className:"text-xs text-gray-500",children:"Teste diferentes tipos de notifica\xe7\xe3o para verificar suas configura\xe7\xf5es."}),(0,s.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2",children:[(0,s.jsx)(o.$,{size:"sm",variant:"outline",onClick:()=>p("low"),disabled:!t,className:"text-blue-600 border-blue-200 hover:bg-blue-50",children:"Baixa"}),(0,s.jsx)(o.$,{size:"sm",variant:"outline",onClick:()=>p("medium"),disabled:!t,className:"text-yellow-600 border-yellow-200 hover:bg-yellow-50",children:"M\xe9dia"}),(0,s.jsx)(o.$,{size:"sm",variant:"outline",onClick:()=>p("high"),disabled:!t,className:"text-orange-600 border-orange-200 hover:bg-orange-50",children:"Alta"}),(0,s.jsx)(o.$,{size:"sm",variant:"outline",onClick:()=>p("critical"),disabled:!t,className:"text-red-600 border-red-200 hover:bg-red-50",children:"Cr\xedtica"})]})]})]})]})})}var eI=t(55747),eF=t(57434),eL=t(65112),e_=t(26597),eB=t(3925),ez=t(63008);class eU{async exportToPDF(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{format:"pdf"},t=new e_.default({orientation:a.orientation||"portrait",unit:"mm",format:"a4"}),s=t.internal.pageSize.getWidth(),r=t.internal.pageSize.getHeight(),i=20;if(t.setFontSize(18),t.setFont("helvetica","bold"),t.text(e.title,s/2,i,{align:"center"}),i+=10,e.subtitle&&(t.setFontSize(12),t.setFont("helvetica","normal"),t.text(e.subtitle,s/2,i,{align:"center"}),i+=10),a.includeMetadata&&e.metadata){i+=5,t.setFontSize(10),t.setFont("helvetica","normal");let a=(0,ez.GP)(e.metadata.generatedAt,"dd/MM/yyyy '\xe0s' HH:mm",{locale:es.F});t.text("Gerado em: ".concat(a),20,i),i+=5,e.metadata.generatedBy&&(t.text("Gerado por: ".concat(e.metadata.generatedBy),20,i),i+=5)}i+=10;let n=(s-40)/e.headers.length;t.setFontSize(10),t.setFont("helvetica","bold"),t.setFillColor(240,240,240),e.headers.forEach((e,a)=>{let s=20+a*n;t.rect(s,i,n,8,"F"),t.text(e,s+2,i+5)}),i+=8,t.setFont("helvetica","normal"),e.data.forEach((e,a)=>{i>r-30&&(t.addPage(),i=20),e.forEach((e,a)=>{let s=20+a*n;t.text(String(e),s+2,i+5)}),i+=8});let o=a.filename||"relatorio_".concat((0,ez.GP)(new Date,"yyyy-MM-dd_HH-mm"),".pdf");t.save(o)}async exportToExcel(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{format:"excel"},t=eB.Wp.book_new(),s=[[e.title],e.subtitle?[e.subtitle]:[],[],e.headers,...e.data].filter(e=>e.length>0),r=eB.Wp.aoa_to_sheet(s),i=eB.Wp.decode_range(r["!ref"]||"A1");r.A1&&(r.A1.s={font:{bold:!0,sz:16},alignment:{horizontal:"center"}}),e.subtitle&&r.A2&&(r.A2.s={font:{sz:12},alignment:{horizontal:"center"}});let n=e.subtitle?4:3;for(let e=i.s.c;e<=i.e.c;e++){let a=eB.Wp.encode_cell({r:n-1,c:e});r[a]&&(r[a].s={font:{bold:!0},fill:{fgColor:{rgb:"F0F0F0"}}})}let o=e.headers.map(e=>({wch:Math.max(e.length,15)}));if(r["!cols"]=o,eB.Wp.book_append_sheet(t,r,"Relat\xf3rio"),a.includeMetadata&&e.metadata){let a=[["Metadados do Relat\xf3rio"],[],["Gerado em:",(0,ez.GP)(e.metadata.generatedAt,"dd/MM/yyyy '\xe0s' HH:mm",{locale:es.F})],["Gerado por:",e.metadata.generatedBy||"Sistema"],[]];e.metadata.filters&&(a.push(["Filtros Aplicados:"]),Object.entries(e.metadata.filters).forEach(e=>{let[t,s]=e;a.push([t,String(s)])}));let s=eB.Wp.aoa_to_sheet(a);eB.Wp.book_append_sheet(t,s,"Metadados")}let c=a.filename||"relatorio_".concat((0,ez.GP)(new Date,"yyyy-MM-dd_HH-mm"),".xlsx");eB._h(t,c)}async export(e,a){if("pdf"===a.format)await this.exportToPDF(e,a);else if("excel"===a.format)await this.exportToExcel(e,a);else throw Error("Formato de exporta\xe7\xe3o n\xe3o suportado: ".concat(a.format))}formatMetricsForExport(e,a,t){return{title:a,subtitle:t,headers:["M\xe9trica","Valor","Unidade","Categoria","\xdaltima Atualiza\xe7\xe3o"],data:e.map(e=>[e.name||e.label,e.value,e.unit||"",e.category||"",e.updatedAt?(0,ez.GP)(new Date(e.updatedAt),"dd/MM/yyyy HH:mm",{locale:es.F}):""]),metadata:{generatedAt:new Date,generatedBy:"Sistema BI"}}}formatKPIsForExport(e,a,t){return{title:a,subtitle:t,headers:["KPI","Valor Atual","Meta","Varia\xe7\xe3o","Status","Per\xedodo"],data:e.map(e=>[e.name||e.label,e.currentValue,e.target||"N/A",e.variation?"".concat(e.variation>0?"+":"").concat(e.variation,"%"):"N/A",e.status||"N/A",e.period||"N/A"]),metadata:{generatedAt:new Date,generatedBy:"Sistema BI"}}}formatAlertsForExport(e,a,t){return{title:a,subtitle:t,headers:["Alerta","Severidade","Tipo","Status","Disparado em","Resolvido em"],data:e.map(e=>[e.title||e.name,e.severity,e.type,e.isResolved?"Resolvido":"Ativo",(0,ez.GP)(new Date(e.triggeredAt),"dd/MM/yyyy HH:mm",{locale:es.F}),e.resolvedAt?(0,ez.GP)(new Date(e.resolvedAt),"dd/MM/yyyy HH:mm",{locale:es.F}):"N/A"]),metadata:{generatedAt:new Date,generatedBy:"Sistema BI"}}}}let eq=new eU;var eO=t(9074),eV=t(29504);function eW(){let[e,a]=(0,r.useState)({isExporting:!1,error:null}),{metrics:t}=(0,eO.B)(),{kpis:s}=(0,eV.h)(),{notifications:i}=ea(),n=(0,r.useCallback)(async(e,t)=>{a(e=>({...e,isExporting:!0,error:null}));try{await eq.export(e,t),D.o.success("Relat\xf3rio exportado com sucesso em formato ".concat(t.format.toUpperCase(),"!"),{description:"Arquivo: ".concat(t.filename||"relatorio",".").concat("pdf"===t.format?"pdf":"xlsx")})}catch(t){let e=t instanceof Error?t.message:"Erro desconhecido";a(a=>({...a,error:e})),D.o.error("Erro ao exportar relat\xf3rio",{description:e})}finally{a(e=>({...e,isExporting:!1}))}},[]),o=(0,r.useCallback)(async(e,a)=>{let s=t;(null==a?void 0:a.category)&&(s=t.filter(e=>e.category===a.category));let r=eq.formatMetricsForExport(s,"Relat\xf3rio de M\xe9tricas",(null==a?void 0:a.dateRange)?"Per\xedodo: ".concat(a.dateRange.start.toLocaleDateString()," - ").concat(a.dateRange.end.toLocaleDateString()):void 0);a&&(r.metadata={...r.metadata,filters:a}),await r(r,{...e,filename:e.filename||"metricas_".concat(new Date().toISOString().split("T")[0])})},[t,n]),c=(0,r.useCallback)(async(e,a)=>{let t=s;(null==a?void 0:a.status)&&(t=s.filter(e=>e.status===a.status)),(null==a?void 0:a.category)&&(t=s.filter(e=>e.category===a.category));let r=eq.formatKPIsForExport(t,"Relat\xf3rio de KPIs","Indicadores Chave de Performance");a&&(r.metadata={...r.metadata,filters:a}),await r(r,{...e,filename:e.filename||"kpis_".concat(new Date().toISOString().split("T")[0])})},[s,n]),l=(0,r.useCallback)(async(e,a)=>{let t=i;(null==a?void 0:a.severity)&&a.severity.length>0&&(t=i.filter(e=>a.severity.includes(e.severity))),(null==a?void 0:a.isResolved)!==void 0&&(t=t.filter(e=>e.isResolved===a.isResolved)),(null==a?void 0:a.dateRange)&&(t=t.filter(e=>{let t=new Date(e.triggeredAt);return t>=a.dateRange.start&&t<=a.dateRange.end}));let s=eq.formatAlertsForExport(t,"Relat\xf3rio de Alertas",(null==a?void 0:a.dateRange)?"Per\xedodo: ".concat(a.dateRange.start.toLocaleDateString()," - ").concat(a.dateRange.end.toLocaleDateString()):void 0);a&&(s.metadata={...s.metadata,filters:a}),await s(s,{...e,filename:e.filename||"alertas_".concat(new Date().toISOString().split("T")[0])})},[i,n]),d=(0,r.useCallback)(async function(e){let a=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r={title:"Relat\xf3rio Completo do Dashboard BI",subtitle:"Gerado em ".concat(new Date().toLocaleDateString("pt-BR")),headers:["Se\xe7\xe3o","Item","Valor","Status","Observa\xe7\xf5es"],data:[],metadata:{generatedAt:new Date,generatedBy:"Sistema BI",filters:{includeCharts:a,sections:["metrics","kpis","alerts"]}}};t.forEach(e=>{r.data.push(["M\xe9tricas",e.name||e.label,"".concat(e.value," ").concat(e.unit||""),"Ativo",e.description||""])}),s.forEach(e=>{r.data.push(["KPIs",e.name||e.label,"".concat(e.currentValue," (Meta: ").concat(e.target||"N/A",")"),e.status||"N/A",e.variation?"Varia\xe7\xe3o: ".concat(e.variation>0?"+":"").concat(e.variation,"%"):""])}),i.filter(e=>!e.isResolved).forEach(e=>{r.data.push(["Alertas",e.title,e.severity.toUpperCase(),e.isResolved?"Resolvido":"Ativo",e.message])}),await n(r,{...e,filename:e.filename||"dashboard_completo_".concat(new Date().toISOString().split("T")[0]),includeCharts:a})},[t,s,i,n]);return{...e,exportData:n,exportMetrics:o,exportKPIs:c,exportAlerts:l,exportDashboard:d}}function eK(e){let{trigger:a,defaultType:t="dashboard",title:i="Exportar Relat\xf3rio",open:n,onOpenChange:c,onExport:l,isExporting:h}=e,[p,x]=(0,r.useState)(!1),y=c||x,[v,b]=(0,r.useState)(t),[f,j]=(0,r.useState)("pdf"),[N,A]=(0,r.useState)(""),[R,S]=(0,r.useState)("portrait"),[k,D]=(0,r.useState)(!0),[E,T]=(0,r.useState)(!1),[M,P]=(0,r.useState)({category:"",severity:[],status:"",isResolved:void 0,dateRange:{start:"",end:""}}),{isExporting:I,exportMetrics:F,exportKPIs:L,exportAlerts:_,exportDashboard:B}=eW(),z=void 0!==h?h:I,U=async()=>{let e={format:f,filename:N||void 0,orientation:R,includeMetadata:k,includeCharts:E};try{if(l)await l(v,f,e);else switch(v){case"metrics":await F(e,{category:M.category||void 0,dateRange:M.dateRange.start&&M.dateRange.end?{start:new Date(M.dateRange.start),end:new Date(M.dateRange.end)}:void 0});break;case"kpis":await L(e,{status:M.status||void 0,category:M.category||void 0});break;case"alerts":await _(e,{severity:M.severity.length>0?M.severity:void 0,isResolved:M.isResolved,dateRange:M.dateRange.start&&M.dateRange.end?{start:new Date(M.dateRange.start),end:new Date(M.dateRange.end)}:void 0});break;case"dashboard":await B(e,E)}y(!1)}catch(e){}};return(0,s.jsxs)(ey.lG,{open:void 0!==n?n:p,onOpenChange:y,children:[(0,s.jsx)(ey.zM,{asChild:!0,children:a||(0,s.jsxs)(o.$,{variant:"outline",size:"sm",children:[(0,s.jsx)(g.A,{className:"h-4 w-4 mr-2"}),"Exportar"]})}),(0,s.jsxs)(ey.Cf,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[(0,s.jsxs)(ey.c7,{children:[(0,s.jsxs)(ey.L3,{className:"flex items-center gap-2",children:[(0,s.jsx)(g.A,{className:"h-5 w-5"}),i]}),(0,s.jsx)(ey.rr,{children:"Configure as op\xe7\xf5es de exporta\xe7\xe3o para gerar seu relat\xf3rio."})]}),(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsx)(u.Label,{className:"text-sm font-medium",children:"Tipo de Relat\xf3rio"}),(0,s.jsx)(eI.z,{value:v,onValueChange:e=>b(e),className:"grid grid-cols-2 gap-4",children:["metrics","kpis","alerts","dashboard"].map(e=>(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(eI.C,{value:e,id:e}),(0,s.jsxs)(u.Label,{htmlFor:e,className:"flex items-center gap-2 cursor-pointer",children:[(e=>{switch(e){case"metrics":return(0,s.jsx)(C.A,{className:"h-4 w-4"});case"kpis":return(0,s.jsx)(eF.A,{className:"h-4 w-4"});case"alerts":return(0,s.jsx)(w.A,{className:"h-4 w-4"});case"dashboard":return(0,s.jsx)(eL.A,{className:"h-4 w-4"});default:return(0,s.jsx)(g.A,{className:"h-4 w-4"})}})(e),(e=>{switch(e){case"metrics":return"M\xe9tricas";case"kpis":return"KPIs";case"alerts":return"Alertas";case"dashboard":return"Dashboard Completo";default:return"Relat\xf3rio"}})(e)]})]},e))})]}),(0,s.jsx)(m.Separator,{}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(u.Label,{htmlFor:"format",children:"Formato"}),(0,s.jsxs)(d.l6,{value:f,onValueChange:e=>j(e),children:[(0,s.jsx)(d.bq,{children:(0,s.jsx)(d.yv,{})}),(0,s.jsxs)(d.gC,{children:[(0,s.jsx)(d.eb,{value:"pdf",children:"PDF"}),(0,s.jsx)(d.eb,{value:"excel",children:"Excel"})]})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(u.Label,{htmlFor:"orientation",children:"Orienta\xe7\xe3o"}),(0,s.jsxs)(d.l6,{value:R,onValueChange:e=>S(e),children:[(0,s.jsx)(d.bq,{children:(0,s.jsx)(d.yv,{})}),(0,s.jsxs)(d.gC,{children:[(0,s.jsx)(d.eb,{value:"portrait",children:"Retrato"}),(0,s.jsx)(d.eb,{value:"landscape",children:"Paisagem"})]})]})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(u.Label,{htmlFor:"filename",children:"Nome do Arquivo (opcional)"}),(0,s.jsx)(eg.p,{id:"filename",value:N,onChange:e=>A(e.target.value),placeholder:"Ex: relatorio_mensal"})]}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsx)(u.Label,{className:"text-sm font-medium",children:"Op\xe7\xf5es Avan\xe7adas"}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(W.S,{id:"metadata",checked:k,onCheckedChange:e=>D(e)}),(0,s.jsx)(u.Label,{htmlFor:"metadata",className:"text-sm",children:"Incluir metadados (data de gera\xe7\xe3o, filtros aplicados)"})]}),"dashboard"===v&&(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(W.S,{id:"charts",checked:E,onCheckedChange:e=>T(e)}),(0,s.jsx)(u.Label,{htmlFor:"charts",className:"text-sm",children:"Incluir gr\xe1ficos (apenas PDF)"})]})]}),(0,s.jsx)(m.Separator,{}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)(u.Label,{className:"text-sm font-medium",children:"Filtros"}),("metrics"===v||"kpis"===v)&&(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(u.Label,{htmlFor:"category",className:"text-xs",children:"Categoria"}),(0,s.jsxs)(d.l6,{value:M.category,onValueChange:e=>P(a=>({...a,category:e})),children:[(0,s.jsx)(d.bq,{children:(0,s.jsx)(d.yv,{placeholder:"Todas as categorias"})}),(0,s.jsxs)(d.gC,{children:[(0,s.jsx)(d.eb,{value:"",children:"Todas as categorias"}),(0,s.jsx)(d.eb,{value:"appointments",children:"Agendamentos"}),(0,s.jsx)(d.eb,{value:"billing",children:"Faturamento"}),(0,s.jsx)(d.eb,{value:"beds",children:"Leitos"}),(0,s.jsx)(d.eb,{value:"patients",children:"Pacientes"})]})]})]}),"alerts"===v&&(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(u.Label,{className:"text-xs",children:"Severidade"}),(0,s.jsx)("div",{className:"flex flex-wrap gap-2",children:["low","medium","high","critical"].map(e=>(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(W.S,{id:"severity-".concat(e),checked:M.severity.includes(e),onCheckedChange:a=>{a?P(a=>({...a,severity:[...a.severity,e]})):P(a=>({...a,severity:a.severity.filter(a=>a!==e)}))}}),(0,s.jsx)(u.Label,{htmlFor:"severity-".concat(e),className:"text-xs capitalize",children:"low"===e?"Baixa":"medium"===e?"M\xe9dia":"high"===e?"Alta":"Cr\xedtica"})]},e))})]}),("metrics"===v||"alerts"===v)&&(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(u.Label,{htmlFor:"start-date",className:"text-xs",children:"Data Inicial"}),(0,s.jsx)(eg.p,{id:"start-date",type:"date",value:M.dateRange.start,onChange:e=>P(a=>({...a,dateRange:{...a.dateRange,start:e.target.value}}))})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(u.Label,{htmlFor:"end-date",className:"text-xs",children:"Data Final"}),(0,s.jsx)(eg.p,{id:"end-date",type:"date",value:M.dateRange.end,onChange:e=>P(a=>({...a,dateRange:{...a.dateRange,end:e.target.value}}))})]})]})]})]}),(0,s.jsxs)(ey.Es,{children:[(0,s.jsx)(o.$,{variant:"outline",onClick:()=>y(!1),children:"Cancelar"}),(0,s.jsx)(o.$,{onClick:U,disabled:z,children:z?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Exportando..."]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(g.A,{className:"h-4 w-4 mr-2"}),"Exportar ",f.toUpperCase()]})})]})]})]})}var eG=t(26715),e$=t(32960),eH=t(5041),eQ=t(31886);class eZ{async getDashboards(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=new URLSearchParams;return Object.entries(e).forEach(e=>{let[t,s]=e;null!=s&&(Array.isArray(s)?s.forEach(e=>a.append(t,e.toString())):a.append(t,s.toString()))}),(await eQ.A.get("".concat(this.baseUrl,"/dashboards?").concat(a))).data}async getDashboard(e){return(await eQ.A.get("".concat(this.baseUrl,"/dashboards/").concat(e))).data}async createDashboard(e){return(await eQ.A.post("".concat(this.baseUrl,"/dashboards"),e)).data}async updateDashboard(e,a){return(await eQ.A.put("".concat(this.baseUrl,"/dashboards/").concat(e),a)).data}async deleteDashboard(e){await eQ.A.delete("".concat(this.baseUrl,"/dashboards/").concat(e))}async duplicateDashboard(e,a){return(await eQ.A.post("".concat(this.baseUrl,"/dashboards/").concat(e,"/duplicate"),{name:a||"Copy of Dashboard"})).data}async addWidget(e,a){return(await eQ.A.post("".concat(this.baseUrl,"/dashboards/").concat(e,"/widgets"),a)).data}async updateWidget(e,a,t){return(await eQ.A.put("".concat(this.baseUrl,"/dashboards/").concat(e,"/widgets/").concat(a),t)).data}async deleteWidget(e,a){await eQ.A.delete("".concat(this.baseUrl,"/dashboards/").concat(e,"/widgets/").concat(a))}async moveWidget(e,a,t){return(await eQ.A.patch("".concat(this.baseUrl,"/dashboards/").concat(e,"/widgets/").concat(a,"/position"),t)).data}async resizeWidget(e,a,t){return(await eQ.A.patch("".concat(this.baseUrl,"/dashboards/").concat(e,"/widgets/").concat(a,"/size"),t)).data}async updateLayout(e,a){return(await eQ.A.put("".concat(this.baseUrl,"/dashboards/").concat(e,"/layout"),a)).data}async saveLayoutPreset(e,a,t){return(await eQ.A.post("".concat(this.baseUrl,"/dashboards/").concat(e,"/layout-presets"),{name:a,layout:t})).data}async getLayoutPresets(e){return(await eQ.A.get("".concat(this.baseUrl,"/dashboards/").concat(e,"/layout-presets"))).data}async updateFilters(e,a){return(await eQ.A.put("".concat(this.baseUrl,"/dashboards/").concat(e,"/filters"),{filters:a})).data}async getFilterOptions(e,a){return(await eQ.A.get("".concat(this.baseUrl,"/dashboards/").concat(e,"/filters/").concat(a,"/options"))).data}async getAvailableDataSources(){return(await eQ.A.get("".concat(this.baseUrl,"/data-sources"))).data}async testDataSource(e){return(await eQ.A.post("".concat(this.baseUrl,"/data-sources/test"),e)).data}async getDataSourceSchema(e){return(await eQ.A.post("".concat(this.baseUrl,"/data-sources/schema"),e)).data}async previewData(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;return(await eQ.A.post("".concat(this.baseUrl,"/data-sources/preview"),{...e,limit:a})).data}async getWidgetData(e,a,t){return(await eQ.A.post("".concat(this.baseUrl,"/dashboards/").concat(e,"/widgets/").concat(a,"/data"),{filters:t})).data}async refreshWidgetData(e,a){return(await eQ.A.post("".concat(this.baseUrl,"/dashboards/").concat(e,"/widgets/").concat(a,"/refresh"))).data}async refreshAllWidgets(e){return(await eQ.A.post("".concat(this.baseUrl,"/dashboards/").concat(e,"/refresh"))).data}async getTemplates(e){return(await eQ.A.get("".concat(this.baseUrl,"/templates").concat(e?"?category=".concat(e):""))).data}async getTemplate(e){return(await eQ.A.get("".concat(this.baseUrl,"/templates/").concat(e))).data}async createFromTemplate(e,a,t){return(await eQ.A.post("".concat(this.baseUrl,"/templates/").concat(e,"/create"),{name:a,customizations:t})).data}async saveAsTemplate(e,a){return(await eQ.A.post("".concat(this.baseUrl,"/dashboards/").concat(e,"/save-as-template"),a)).data}async shareDashboard(e,a){return(await eQ.A.post("".concat(this.baseUrl,"/dashboards/").concat(e,"/share"),a)).data}async getSharedDashboards(){return(await eQ.A.get("".concat(this.baseUrl,"/shared"))).data}async revokeShare(e,a){await eQ.A.delete("".concat(this.baseUrl,"/dashboards/").concat(e,"/share/").concat(a))}async getComments(e){return(await eQ.A.get("".concat(this.baseUrl,"/dashboards/").concat(e,"/comments"))).data}async addComment(e,a){return(await eQ.A.post("".concat(this.baseUrl,"/dashboards/").concat(e,"/comments"),a)).data}async updateComment(e,a,t){return(await eQ.A.put("".concat(this.baseUrl,"/dashboards/").concat(e,"/comments/").concat(a),{content:t})).data}async deleteComment(e,a){await eQ.A.delete("".concat(this.baseUrl,"/dashboards/").concat(e,"/comments/").concat(a))}async resolveComment(e,a){return(await eQ.A.patch("".concat(this.baseUrl,"/dashboards/").concat(e,"/comments/").concat(a,"/resolve"))).data}async exportDashboard(e,a){return(await eQ.A.post("".concat(this.baseUrl,"/dashboards/").concat(e,"/export"),a,{responseType:"blob"})).data}async importDashboard(e){let a=new FormData;return a.append("file",e),(await eQ.A.post("".concat(this.baseUrl,"/dashboards/import"),a,{headers:{"Content-Type":"multipart/form-data"}})).data}async getDashboardAnalytics(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"30d";return(await eQ.A.get("".concat(this.baseUrl,"/dashboards/").concat(e,"/analytics?period=").concat(a))).data}async getPopularDashboards(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;return(await eQ.A.get("".concat(this.baseUrl,"/dashboards/popular?limit=").concat(e))).data}async getRecentDashboards(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;return(await eQ.A.get("".concat(this.baseUrl,"/dashboards/recent?limit=").concat(e))).data}async trackView(e){await eQ.A.post("".concat(this.baseUrl,"/dashboards/").concat(e,"/view"))}async getSystemConfig(){return(await eQ.A.get("".concat(this.baseUrl,"/config"))).data}async updateSystemConfig(e){return(await eQ.A.put("".concat(this.baseUrl,"/config"),e)).data}async getUserPreferences(){return(await eQ.A.get("".concat(this.baseUrl,"/preferences"))).data}async updateUserPreferences(e){return(await eQ.A.put("".concat(this.baseUrl,"/preferences"),e)).data}async clearCache(e){let a=e?"".concat(this.baseUrl,"/dashboards/").concat(e,"/cache"):"".concat(this.baseUrl,"/cache");await eQ.A.delete(a)}async getCacheStatus(e){return(await eQ.A.get("".concat(this.baseUrl,"/dashboards/").concat(e,"/cache/status"))).data}async subscribeToUpdates(e,a){return()=>{}}generateWidgetId(){return"widget_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9))}generateDashboardId(){return"dashboard_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9))}validateDashboardConfig(e){let a=[];return e.name&&0!==e.name.trim().length||a.push("Nome do dashboard \xe9 obrigat\xf3rio"),e.type||a.push("Tipo do dashboard \xe9 obrigat\xf3rio"),e.category||a.push("Categoria do dashboard \xe9 obrigat\xf3ria"),e.widgets&&e.widgets.forEach((e,t)=>{e.title&&0!==e.title.trim().length||a.push("Widget ".concat(t+1,": T\xedtulo \xe9 obrigat\xf3rio")),e.type||a.push("Widget ".concat(t+1,": Tipo \xe9 obrigat\xf3rio"))}),{isValid:0===a.length,errors:a}}formatDashboardUrl(e){return"/bi/dashboard/".concat(e)}formatShareUrl(e){return"/bi/shared/".concat(e)}constructor(){this.baseUrl="/api/bi"}}let eY=new eZ,eJ={dashboards:["bi","dashboards"],dashboard:e=>["bi","dashboard",e],widgets:e=>["bi","widgets",e],widgetData:e=>["bi","widget-data",e],templates:["bi","templates"]},eX={config:e=>["bi","dashboard-config",e],layout:e=>["bi","dashboard-layout",e],templates:["bi","dashboard-templates"],permissions:e=>["bi","dashboard-permissions",e]},e0={theme:"light",layout:"grid",autoRefresh:{enabled:!0,interval:3e5},performance:{enableVirtualization:!0,maxConcurrentRequests:5,cacheTimeout:3e5},accessibility:{highContrast:!1,reducedMotion:!1,screenReaderOptimized:!1}},e1={id:"default",type:"grid",columns:12,rows:"auto",gap:16,padding:16,responsive:!0,breakpoints:{xs:0,sm:576,md:768,lg:992,xl:1200}},e2=["light","dark","auto","high-contrast","blue","green","purple","custom"],e5={summary:{totalPatients:1247,totalRevenue:285e4,occupancyRate:87.5,satisfaction:4.6},trends:{patients:{value:12,direction:"up"},revenue:{value:8.5,direction:"up"},occupancy:{value:-2.1,direction:"down"},satisfaction:{value:.3,direction:"up"}},alerts:[{id:"1",type:"warning",title:"Taxa de ocupa\xe7\xe3o baixa",message:"UTI com apenas 65% de ocupa\xe7\xe3o",timestamp:new Date,department:"UTI"},{id:"2",type:"critical",title:"Meta de receita n\xe3o atingida",message:"Receita mensal 15% abaixo da meta",timestamp:new Date,department:"Financeiro"}]},e4=[{name:"Jan",pacientes:1200,receita:24e5,ocupacao:85},{name:"Fev",pacientes:1350,receita:265e4,ocupacao:88},{name:"Mar",pacientes:1180,receita:23e5,ocupacao:82},{name:"Abr",pacientes:1420,receita:28e5,ocupacao:91},{name:"Mai",pacientes:1380,receita:275e4,ocupacao:89},{name:"Jun",pacientes:1247,receita:285e4,ocupacao:87}],e3=[{value:"all",label:"Todos os Departamentos"},{value:"emergency",label:"Emerg\xeancia"},{value:"icu",label:"UTI"},{value:"surgery",label:"Cirurgia"},{value:"cardiology",label:"Cardiologia"},{value:"pediatrics",label:"Pediatria"},{value:"oncology",label:"Oncologia"}],e8=[{value:"today",label:"Hoje"},{value:"week",label:"Esta Semana"},{value:"month",label:"Este M\xeas"},{value:"quarter",label:"Este Trimestre"},{value:"year",label:"Este Ano"},{value:"custom",label:"Per\xedodo Personalizado"}];function e6(){let[e,a]=(0,r.useState)({period:"month",department:"all"}),[t,I]=(0,r.useState)("grid"),[F,L]=(0,r.useState)(!1),[_,B]=(0,r.useState)("overview"),[z,U]=(0,r.useState)(!1),[q,O]=(0,r.useState)(!1),{dashboard:V,isLoading:W,widgets:K,selectedWidget:G,filters:$,activeFilters:H,layout:Q,isEditMode:Z,createDashboard:Y,updateDashboard:J,deleteDashboard:X,addWidget:ee,removeWidget:ea,updateWidget:et,selectWidget:es,moveWidget:er,resizeWidget:ei,applyFilter:en,removeFilter:eo,clearFilters:el,toggleEditMode:ed,refreshData:eu}=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{dashboardId:a,autoRefresh:t=!1,refreshInterval:s=3e4,enableRealtime:i=!1}=e,n=(0,eG.jE)(),[o,c]=(0,r.useState)(null),[l,d]=(0,r.useState)({}),[u,m]=(0,r.useState)(!1),[h,g]=(0,r.useState)({}),[p,x]=(0,r.useState)(new Set),{data:y=[],isLoading:v,error:b}=(0,e$.I)({queryKey:eJ.dashboards,queryFn:()=>eY.getDashboards(),staleTime:3e5}),{data:f,isLoading:j,error:w,refetch:N}=(0,e$.I)({queryKey:eJ.dashboard(a||""),queryFn:()=>eY.getDashboard(a),enabled:!!a,refetchInterval:!!t&&s,staleTime:3e5*!t}),{data:A=[],isLoading:C,error:R}=(0,e$.I)({queryKey:eJ.widgets(a||""),queryFn:()=>eY.getDashboardWidgets(a),enabled:!!a,refetchInterval:!!t&&s}),S=b||w||R,k=(0,r.useMemo)(()=>{var e;return(null==f||null==(e=f.settings)?void 0:e.filters)||[]},[f]),E=(0,r.useMemo)(()=>(null==f?void 0:f.layout)||null,[f]),T=(0,eH.n)({mutationFn:eY.createDashboard,onSuccess:e=>{n.invalidateQueries({queryKey:eJ.dashboards}),D.o.success("Dashboard criado com sucesso!")},onError:e=>{D.o.error("Erro ao criar dashboard: "+e.message)}}),M=(0,eH.n)({mutationFn:e=>{let{id:a,data:t}=e;return eY.updateDashboard(a,t)},onSuccess:e=>{n.invalidateQueries({queryKey:eJ.dashboard(e.id)}),n.invalidateQueries({queryKey:eJ.dashboards}),D.o.success("Dashboard atualizado com sucesso!")},onError:e=>{D.o.error("Erro ao atualizar dashboard: "+e.message)}}),P=(0,eH.n)({mutationFn:eY.deleteDashboard,onSuccess:()=>{n.invalidateQueries({queryKey:eJ.dashboards}),D.o.success("Dashboard exclu\xeddo com sucesso!")},onError:e=>{D.o.error("Erro ao excluir dashboard: "+e.message)}}),I=(0,eH.n)({mutationFn:e=>{let{dashboardId:a,config:t}=e;return eY.addWidget(a,t)},onSuccess:()=>{a&&(n.invalidateQueries({queryKey:eJ.widgets(a)}),n.invalidateQueries({queryKey:eJ.dashboard(a)})),D.o.success("Widget adicionado com sucesso!")},onError:e=>{D.o.error("Erro ao adicionar widget: "+e.message)}}),F=(0,eH.n)({mutationFn:e=>{let{id:a,config:t}=e;return eY.updateWidget(a,t)},onSuccess:()=>{a&&(n.invalidateQueries({queryKey:eJ.widgets(a)}),n.invalidateQueries({queryKey:eJ.widgetData((null==o?void 0:o.id)||"")})),D.o.success("Widget atualizado com sucesso!")},onError:e=>{D.o.error("Erro ao atualizar widget: "+e.message)}}),L=(0,eH.n)({mutationFn:eY.removeWidget,onSuccess:()=>{a&&(n.invalidateQueries({queryKey:eJ.widgets(a)}),n.invalidateQueries({queryKey:eJ.dashboard(a)})),c(null),D.o.success("Widget removido com sucesso!")},onError:e=>{D.o.error("Erro ao remover widget: "+e.message)}}),_=(0,eH.n)({mutationFn:e=>{let{dashboardId:a,layout:t}=e;return eY.updateDashboardLayout(a,t)},onSuccess:()=>{a&&n.invalidateQueries({queryKey:eJ.dashboard(a)}),D.o.success("Layout atualizado com sucesso!")},onError:e=>{D.o.error("Erro ao atualizar layout: "+e.message)}}),B=(0,r.useCallback)(async e=>T.mutateAsync(e),[T]),z=(0,r.useCallback)(async(e,a)=>M.mutateAsync({id:e,data:a}),[M]),U=(0,r.useCallback)(async e=>{await P.mutateAsync(e)},[P]),q=(0,r.useCallback)(async(e,a)=>{try{let t=await eY.duplicateDashboard(e,a);return n.invalidateQueries({queryKey:eJ.dashboards}),D.o.success("Dashboard duplicado com sucesso!"),t}catch(e){throw D.o.error("Erro ao duplicar dashboard: "+e.message),e}},[n]),O=(0,r.useCallback)(async e=>{try{await N(),n.invalidateQueries({queryKey:eJ.widgets(e)})}catch(e){throw D.o.error("Erro ao carregar dashboard: "+e.message),e}},[N,n]),V=(0,r.useCallback)(async e=>{if(!a)throw Error("Dashboard ID \xe9 obrigat\xf3rio");return I.mutateAsync({dashboardId:a,config:e})},[a,I]),W=(0,r.useCallback)(async(e,a)=>F.mutateAsync({id:e,config:a}),[F]),K=(0,r.useCallback)(async e=>{await L.mutateAsync(e)},[L]),G=(0,r.useCallback)(async(e,a)=>{let t=A.find(a=>a.id===e);t&&await W(e,{position:{...t.position,...a}})},[A,W]),$=(0,r.useCallback)(async(e,a)=>{let t=A.find(a=>a.id===e);t&&await W(e,{size:{...t.size,...a}})},[A,W]),H=(0,r.useCallback)(async e=>{x(a=>new Set(a).add(e));try{let a=await eY.getWidgetData(e,l);g(t=>({...t,[e]:a})),n.invalidateQueries({queryKey:eJ.widgetData(e)})}catch(e){D.o.error("Erro ao atualizar widget: "+e.message)}finally{x(a=>{let t=new Set(a);return t.delete(e),t})}},[l,n]),Q=(0,r.useCallback)(e=>{c(e)},[]),Z=(0,r.useCallback)(async e=>{if(!a)throw Error("Dashboard ID \xe9 obrigat\xf3rio");await _.mutateAsync({dashboardId:a,layout:e})},[a,_]),Y=(0,r.useCallback)(async()=>{a&&f&&await Z({type:"grid",columns:12,rowHeight:100,margin:[10,10],containerPadding:[10,10],breakpoints:{lg:1200,md:996,sm:768,xs:480,xxs:0},cols:{lg:12,md:10,sm:6,xs:4,xxs:2}})},[a,f,Z]),J=(0,r.useCallback)(async()=>{a&&E&&await Z(E)},[a,E,Z]),X=(0,r.useCallback)((e,a)=>{d(t=>({...t,[e]:a})),A.forEach(e=>{H(e.id)})},[A,H]),ee=(0,r.useCallback)(e=>{d(a=>{let t={...a};return delete t[e],t}),A.forEach(e=>{H(e.id)})},[A,H]),ea=(0,r.useCallback)(()=>{d({}),A.forEach(e=>{H(e.id)})},[A,H]),et=(0,r.useCallback)(async e=>{if(!a||!f)return;let t={...f.settings,filters:e};await z(a,{settings:t})},[a,f,z]),es=(0,r.useCallback)(()=>{m(!0)},[]),er=(0,r.useCallback)(()=>{m(!1),c(null)},[]),ei=(0,r.useCallback)(()=>{m(e=>!e),u&&c(null)},[u]),en=(0,r.useCallback)(async()=>{if(a)try{await N(),await Promise.all(A.map(e=>H(e.id))),D.o.success("Dados atualizados com sucesso!")}catch(e){D.o.error("Erro ao atualizar dados: "+e.message)}},[a,N,A,H]),eo=(0,r.useCallback)(async e=>{if(!a)throw Error("Dashboard ID \xe9 obrigat\xf3rio");try{let t=await eY.exportDashboard(a,e),s=window.URL.createObjectURL(t),r=document.createElement("a");r.href=s,r.download="dashboard-".concat((null==f?void 0:f.name)||"export",".").concat(e),document.body.appendChild(r),r.click(),document.body.removeChild(r),window.URL.revokeObjectURL(s),D.o.success("Dashboard exportado com sucesso!")}catch(e){D.o.error("Erro ao exportar dashboard: "+e.message)}},[a,f]),ec=(0,r.useCallback)(async(e,t)=>{if(!a)throw Error("Dashboard ID \xe9 obrigat\xf3rio");try{let s=await eY.saveAsTemplate(a,{name:e,description:t});return n.invalidateQueries({queryKey:eJ.templates}),D.o.success("Template salvo com sucesso!"),s}catch(e){throw D.o.error("Erro ao salvar template: "+e.message),e}},[a,n]),el=(0,r.useCallback)(async e=>{if(!a)throw Error("Dashboard ID \xe9 obrigat\xf3rio");try{await eY.loadFromTemplate(a,e),await O(a),D.o.success("Template carregado com sucesso!")}catch(e){throw D.o.error("Erro ao carregar template: "+e.message),e}},[a,O]),ed=(0,r.useCallback)(e=>h[e]||null,[h]),eu=(0,r.useCallback)(e=>p.has(e),[p]),em=(0,r.useCallback)(()=>({filters:l,widgets:A.map(e=>({...e,data:ed(e.id)}))}),[l,A,ed]);return(0,r.useEffect)(()=>{if(!t||!a)return;let e=setInterval(()=>{en()},s);return()=>clearInterval(e)},[t,a,s,en]),(0,r.useEffect)(()=>{if(i&&a)return()=>{}},[i,a]),{dashboard:f||null,dashboards:y,isLoading:v||j||C,isError:!!S,error:S,widgets:A,selectedWidget:o,filters:k,activeFilters:l,layout:E,isEditMode:u,createDashboard:B,updateDashboard:z,deleteDashboard:U,duplicateDashboard:q,loadDashboard:O,addWidget:V,updateWidget:W,removeWidget:K,moveWidget:G,resizeWidget:$,refreshWidget:H,selectWidget:Q,updateLayout:Z,resetLayout:Y,saveLayout:J,applyFilter:X,removeFilter:ee,clearFilters:ea,updateFilterConfig:et,enterEditMode:es,exitEditMode:er,toggleEditMode:ei,refreshData:en,exportDashboard:eo,saveAsTemplate:ec,loadFromTemplate:el,getWidgetData:ed,isWidgetLoading:eu,getFilteredData:em}}(),{metrics:em,isLoading:eh,clinicalMetrics:eg,financialMetrics:ep,operationalMetrics:ex,createMetric:ey,updateMetric:ev,deleteMetric:eb,refreshData:ef}=(0,eO.B)(),{kpis:ej,isLoading:ew,clinicalKPIs:eN,financialKPIs:eC,operationalKPIs:eR,staffKPIs:eS,createKPI:ek,updateKPI:eD,deleteKPI:eE,refreshData:eT}=(0,eV.h)(),{config:eM,layout:eI,updateConfig:eF,updateLayout:eL,addWidget:e_,removeWidget:eB}=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{dashboardId:a,autoSave:t=!0,autoSaveDelay:s=2e3,enableDragDrop:i=!0,enableResize:n=!0,enableFilters:o=!0,enableExport:c=!0,enableSharing:l=!0,defaultLayout:d="grid",defaultTheme:u="light",maxWidgets:m=20,gridSize:h=8,snapToGrid:g=!0}=e,p=(0,eG.jE)(),[x,y]=(0,r.useState)(null),[v,b]=(0,r.useState)(null),[f,j]=(0,r.useState)([]),[w,N]=(0,r.useState)([]),[A,C]=(0,r.useState)(null),[R,S]=(0,r.useState)(null),[k,E]=(0,r.useState)(null),[T,M]=(0,r.useState)(!1),[P,I]=(0,r.useState)(!1),[F,L]=(0,r.useState)(!0),[_,B]=(0,r.useState)(g),[z,U]=(0,r.useState)(u),[q,O]=(0,r.useState)({}),[V,W]=(0,r.useState)(null),{data:K,isLoading:G,error:$,refetch:H}=(0,e$.I)({queryKey:eX.config(a),queryFn:()=>a?eY.getDashboardSettings(a):Promise.resolve(e0),enabled:!!a,staleTime:3e5}),{data:Q,isLoading:Z,refetch:Y}=(0,e$.I)({queryKey:eX.layout(a),queryFn:()=>a?eY.getDashboardLayout(a):Promise.resolve(e1),enabled:!!a,staleTime:3e5}),{data:J=[],isLoading:X}=(0,e$.I)({queryKey:eX.templates,queryFn:()=>eY.getDashboardTemplates(),staleTime:6e5}),{data:ee,isLoading:ea}=(0,e$.I)({queryKey:eX.permissions(a),queryFn:()=>a?eY.getDashboardPermissions(a):Promise.resolve(null),enabled:!!a&&l,staleTime:3e5}),et=(0,eH.n)({mutationFn:e=>{let{dashboardId:a,config:t}=e;return eY.updateDashboardSettings(a,t)},onSuccess:()=>{p.invalidateQueries({queryKey:eX.config(a)}),I(!1),D.o.success("Configura\xe7\xf5es salvas com sucesso!")},onError:e=>{D.o.error("Erro ao salvar configura\xe7\xf5es: "+e.message)}}),es=(0,eH.n)({mutationFn:e=>{let{dashboardId:a,layout:t}=e;return eY.updateDashboardLayout(a,t)},onSuccess:()=>{p.invalidateQueries({queryKey:eX.layout(a)}),I(!1),D.o.success("Layout salvo com sucesso!")},onError:e=>{D.o.error("Erro ao salvar layout: "+e.message)}});(0,r.useEffect)(()=>{if(!t||!P||!a)return;V&&clearTimeout(V);let e=setTimeout(()=>{en()},s);return W(e),()=>{e&&clearTimeout(e)}},[P,t,s,a]),(0,r.useEffect)(()=>{K&&(y(K),K.theme&&U(K.theme))},[K]),(0,r.useEffect)(()=>{Q&&(b(Q),Q.widgets&&j(Q.widgets))},[Q]);let er=(0,r.useCallback)(async e=>{if(!a){y(a=>({...a,...e})),I(!0);return}try{await et.mutateAsync({dashboardId:a,config:e}),y(a=>({...a,...e}))}catch(e){}},[a,et]),ei=(0,r.useCallback)(async()=>{y(e0),I(!0),D.o.success("Configura\xe7\xf5es resetadas!")},[]),en=(0,r.useCallback)(async()=>{if(a&&x)try{await et.mutateAsync({dashboardId:a,config:x})}catch(e){}},[a,x,et]),eo=(0,r.useCallback)(async e=>{try{let a=await eY.getDashboardSettings(e);y(a),p.setQueryData(eX.config(e),a),D.o.success("Configura\xe7\xf5es carregadas!")}catch(e){D.o.error("Erro ao carregar configura\xe7\xf5es: "+e.message)}},[p]),ec=(0,r.useCallback)(e=>{b(a=>({...a,...e})),I(!0)},[]),el=(0,r.useCallback)(()=>{b(e1),j([]),I(!0),D.o.success("Layout resetado!")},[]),ed=(0,r.useCallback)(async()=>{if(a&&v)try{let e={...v,widgets:f};await es.mutateAsync({dashboardId:a,layout:e})}catch(e){}},[a,v,f,es]),eu=(0,r.useCallback)(async e=>{try{let a=await eY.getDashboardLayout(e);b(a),a.widgets&&j(a.widgets),p.setQueryData(eX.layout(e),a),D.o.success("Layout carregado!")}catch(e){D.o.error("Erro ao carregar layout: "+e.message)}},[p]),em=(0,r.useCallback)(e=>{if(f.length>=m)return void D.o.error("M\xe1ximo de ".concat(m," widgets permitidos"));let a={id:"widget-".concat(Date.now()),type:"metric",title:"Novo Widget",position:{x:0,y:0,z:0},size:{width:4,height:3},config:{},dataSource:{type:"api",config:{}},visualization:{type:"card",config:{}},isVisible:!0,isResizable:n,isDraggable:i,...e};j(e=>[...e,a]),I(!0),D.o.success("Widget adicionado!")},[f.length,m,n,i]),eh=(0,r.useCallback)((e,a)=>{j(t=>t.map(t=>t.id===e?{...t,...a}:t)),I(!0)},[]),eg=(0,r.useCallback)(e=>{j(a=>a.filter(a=>a.id!==e)),(null==A?void 0:A.id)===e&&C(null),I(!0),D.o.success("Widget removido!")},[A]),ep=(0,r.useCallback)(e=>{let a=f.find(a=>a.id===e);if(!a)return;let t={...a,id:"widget-".concat(Date.now()),title:"".concat(a.title," (C\xf3pia)"),position:{...a.position,x:a.position.x+1,y:a.position.y+1}};j(e=>[...e,t]),I(!0),D.o.success("Widget duplicado!")},[f]),ex=(0,r.useCallback)((e,a)=>{eh(e,{position:a})},[eh]),ey=(0,r.useCallback)((e,a)=>{eh(e,{size:a})},[eh]),ev=(0,r.useCallback)(e=>{C(e)},[]),eb=(0,r.useCallback)((e,a)=>{var t;eh(e,{config:{...null==(t=f.find(a=>a.id===e))?void 0:t.config,...a}})},[eh,f]),ef=(0,r.useCallback)((e,a)=>{let t=f.find(a=>a.id===e);t&&eh(e,{dataSource:{...t.dataSource,config:{...t.dataSource.config,...a}}})},[eh,f]),ej=(0,r.useCallback)(async e=>{try{await eY.refreshWidget(e),D.o.success("Widget atualizado!")}catch(e){D.o.error("Erro ao atualizar widget: "+e.message)}},[]),ew=(0,r.useCallback)(async()=>{try{await Promise.all(f.map(e=>eY.refreshWidget(e.id))),D.o.success("Todos os widgets foram atualizados!")}catch(e){D.o.error("Erro ao atualizar widgets: "+e.message)}},[f]),eN=(0,r.useCallback)(e=>{let a={id:"filter-".concat(Date.now()),name:"Novo Filtro",type:"select",options:[],isRequired:!1,isVisible:!0,...e};N(e=>[...e,a]),I(!0),D.o.success("Filtro adicionado!")},[]),eA=(0,r.useCallback)((e,a)=>{N(t=>t.map(t=>t.id===e?{...t,...a}:t)),I(!0)},[]),eC=(0,r.useCallback)(e=>{N(a=>a.filter(a=>a.id!==e)),I(!0),D.o.success("Filtro removido!")},[]),eR=(0,r.useCallback)(e=>{f.forEach(a=>{eY.applyFiltersToWidget(a.id,e)}),D.o.success("Filtros aplicados!")},[f]),eS=(0,r.useCallback)(()=>{f.forEach(e=>{eY.clearWidgetFilters(e.id)}),D.o.success("Filtros limpos!")},[f]),ek=(0,r.useCallback)(e=>{U(e),er({theme:e})},[er]),eD=(0,r.useCallback)(e=>{O(e),er({customColors:e})},[er]),eE=(0,r.useCallback)(()=>{ek(u),O({})},[ek,u]),eT=(0,r.useCallback)(async function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(!v||!x)throw Error("Nenhuma configura\xe7\xe3o para salvar");try{let t=await eY.createDashboardTemplate({name:e,description:a,layout:v,settings:x,widgets:f,filters:w,category:"custom",difficulty:"intermediate",tags:[]});return p.invalidateQueries({queryKey:eX.templates}),D.o.success("Template salvo com sucesso!"),t}catch(e){throw D.o.error("Erro ao salvar template: "+e.message),e}},[v,x,f,w,p]),eM=(0,r.useCallback)(async e=>{try{let a=await eY.getDashboardTemplate(e);a.layout&&b(a.layout),a.settings&&y(a.settings),a.widgets&&j(a.widgets),a.filters&&N(a.filters),I(!0),D.o.success("Template carregado com sucesso!")}catch(e){D.o.error("Erro ao carregar template: "+e.message)}},[]),eP=(0,r.useCallback)(async e=>{try{await eY.deleteDashboardTemplate(e),p.invalidateQueries({queryKey:eX.templates}),D.o.success("Template exclu\xeddo com sucesso!")}catch(e){D.o.error("Erro ao excluir template: "+e.message)}},[p]),eI=(0,r.useCallback)(async e=>{if(a)try{await eY.updateDashboardPermissions(a,e),p.invalidateQueries({queryKey:eX.permissions(a)}),D.o.success("Permiss\xf5es atualizadas!")}catch(e){D.o.error("Erro ao atualizar permiss\xf5es: "+e.message)}},[a,p]),eF=(0,r.useCallback)(async(e,t)=>{if(a)try{await eY.shareDashboard(a,e,t),p.invalidateQueries({queryKey:eX.permissions(a)}),D.o.success("Dashboard compartilhado com sucesso!")}catch(e){D.o.error("Erro ao compartilhar dashboard: "+e.message)}},[a,p]),eL=(0,r.useCallback)(()=>{M(!0)},[]),e_=(0,r.useCallback)(()=>{M(!1),C(null),S(null),E(null)},[]),eB=(0,r.useCallback)(()=>{M(e=>!e),T&&e_()},[T,e_]),ez=(0,r.useCallback)(()=>{L(e=>!e)},[]),eU=(0,r.useCallback)(()=>{B(e=>!e)},[]),eq=(0,r.useCallback)(e=>{ec({gap:e})},[ec]),eO=(0,r.useCallback)(async e=>{if(!x||!v)return void D.o.error("Nenhuma configura\xe7\xe3o para exportar");try{let a={config:x,layout:v,widgets:f,filters:w,theme:z,customColors:q,exportedAt:new Date().toISOString()},t=await eY.exportDashboardConfig(a,e),s=window.URL.createObjectURL(t),r=document.createElement("a");r.href=s,r.download="dashboard-config.".concat(e),document.body.appendChild(r),r.click(),document.body.removeChild(r),window.URL.revokeObjectURL(s),D.o.success("Configura\xe7\xe3o exportada com sucesso!")}catch(e){D.o.error("Erro ao exportar configura\xe7\xe3o: "+e.message)}},[x,v,f,w,z,q]),eV=(0,r.useCallback)(async e=>{try{let a=await eY.importDashboardConfig(e);a.config&&y(a.config),a.layout&&b(a.layout),a.widgets&&j(a.widgets),a.filters&&N(a.filters),a.theme&&U(a.theme),a.customColors&&O(a.customColors),I(!0),D.o.success("Configura\xe7\xe3o importada com sucesso!")}catch(e){D.o.error("Erro ao importar configura\xe7\xe3o: "+e.message)}},[]),eW=(0,r.useCallback)(()=>!!x&&!!v&&!!v.type&&!!v.columns&&0!==f.length&&f.every(eK),[x,v,f]),eK=(0,r.useCallback)(e=>!!e.id&&!!e.type&&!!e.title&&!!e.position&&!!e.size&&!!e.dataSource&&!!e.visualization&&!0,[]),eQ=(0,r.useCallback)(e=>f.find(a=>a.id===e),[f]),eZ=(0,r.useCallback)(()=>{if(!v)return[];let e=[],a=f.map(e=>e.position);for(let t=0;t<v.columns;t++)for(let s=0;s<10;s++){let r={x:t,y:s,z:0};a.some(e=>e.x===t&&e.y===s)||e.push(r)}return e},[v,f]),eJ=(0,r.useCallback)(()=>{if(!v)return e1;let e=[...f].sort((e,a)=>{let t=e.size.width*e.size.height;return a.size.width*a.size.height-t}),a=0,t=0,s=v.columns;return e.forEach(e=>{a+e.size.width>s&&(a=0,t+=1),e.position={x:a,y:t,z:0},a+=e.size.width}),{...v,widgets:e}},[v,f]),e5=(0,r.useCallback)(e=>{D.o.success("Visualizando layout...")},[]);return(0,r.useEffect)(()=>()=>{V&&clearTimeout(V)},[V]),{config:x,layout:v,widgets:f,filters:w,permissions:ee,templates:J,isLoading:G||Z||X||ea,isError:!!$,error:$,isDirty:P,isEditMode:T,selectedWidget:A,draggedWidget:R,resizingWidget:k,gridEnabled:F,snapEnabled:_,theme:z,availableThemes:e2,customColors:q,updateConfig:er,resetConfig:ei,saveConfig:en,loadConfig:eo,updateLayout:ec,resetLayout:el,saveLayout:ed,loadLayout:eu,addWidget:em,updateWidget:eh,removeWidget:eg,duplicateWidget:ep,moveWidget:ex,resizeWidget:ey,selectWidget:ev,configureWidget:eb,updateWidgetData:ef,refreshWidget:ej,refreshAllWidgets:ew,addFilter:eN,updateFilter:eA,removeFilter:eC,applyFilters:eR,clearFilters:eS,setTheme:ek,updateCustomColors:eD,resetTheme:eE,saveAsTemplate:eT,loadFromTemplate:eM,deleteTemplate:eP,updatePermissions:eI,shareConfig:eF,enterEditMode:eL,exitEditMode:e_,toggleEditMode:eB,toggleGrid:ez,toggleSnap:eU,setGridSize:eq,exportConfig:eO,importConfig:eV,validateConfig:eW,validateWidget:eK,getWidgetById:eQ,getAvailablePositions:eZ,calculateOptimalLayout:eJ,previewLayout:e5}}(),{exportData:ez,isExporting:eU}=eW(),eq=async(e,a)=>{try{await ez({type:"metrics",data:em,format:e,...a}),D.o.success("M\xe9tricas exportadas com sucesso!")}catch(e){D.o.error("Erro ao exportar m\xe9tricas")}},eQ=async(e,a)=>{try{await ez({type:"kpis",data:ej,format:e,...a}),D.o.success("KPIs exportados com sucesso!")}catch(e){D.o.error("Erro ao exportar KPIs")}},eZ=async(e,a)=>{try{await ez({type:"alerts",data:e5.alerts,format:e,...a}),D.o.success("Alertas exportados com sucesso!")}catch(e){D.o.error("Erro ao exportar alertas")}},e6=async(e,a)=>{try{await ez({type:"dashboard",data:{metrics:em,kpis:ej,alerts:e5.alerts},format:e,...a}),D.o.success("Dashboard exportado com sucesso!")}catch(e){D.o.error("Erro ao exportar dashboard")}},e9=[{id:"add-widget",label:"Adicionar Widget",icon:h.A,action:()=>ae()},{id:"export-dashboard",label:"Exportar Dashboard",icon:g.A,action:()=>O(!0)},{id:"refresh-data",label:"Atualizar Dados",icon:p.A,action:()=>aa()},{id:"toggle-edit",label:F?"Sair da Edi\xe7\xe3o":"Editar Dashboard",icon:F?x.A:y.A,action:()=>L(!F),variant:F?"outline":"default"}],e7=(e,t)=>{a(a=>({...a,[e]:t}))},ae=()=>{D.o.success("Widget adicionado com sucesso!")},aa=async()=>{U(!0);try{await (null==eu?void 0:eu()),D.o.success("Dados atualizados com sucesso!")}catch(e){D.o.error("Erro ao atualizar dados")}finally{U(!1)}},at=(0,r.useMemo)(()=>[{id:"patients",name:"Total de Pacientes",value:e5.summary.totalPatients,trend:e5.trends.patients,icon:v.A,color:"blue",format:"integer"},{id:"revenue",name:"Receita Total",value:e5.summary.totalRevenue,trend:e5.trends.revenue,icon:b.A,color:"green",format:"currency"},{id:"occupancy",name:"Taxa de Ocupa\xe7\xe3o",value:e5.summary.occupancyRate,trend:e5.trends.occupancy,icon:f.A,color:"orange",format:"percentage"},{id:"satisfaction",name:"Satisfa\xe7\xe3o do Paciente",value:e5.summary.satisfaction,trend:e5.trends.satisfaction,icon:j.A,color:"pink",format:"decimal"}],[]);return(0,s.jsxs)("div",{className:"container mx-auto p-6 space-y-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:"Dashboard de BI"}),(0,s.jsx)("p",{className:"text-muted-foreground",children:"An\xe1lise completa de dados e m\xe9tricas hospitalares"})]}),(0,s.jsx)("div",{className:"flex items-center space-x-2",children:e9.map(e=>{let a=e.icon;return(0,s.jsxs)(o.$,{variant:e.variant||"outline",size:"sm",onClick:e.action,disabled:"refresh-data"===e.id&&z,children:[(0,s.jsx)(a,{className:(0,i.cn)("h-4 w-4","refresh-data"===e.id&&z&&"animate-spin")}),(0,s.jsx)("span",{className:"ml-2 hidden sm:inline",children:e.label})]},e.id)})})]}),(0,s.jsx)(n.Zp,{children:(0,s.jsx)(n.Wu,{className:"pt-6",children:(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(u.Label,{htmlFor:"period",children:"Per\xedodo:"}),(0,s.jsxs)(d.l6,{value:e.period,onValueChange:e=>e7("period",e),children:[(0,s.jsx)(d.bq,{className:"w-40",children:(0,s.jsx)(d.yv,{})}),(0,s.jsx)(d.gC,{children:e8.map(e=>(0,s.jsx)(d.eb,{value:e.value,children:e.label},e.value))})]})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(u.Label,{htmlFor:"department",children:"Departamento:"}),(0,s.jsxs)(d.l6,{value:e.department,onValueChange:e=>e7("department",e),children:[(0,s.jsx)(d.bq,{className:"w-48",children:(0,s.jsx)(d.yv,{})}),(0,s.jsx)(d.gC,{children:e3.map(e=>(0,s.jsx)(d.eb,{value:e.value,children:e.label},e.value))})]})]}),(0,s.jsx)(m.Separator,{orientation:"vertical",className:"h-6"}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(o.$,{variant:"grid"===t?"default":"outline",size:"sm",onClick:()=>I("grid"),children:(0,s.jsx)(N.A,{className:"h-4 w-4"})}),(0,s.jsx)(o.$,{variant:"list"===t?"default":"outline",size:"sm",onClick:()=>I("list"),children:(0,s.jsx)(A.A,{className:"h-4 w-4"})})]})]})})}),(0,s.jsxs)(l.Tabs,{value:_,onValueChange:B,children:[(0,s.jsxs)(l.TabsList,{className:"grid w-full grid-cols-6",children:[(0,s.jsx)(l.TabsTrigger,{value:"overview",children:"Vis\xe3o Geral"}),(0,s.jsx)(l.TabsTrigger,{value:"metrics",children:"M\xe9tricas"}),(0,s.jsx)(l.TabsTrigger,{value:"kpis",children:"KPIs"}),(0,s.jsx)(l.TabsTrigger,{value:"analytics",children:"Analytics"}),(0,s.jsx)(l.TabsTrigger,{value:"alerts",children:"Alertas"}),(0,s.jsx)(l.TabsTrigger,{value:"settings",children:"Configura\xe7\xf5es"})]}),(0,s.jsxs)(l.TabsContent,{value:"overview",className:"space-y-6",children:[(0,s.jsx)("div",{className:(0,i.cn)("grid gap-6","grid"===t?"grid-cols-1 md:grid-cols-2 lg:grid-cols-4":"grid-cols-1"),children:at.map(e=>(e.icon,(0,s.jsx)(M.f,{metric:{id:e.id,name:e.name,description:"M\xe9trica de ".concat(e.name.toLowerCase()),category:"operational",type:E.COUNT,format:e.format,unit:"currency"===e.format?T.BRL:"percentage"===e.format?T.PERCENTAGE:void 0,target:"percentage"===e.format?90:void 0,thresholds:{excellent:"percentage"===e.format?95:void 0,good:"percentage"===e.format?85:void 0,warning:"percentage"===e.format?75:void 0,critical:"percentage"===e.format?65:void 0},createdAt:new Date,updatedAt:new Date},value:{value:e.value,previous:.95*e.value,trend:{direction:e.trend.direction,value:e.trend.value,period:"m\xeas anterior"},status:"good",lastUpdated:new Date},showTrend:!0,showProgress:"percentage"===e.format,animated:!0},e.id)))}),(0,s.jsxs)("div",{className:"grid gap-6 md:grid-cols-2",children:[(0,s.jsx)(P.C,{data:e4,config:{showGrid:!0,showLegend:!0,animation:!0,responsive:!0},type:"line",title:"Tend\xeancia de Pacientes",description:"Evolu\xe7\xe3o mensal do n\xfamero de pacientes",series:[{id:"pacientes",name:"Pacientes",dataKey:"pacientes",type:"line",color:"#3b82f6",visible:!0}],xAxis:{dataKey:"name",label:"M\xeas"},yAxis:{label:"N\xfamero de Pacientes"},height:300}),(0,s.jsx)(P.C,{data:e4,config:{showGrid:!0,showLegend:!0,animation:!0,responsive:!0},type:"bar",title:"Receita Mensal",description:"Receita gerada por m\xeas",series:[{id:"receita",name:"Receita",dataKey:"receita",type:"bar",color:"#10b981",visible:!0}],xAxis:{dataKey:"name",label:"M\xeas"},yAxis:{label:"Receita (R$)",format:"currency"},height:300})]}),(0,s.jsxs)("div",{className:"grid gap-6 md:grid-cols-3",children:[(0,s.jsx)("div",{className:"md:col-span-2",children:(0,s.jsxs)(n.Zp,{children:[(0,s.jsx)(n.aR,{children:(0,s.jsxs)(n.ZB,{className:"flex items-center space-x-2",children:[(0,s.jsx)(w.A,{className:"h-5 w-5 text-yellow-500"}),(0,s.jsx)("span",{children:"Alertas Ativos"}),(0,s.jsx)(c.E,{variant:"secondary",children:e5.alerts.length})]})}),(0,s.jsx)(n.Wu,{children:(0,s.jsx)("div",{className:"space-y-4",children:e5.alerts.map(e=>(0,s.jsxs)("div",{className:(0,i.cn)("flex items-start space-x-3 p-3 rounded-lg border","critical"===e.type?"border-red-200 bg-red-50":"border-yellow-200 bg-yellow-50"),children:["critical"===e.type?(0,s.jsx)(w.A,{className:"h-5 w-5 text-red-500 mt-0.5"}):(0,s.jsx)(w.A,{className:"h-5 w-5 text-yellow-500 mt-0.5"}),(0,s.jsxs)("div",{className:"flex-1 space-y-1",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("h4",{className:"font-medium text-sm",children:e.title}),(0,s.jsx)(c.E,{variant:"outline",className:"text-xs",children:e.department})]}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:e.message}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:e.timestamp.toLocaleString("pt-BR")})]})]},e.id))})})]})}),(0,s.jsx)("div",{children:(0,s.jsx)(P.C,{data:[{name:"Ocupado",value:e5.summary.occupancyRate},{name:"Dispon\xedvel",value:100-e5.summary.occupancyRate}],config:{showGrid:!1,showLegend:!0,animation:!0,responsive:!0},type:"pie",title:"Taxa de Ocupa\xe7\xe3o",description:"Distribui\xe7\xe3o atual dos leitos",series:[{id:"ocupacao",name:"Ocupa\xe7\xe3o",dataKey:"value",type:"pie",visible:!0}],height:300})})]})]}),(0,s.jsx)(l.TabsContent,{value:"metrics",className:"space-y-6",children:(0,s.jsxs)("div",{className:"text-center py-12",children:[(0,s.jsx)(C.A,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),(0,s.jsx)("h3",{className:"text-lg font-semibold text-muted-foreground mb-2",children:"M\xe9tricas Detalhadas"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground mb-4",children:"Visualiza\xe7\xe3o detalhada de todas as m\xe9tricas do sistema"}),(0,s.jsx)(o.$,{onClick:()=>B("overview"),children:"Voltar \xe0 Vis\xe3o Geral"})]})}),(0,s.jsx)(l.TabsContent,{value:"kpis",className:"space-y-6",children:(0,s.jsxs)("div",{className:"text-center py-12",children:[(0,s.jsx)(R.A,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),(0,s.jsx)("h3",{className:"text-lg font-semibold text-muted-foreground mb-2",children:"Indicadores de Performance"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground mb-4",children:"KPIs estrat\xe9gicos para tomada de decis\xe3o"}),(0,s.jsx)(o.$,{onClick:()=>B("overview"),children:"Voltar \xe0 Vis\xe3o Geral"})]})}),(0,s.jsx)(l.TabsContent,{value:"analytics",className:"space-y-6",children:(0,s.jsxs)("div",{className:"text-center py-12",children:[(0,s.jsx)(S.A,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),(0,s.jsx)("h3",{className:"text-lg font-semibold text-muted-foreground mb-2",children:"Analytics Avan\xe7ado"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground mb-4",children:"An\xe1lises preditivas e insights avan\xe7ados"}),(0,s.jsx)(o.$,{onClick:()=>B("overview"),children:"Voltar \xe0 Vis\xe3o Geral"})]})}),(0,s.jsx)(l.TabsContent,{value:"alerts",className:"space-y-6",children:(0,s.jsxs)("div",{className:"grid gap-6 lg:grid-cols-3",children:[(0,s.jsx)("div",{className:"lg:col-span-2",children:(0,s.jsx)(ec,{})}),(0,s.jsx)("div",{children:(0,s.jsx)(eA,{})})]})}),(0,s.jsx)(l.TabsContent,{value:"settings",className:"space-y-6",children:(0,s.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Configura\xe7\xf5es do Sistema BI"}),(0,s.jsx)("p",{className:"text-gray-600",children:"Configure alertas, notifica\xe7\xf5es e prefer\xeancias do dashboard."})]}),(0,s.jsxs)("div",{className:"grid gap-6 lg:grid-cols-2",children:[(0,s.jsx)(eP,{}),(0,s.jsxs)(n.Zp,{children:[(0,s.jsx)(n.aR,{children:(0,s.jsxs)(n.ZB,{className:"flex items-center gap-2",children:[(0,s.jsx)(k.A,{className:"h-5 w-5"}),"Configura\xe7\xf5es Gerais"]})}),(0,s.jsx)(n.Wu,{className:"space-y-4",children:(0,s.jsxs)("div",{className:"text-center py-8",children:[(0,s.jsx)(y.A,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Configura\xe7\xf5es adicionais em desenvolvimento"})]})})]})]})]})})]}),(0,s.jsx)(eK,{open:q,onOpenChange:O,onExport:async(e,a,t)=>{try{switch(e){case"metrics":await eq(a,t);break;case"kpis":await eQ(a,t);break;case"alerts":await eZ(a,t);break;case"dashboard":await e6(a,t)}D.o.success("".concat(e," exportado com sucesso!")),O(!1)}catch(a){D.o.error("Erro ao exportar ".concat(e))}},isExporting:eU})]})}function e9(){return(0,s.jsx)(ek,{children:(0,s.jsx)(e6,{})})}},29133:(e,a,t)=>{Promise.resolve().then(t.bind(t,28168))},32383:()=>{},47761:(e,a,t)=>{"use strict";t.d(a,{f:()=>T});var s=t(95155);t(12115);var r=t(53999),i=t(88482),n=t(88145),o=t(24944),c=t(27737),l=t(79397),d=t(40646),u=t(16785),m=t(1243),h=t(55868),g=t(33109),p=t(72713),x=t(84355),y=t(46697),v=t(17580),b=t(68500),f=t(87712),j=t(54861),w=t(81284),N=t(69074);function A(e,a){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;if("string"==typeof e)return e;switch(a){case"currency":return new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(e);case"percentage":return"".concat((100*e).toFixed(t),"%");case"decimal":return e.toFixed(t);case"integer":return Math.round(e).toString();default:return e.toLocaleString("pt-BR")}}function C(e){switch(e){case"excellent":return"text-green-600 bg-green-50 border-green-200";case"good":return"text-blue-600 bg-blue-50 border-blue-200";case"warning":return"text-yellow-600 bg-yellow-50 border-yellow-200";case"critical":return"text-red-600 bg-red-50 border-red-200";default:return"text-gray-600 bg-gray-50 border-gray-200"}}function R(e){let{value:a,format:t,unit:i,precision:n=2,showUnit:o=!0,size:c="md",className:l}=e,d=A(a,t,n);return(0,s.jsxs)("div",{className:(0,r.cn)("flex items-baseline space-x-1",l),children:[(0,s.jsx)("span",{className:{sm:"text-lg font-semibold",md:"text-2xl font-bold",lg:"text-3xl font-bold"}[c],children:d}),o&&i&&(0,s.jsx)("span",{className:"text-sm text-muted-foreground",children:i})]})}function S(e){let{trend:a,showPercentage:t=!0,showIcon:i=!0,size:n="md",className:o}=e,{direction:c,value:l,period:d}=a,u="up"===c?g.A:"down"===c?b.A:f.A,m=function(e){switch(e){case"up":return"text-green-600";case"down":return"text-red-600";default:return"text-gray-600"}}(c);return(0,s.jsxs)("div",{className:(0,r.cn)("flex items-center space-x-1",m,"sm"===n?"text-xs":"text-sm",o),children:[i&&(0,s.jsx)(u,{className:"sm"===n?"h-3 w-3":"h-4 w-4"}),(0,s.jsx)("span",{children:t&&"number"==typeof l?"".concat(Math.abs(l).toFixed(1),"%"):l}),d&&(0,s.jsxs)("span",{className:"text-muted-foreground",children:["vs ",d]})]})}function k(e){let{current:a,target:t,showPercentage:i=!0,showLabels:n=!0,variant:c="default",className:l}=e,d=Math.min(a/t*100,100);return(0,s.jsxs)("div",{className:(0,r.cn)("space-y-2",l),children:[n&&(0,s.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,s.jsx)("span",{children:"Progresso"}),i&&(0,s.jsxs)("span",{className:{default:"",success:"text-green-600",warning:"text-yellow-600",destructive:"text-red-600"}[c],children:[d.toFixed(1),"%"]})]}),(0,s.jsx)(o.k,{value:d,className:"h-2"}),n&&(0,s.jsxs)("div",{className:"flex justify-between text-xs text-muted-foreground",children:[(0,s.jsx)("span",{children:A(a)}),(0,s.jsxs)("span",{children:["Meta: ",A(t)]})]})]})}function D(e){let{current:a,previous:t,period:i="per\xedodo anterior",showPercentage:n=!0,className:o}=e,c=a-t,l=c>0,d=c<0;return(0,s.jsx)("div",{className:(0,r.cn)("text-sm space-y-1",o),children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("span",{className:"text-muted-foreground",children:["vs ",i]}),(0,s.jsxs)("div",{className:(0,r.cn)("flex items-center space-x-1",l?"text-green-600":d?"text-red-600":"text-gray-600"),children:[l?(0,s.jsx)(g.A,{className:"h-3 w-3"}):d?(0,s.jsx)(b.A,{className:"h-3 w-3"}):(0,s.jsx)(f.A,{className:"h-3 w-3"}),(0,s.jsx)("span",{children:n?"".concat(Math.abs(0!==t?c/t*100:0).toFixed(1),"%"):A(Math.abs(c))})]})]})})}function E(e){let{status:a,showLabel:t=!0,size:i="md",className:o}=e,c={excellent:{label:"Excelente",icon:d.A},good:{label:"Bom",icon:d.A},warning:{label:"Aten\xe7\xe3o",icon:m.A},critical:{label:"Cr\xedtico",icon:j.A},unknown:{label:"Desconhecido",icon:w.A}},l=c[a]||c.unknown,u=l.icon,h=C(a);return(0,s.jsxs)(n.E,{variant:"outline",className:(0,r.cn)(h,"sm"===i?"text-xs px-2 py-1":"text-sm px-3 py-1",o),children:[(0,s.jsx)(u,{className:(0,r.cn)("sm"===i?"h-3 w-3":"h-4 w-4","mr-1")}),t&&l.label]})}function T(e){var a;let{metric:t,value:o,showTrend:b=!0,showProgress:f=!1,showComparison:j=!1,showTarget:w=!1,showStatus:T=!0,showIcon:M=!0,size:P="md",variant:I="default",theme:F="light",className:L,loading:_=!1,error:B=null,onClick:z}=e,U=M?function(e,a){let t={clinical:{occupancy:l.A,satisfaction:d.A,efficiency:u.A,quality:d.A,safety:m.A,default:l.A},financial:{revenue:h.A,cost:h.A,profit:g.A,budget:u.A,default:h.A},operational:{productivity:p.A,utilization:x.A,performance:y.A,efficiency:u.A,default:p.A},patient:{satisfaction:d.A,volume:v.A,retention:g.A,default:v.A},staff:{productivity:p.A,satisfaction:d.A,utilization:v.A,default:v.A}},s=t[e]||t.operational;return s[a]||s.default}(t.category,t.type):null,q={sm:"p-4",md:"p-6",lg:"p-8"},O={light:"",dark:"bg-gray-900 text-white",colored:C((null==o?void 0:o.status)||"unknown")};return _?(0,s.jsxs)(i.Zp,{className:(0,r.cn)(q[P],L),children:[(0,s.jsxs)(i.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,s.jsx)(c.E,{className:"h-4 w-24"}),(0,s.jsx)(c.E,{className:"h-4 w-4 rounded"})]}),(0,s.jsx)(i.Wu,{children:(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsx)(c.E,{className:"h-8 w-20"}),(0,s.jsx)(c.E,{className:"h-4 w-32"}),f&&(0,s.jsx)(c.E,{className:"h-2 w-full"})]})})]}):B?(0,s.jsx)(i.Zp,{className:(0,r.cn)(q[P],"border-destructive",L),children:(0,s.jsx)(i.Wu,{className:"flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center space-y-2",children:[(0,s.jsx)(m.A,{className:"h-8 w-8 text-destructive mx-auto"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Erro ao carregar m\xe9trica"}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:B})]})})}):(0,s.jsxs)(i.Zp,{className:(0,r.cn)(q[P],O[F],{"cursor-pointer hover:shadow-md transition-shadow":z,"border-l-4":"detailed"===I&&(null==o?void 0:o.status)},L),onClick:()=>{z&&z(t)},children:[(0,s.jsxs)(i.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)(i.ZB,{className:(0,r.cn)("font-medium","sm"===P?"text-sm":"lg"===P?"text-lg":"text-base"),children:t.name}),t.description&&"detailed"===I&&(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:t.description})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[T&&(null==o?void 0:o.status)&&(0,s.jsx)(E,{status:o.status,showLabel:"detailed"===I,size:"lg"===P?"md":"sm"}),U&&(0,s.jsx)(U,{className:(0,r.cn)("text-muted-foreground","sm"===P?"h-4 w-4":"lg"===P?"h-6 w-6":"h-5 w-5")})]})]}),(0,s.jsx)(i.Wu,{children:(0,s.jsxs)("div",{className:"space-y-3",children:[o&&(0,s.jsx)(R,{value:o.current,format:t.format,unit:t.unit,precision:t.precision,size:P}),b&&(null==o?void 0:o.trend)&&(0,s.jsx)(S,{trend:o.trend,size:"lg"===P?"md":"sm"}),f&&w&&o&&t.target&&(0,s.jsx)(k,{current:"number"==typeof o.current?o.current:0,target:t.target,variant:"excellent"===o.status?"success":"warning"===o.status?"warning":"critical"===o.status?"destructive":"default"}),j&&(null==o?void 0:o.previous)!==void 0&&(0,s.jsx)(D,{current:"number"==typeof o.current?o.current:0,previous:o.previous,period:null==(a=o.trend)?void 0:a.period}),"detailed"===I&&(0,s.jsxs)("div",{className:"pt-2 border-t space-y-2",children:[t.category&&(0,s.jsxs)("div",{className:"flex items-center space-x-2 text-xs text-muted-foreground",children:[(0,s.jsx)("span",{children:"Categoria:"}),(0,s.jsx)(n.E,{variant:"outline",className:"text-xs",children:t.category})]}),(null==o?void 0:o.lastUpdated)&&(0,s.jsxs)("div",{className:"flex items-center space-x-2 text-xs text-muted-foreground",children:[(0,s.jsx)(N.A,{className:"h-3 w-3"}),(0,s.jsxs)("span",{children:["Atualizado: ",o.lastUpdated.toLocaleString("pt-BR")]})]}),t.target&&(0,s.jsxs)("div",{className:"flex items-center space-x-2 text-xs text-muted-foreground",children:[(0,s.jsx)(u.A,{className:"h-3 w-3"}),(0,s.jsxs)("span",{children:["Meta: ",A(t.target,t.format)]})]})]})]})})]})}},55747:(e,a,t)=>{"use strict";t.d(a,{C:()=>l,z:()=>c});var s=t(95155),r=t(12115),i=t(54059),n=t(9428),o=t(53999);let c=r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,s.jsx)(i.bL,{className:(0,o.cn)("grid gap-2",t),...r,ref:a})});c.displayName=i.bL.displayName;let l=r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,s.jsx)(i.q7,{ref:a,className:(0,o.cn)("aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),...r,children:(0,s.jsx)(i.C1,{className:"flex items-center justify-center",children:(0,s.jsx)(n.A,{className:"h-2.5 w-2.5 fill-current text-current"})})})});l.displayName=i.q7.displayName},76037:(e,a,t)=>{"use strict";t.d(a,{Separator:()=>o});var s=t(95155),r=t(12115),i=t(87489),n=t(53999);let o=r.forwardRef((e,a)=>{let{className:t,orientation:r="horizontal",decorative:o=!0,...c}=e;return(0,s.jsx)(i.b,{ref:a,decorative:o,orientation:r,className:(0,n.cn)("shrink-0 bg-border","horizontal"===r?"h-[1px] w-full":"h-full w-[1px]",t),...c})});o.displayName=i.b.displayName},80425:(e,a,t)=>{"use strict";t.d(a,{A:()=>s.A});var s=t(31886)},83686:()=>{},90088:(e,a,t)=>{"use strict";t.d(a,{Switch:()=>o});var s=t(95155),r=t(12115),i=t(4884),n=t(53999);let o=r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,s.jsx)(i.bL,{className:(0,n.cn)("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",t),...r,ref:a,children:(0,s.jsx)(i.zi,{className:(0,n.cn)("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})})});o.displayName=i.bL.displayName},95139:(e,a,t)=>{"use strict";t.d(a,{S:()=>c});var s=t(95155),r=t(12115),i=t(76981),n=t(5196),o=t(53999);let c=r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,s.jsx)(i.bL,{ref:a,className:(0,o.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",t),...r,children:(0,s.jsx)(i.C1,{className:(0,o.cn)("flex items-center justify-center text-current"),children:(0,s.jsx)(n.A,{className:"h-4 w-4"})})})});c.displayName=i.bL.displayName},99474:(e,a,t)=>{"use strict";t.d(a,{T:()=>n});var s=t(95155),r=t(12115),i=t(53999);let n=r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,s.jsx)("textarea",{className:(0,i.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),ref:a,...r})});n.displayName="Textarea"},99840:(e,a,t)=>{"use strict";t.d(a,{Cf:()=>m,Es:()=>g,L3:()=>p,c7:()=>h,lG:()=>c,rr:()=>x,zM:()=>l});var s=t(95155),r=t(12115),i=t(15452),n=t(54416),o=t(53999);let c=i.bL,l=i.l9,d=i.ZL;i.bm;let u=r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,s.jsx)(i.hJ,{ref:a,className:(0,o.cn)("fixed inset-0 z-50 bg-background/80 backdrop-blur-sm data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...r})});u.displayName=i.hJ.displayName;let m=r.forwardRef((e,a)=>{let{className:t,children:r,...c}=e;return(0,s.jsxs)(d,{children:[(0,s.jsx)(u,{}),(0,s.jsxs)(i.UC,{ref:a,className:(0,o.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...c,children:[r,(0,s.jsxs)(i.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,s.jsx)(n.A,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});m.displayName=i.UC.displayName;let h=e=>{let{className:a,...t}=e;return(0,s.jsx)("div",{className:(0,o.cn)("flex flex-col space-y-1.5 text-center sm:text-left",a),...t})};h.displayName="DialogHeader";let g=e=>{let{className:a,...t}=e;return(0,s.jsx)("div",{className:(0,o.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",a),...t})};g.displayName="DialogFooter";let p=r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,s.jsx)(i.hE,{ref:a,className:(0,o.cn)("text-lg font-semibold leading-none tracking-tight",t),...r})});p.displayName=i.hE.displayName;let x=r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,s.jsx)(i.VY,{ref:a,className:(0,o.cn)("text-sm text-muted-foreground",t),...r})});x.displayName=i.VY.displayName}},e=>{e.O(0,[3524,3930,3455,3942,8250,5061,9855,6671,5954,6967,2960,3464,5452,1118,7127,3008,5297,8962,9340,7468,9327,3856,1040,7512,8441,5964,7358],()=>e(e.s=29133)),_N_E=e.O()}]);