(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6433],{22916:(e,s,a)=>{Promise.resolve().then(a.bind(a,76822))},76822:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>E});var l=a(95155),t=a(12115),i=a(35695),r=a(92657),c=a(13717),n=a(91788),d=a(62525),o=a(33109),x=a(35169),m=a(57434),h=a(69074),u=a(66932),j=a(97168),p=a(89852),v=a(88482),g=a(88145),N=a(63872),b=a(57471),f=a(93432),y=a(95784),w=a(67133),C=a(50126),k=a(46980),_=a(53999),P=a(56671);function D(e){let{prescription:s,onView:a,onEdit:t,onDelete:i,onDownloadPDF:o}=e;return(0,l.jsxs)(v.Zp,{className:"hover:shadow-md transition-shadow",children:[(0,l.jsx)(v.aR,{className:"pb-3",children:(0,l.jsxs)("div",{className:"flex items-start justify-between",children:[(0,l.jsxs)("div",{className:"space-y-1",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,l.jsxs)(v.ZB,{className:"text-lg",children:["Prescri\xe7\xe3o #",s.id]}),(0,l.jsx)(g.E,{className:(e=>{switch(e){case"active":return"bg-green-100 text-green-800";case"expired":return"bg-yellow-100 text-yellow-800";case"cancelled":return"bg-red-100 text-red-800";case"dispensed":return"bg-blue-100 text-blue-800";default:return"bg-gray-100 text-gray-800"}})(s.status),children:(e=>{switch(e){case"active":return"Ativa";case"expired":return"Expirada";case"cancelled":return"Cancelada";case"dispensed":return"Dispensada";default:return e}})(s.status)})]}),(0,l.jsxs)(v.BT,{children:[(e=>{switch(e){case"simple":return"Simples";case"controlled":return"Controlada";case"special":return"Especial";case"digital":return"Digital";default:return e}})(s.prescription_type)," • Criada em ",(0,_.Yq)(s.created_at)]})]}),(0,l.jsxs)(w.rI,{children:[(0,l.jsx)(w.ty,{asChild:!0,children:(0,l.jsx)(j.$,{variant:"ghost",size:"sm",children:"•••"})}),(0,l.jsxs)(w.SQ,{align:"end",children:[(0,l.jsxs)(w._2,{onClick:()=>a(s.id),children:[(0,l.jsx)(r.A,{className:"h-4 w-4 mr-2"}),"Visualizar"]}),"active"===s.status&&(0,l.jsxs)(w._2,{onClick:()=>t(s.id),children:[(0,l.jsx)(c.A,{className:"h-4 w-4 mr-2"}),"Editar"]}),(0,l.jsxs)(w._2,{onClick:()=>o(s.id),children:[(0,l.jsx)(n.A,{className:"h-4 w-4 mr-2"}),"Baixar PDF"]}),(0,l.jsxs)(w._2,{onClick:()=>i(s.id),className:"text-red-600",children:[(0,l.jsx)(d.A,{className:"h-4 w-4 mr-2"}),"Excluir"]})]})]})]})}),(0,l.jsxs)(v.Wu,{className:"pt-0",children:[(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("span",{className:"font-medium text-gray-500",children:"Paciente:"}),(0,l.jsxs)("p",{className:"text-gray-900",children:["ID: ",s.patient_id]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("span",{className:"font-medium text-gray-500",children:"Prontu\xe1rio:"}),(0,l.jsxs)("p",{className:"text-gray-900",children:["#",s.medical_record_id]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("span",{className:"font-medium text-gray-500",children:"Validade:"}),(0,l.jsx)("p",{className:"text-gray-900",children:s.expires_at?(0,_.Yq)(s.expires_at):"Sem validade"})]})]}),s.content&&(0,l.jsxs)("div",{className:"mt-4 pt-4 border-t",children:[(0,l.jsx)("span",{className:"font-medium text-gray-500 text-sm",children:"Observa\xe7\xf5es:"}),(0,l.jsx)("p",{className:"text-sm text-gray-900 mt-1 line-clamp-2",children:s.content})]}),(0,l.jsxs)("div",{className:"flex items-center justify-between mt-4 pt-4 border-t",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-4 text-xs text-gray-500",children:[(0,l.jsxs)("span",{children:["Atualizada: ",(0,_.Yq)(s.updated_at)]}),s.is_controlled&&(0,l.jsx)(g.E,{variant:"outline",className:"text-xs",children:"Controlada"})]}),(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsx)(j.$,{variant:"outline",size:"sm",onClick:()=>a(s.id),children:"Ver Detalhes"}),(0,l.jsx)(j.$,{variant:"ghost",size:"sm",onClick:()=>window.open("/prescriptions/patient/".concat(s.patient_id),"_blank"),children:"Ver Paciente"})]})]})]})]})}function A(e){let{title:s,value:a,description:t,icon:i,trend:r}=e;return(0,l.jsxs)(v.Zp,{children:[(0,l.jsxs)(v.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,l.jsx)(v.ZB,{className:"text-sm font-medium",children:s}),(0,l.jsx)(i,{className:"h-4 w-4 text-muted-foreground"})]}),(0,l.jsxs)(v.Wu,{children:[(0,l.jsx)("div",{className:"text-2xl font-bold",children:a}),(0,l.jsx)("p",{className:"text-xs text-muted-foreground",children:t}),r&&(0,l.jsxs)("div",{className:"flex items-center text-xs mt-1 ".concat(r.isPositive?"text-green-600":"text-red-600"),children:[(0,l.jsx)(o.A,{className:"h-3 w-3 mr-1 ".concat(r.isPositive?"":"rotate-180")}),r.value,"% em rela\xe7\xe3o ao m\xeas anterior"]})]})]})}function E(){let e=(0,i.useParams)(),s=(0,i.useRouter)(),a=Number(e.doctorId),[r,c]=(0,t.useState)(1),[n,d]=(0,t.useState)(""),[o,g]=(0,t.useState)("all"),[w,_]=(0,t.useState)("all"),[E,S]=(0,t.useState)("all"),F={search:n||void 0,status:"all"!==o?o:void 0,prescription_type:"all"!==w?w:void 0,page:r,limit:10};if("all"!==E){let e,s=new Date;switch(E){case"today":e=new Date(s.getFullYear(),s.getMonth(),s.getDate());break;case"week":e=new Date(s.getTime()-6048e5);break;case"month":e=new Date(s.getFullYear(),s.getMonth(),1);break;case"quarter":e=new Date(s.getFullYear(),3*Math.floor(s.getMonth()/3),1);break;default:e=new Date(s.getFullYear(),0,1)}F.start_date=e.toISOString().split("T")[0],F.end_date=s.toISOString().split("T")[0]}let{data:V,isLoading:T,error:$}=(0,C.zU)(a,F),q=(null==V?void 0:V.prescriptions)||[],z=(null==V?void 0:V.total_pages)||1,Y=(null==V?void 0:V.total)||0,B={total:Y,active:q.filter(e=>"active"===e.status).length,expired:q.filter(e=>"expired"===e.status).length,controlled:q.filter(e=>e.is_controlled).length},M=e=>{s.push("/prescriptions/".concat(e))},Z=e=>{s.push("/prescriptions/".concat(e,"/edit"))},I=e=>{P.o.info("Funcionalidade de exclus\xe3o ser\xe1 implementada")},O=e=>{P.o.info("Download de PDF ser\xe1 implementado")},R=()=>{d(""),g("all"),_("all"),S("all"),c(1)},W=n||"all"!==o||"all"!==w||"all"!==E;return T?(0,l.jsx)("div",{className:"flex items-center justify-center min-h-[400px]",children:(0,l.jsx)(N.LoadingSpinner,{size:"lg"})}):$?(0,l.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,l.jsx)(v.Zp,{children:(0,l.jsx)(v.Wu,{className:"flex flex-col items-center justify-center py-12",children:(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Erro ao carregar prescri\xe7\xf5es"}),(0,l.jsx)("p",{className:"text-gray-600 mb-4",children:"Ocorreu um erro ao carregar o hist\xf3rico de prescri\xe7\xf5es do m\xe9dico."}),(0,l.jsxs)(j.$,{onClick:()=>s.push("/prescriptions"),children:[(0,l.jsx)(x.A,{className:"h-4 w-4 mr-2"}),"Voltar para Prescri\xe7\xf5es"]})]})})})}):(0,l.jsxs)("div",{className:"container mx-auto px-4 py-8 space-y-6",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,l.jsxs)(j.$,{variant:"ghost",size:"sm",onClick:()=>s.push("/prescriptions"),children:[(0,l.jsx)(x.A,{className:"h-4 w-4 mr-2"}),"Voltar"]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Prescri\xe7\xf5es do M\xe9dico"}),(0,l.jsxs)("p",{className:"text-gray-600",children:["M\xe9dico ID: ",a," • ",Y," prescri\xe7\xe3o",1!==Y?"\xf5es":""]})]})]}),(0,l.jsxs)(j.$,{onClick:()=>s.push("/prescriptions/create"),children:[(0,l.jsx)(m.A,{className:"h-4 w-4 mr-2"}),"Nova Prescri\xe7\xe3o"]})]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,l.jsx)(A,{title:"Total de Prescri\xe7\xf5es",value:B.total,description:"Todas as prescri\xe7\xf5es",icon:m.A}),(0,l.jsx)(A,{title:"Prescri\xe7\xf5es Ativas",value:B.active,description:"V\xe1lidas e em uso",icon:h.A}),(0,l.jsx)(A,{title:"Prescri\xe7\xf5es Expiradas",value:B.expired,description:"Fora da validade",icon:h.A}),(0,l.jsx)(A,{title:"Medicamentos Controlados",value:B.controlled,description:"Prescri\xe7\xf5es especiais",icon:m.A})]}),(0,l.jsxs)(v.Zp,{children:[(0,l.jsx)(v.aR,{children:(0,l.jsxs)(v.ZB,{className:"text-lg flex items-center",children:[(0,l.jsx)(u.A,{className:"h-5 w-5 mr-2"}),"Filtros"]})}),(0,l.jsx)(v.Wu,{children:(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-sm font-medium text-gray-700 mb-2 block",children:"Buscar"}),(0,l.jsx)(p.p,{placeholder:"Buscar por observa\xe7\xf5es...",value:n,onChange:e=>d(e.target.value)})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-sm font-medium text-gray-700 mb-2 block",children:"Status"}),(0,l.jsxs)(y.l6,{value:o,onValueChange:g,children:[(0,l.jsx)(y.bq,{children:(0,l.jsx)(y.yv,{})}),(0,l.jsxs)(y.gC,{children:[(0,l.jsx)(y.eb,{value:"all",children:"Todos os status"}),k.SY.map(e=>(0,l.jsx)(y.eb,{value:e.value,children:e.label},e.value))]})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-sm font-medium text-gray-700 mb-2 block",children:"Tipo"}),(0,l.jsxs)(y.l6,{value:w,onValueChange:_,children:[(0,l.jsx)(y.bq,{children:(0,l.jsx)(y.yv,{})}),(0,l.jsxs)(y.gC,{children:[(0,l.jsx)(y.eb,{value:"all",children:"Todos os tipos"}),(0,l.jsx)(y.eb,{value:"simple",children:"Simples"}),(0,l.jsx)(y.eb,{value:"controlled",children:"Controlada"}),(0,l.jsx)(y.eb,{value:"special",children:"Especial"}),(0,l.jsx)(y.eb,{value:"digital",children:"Digital"})]})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-sm font-medium text-gray-700 mb-2 block",children:"Per\xedodo"}),(0,l.jsxs)(y.l6,{value:E,onValueChange:S,children:[(0,l.jsx)(y.bq,{children:(0,l.jsx)(y.yv,{})}),(0,l.jsxs)(y.gC,{children:[(0,l.jsx)(y.eb,{value:"all",children:"Todo o per\xedodo"}),(0,l.jsx)(y.eb,{value:"today",children:"Hoje"}),(0,l.jsx)(y.eb,{value:"week",children:"\xdaltima semana"}),(0,l.jsx)(y.eb,{value:"month",children:"Este m\xeas"}),(0,l.jsx)(y.eb,{value:"quarter",children:"Este trimestre"}),(0,l.jsx)(y.eb,{value:"year",children:"Este ano"})]})]})]}),(0,l.jsx)("div",{className:"flex items-end",children:W&&(0,l.jsx)(j.$,{variant:"outline",onClick:R,className:"w-full",children:"Limpar Filtros"})})]})})]}),0===q.length?(0,l.jsx)(b.p,{icon:m.A,title:"Nenhuma prescri\xe7\xe3o encontrada",description:W?"Nenhuma prescri\xe7\xe3o corresponde aos filtros aplicados.":"Este m\xe9dico ainda n\xe3o possui prescri\xe7\xf5es registradas.",action:W?(0,l.jsx)(j.$,{onClick:R,children:"Limpar Filtros"}):(0,l.jsxs)(j.$,{onClick:()=>s.push("/prescriptions/create"),children:[(0,l.jsx)(m.A,{className:"h-4 w-4 mr-2"}),"Criar Primeira Prescri\xe7\xe3o"]})}):(0,l.jsx)("div",{className:"space-y-4",children:q.map(e=>(0,l.jsx)(D,{prescription:e,onView:M,onEdit:Z,onDelete:I,onDownloadPDF:O},e.id))}),z>1&&(0,l.jsx)("div",{className:"flex justify-center",children:(0,l.jsx)(f.dK,{currentPage:r,totalPages:z,onPageChange:c})})]})}}},e=>{e.O(0,[3455,3942,8250,5061,9855,6671,5954,6967,2960,3464,1118,3226,9860,2902,8441,5964,7358],()=>e(e.s=22916)),_N_E=e.O()}]);