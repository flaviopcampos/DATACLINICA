"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4500],{31814:(e,t,r)=>{r.d(t,{NL:()=>d});var a=r(12115),s=r(26715),o=r(32960),n=r(5041),i=r(56671),c=r(95954);let u={config:["2fa","config"],trustedDevices:["2fa","trusted-devices"],authLogs:["2fa","auth-logs"],stats:["2fa","stats"]};function d(){let e=(0,s.jE)(),[t,r]=(0,a.useState)(null),{data:d,isLoading:l,error:g}=(0,o.I)({queryKey:u.config,queryFn:()=>c.Z.getConfig(),retry:!1}),{data:v=[],isLoading:f}=(0,o.I)({queryKey:u.trustedDevices,queryFn:()=>c.Z.getTrustedDevices(),enabled:!!d&&d.status===TwoFactorStatus.ENABLED}),{data:m=[],isLoading:y}=(0,o.I)({queryKey:u.authLogs,queryFn:()=>c.Z.getAuthLogs(50),enabled:!!d&&d.status===TwoFactorStatus.ENABLED}),{data:p,isLoading:h}=(0,o.I)({queryKey:u.stats,queryFn:()=>c.Z.getStats(),enabled:!!d&&d.status===TwoFactorStatus.ENABLED}),b=(0,n.n)({mutationFn:e=>c.Z.setupTwoFactor(e),onSuccess:()=>{i.o.success("2FA configurado com sucesso!"),e.invalidateQueries({queryKey:u.config})},onError:e=>{r(e.message),i.o.error(e.message)}}),w=(0,n.n)({mutationFn:e=>c.Z.verifyTwoFactor(e),onError:e=>{r(e.message),i.o.error(e.message)}}),x=(0,n.n)({mutationFn:e=>c.Z.disableTwoFactor(e),onSuccess:()=>{i.o.success("2FA desabilitado com sucesso!"),e.invalidateQueries({queryKey:u.config}),e.removeQueries({queryKey:u.trustedDevices}),e.removeQueries({queryKey:u.authLogs}),e.removeQueries({queryKey:u.stats})},onError:e=>{r(e.message),i.o.error(e.message)}}),F=(0,n.n)({mutationFn:()=>c.Z.regenerateBackupCodes(),onSuccess:()=>{i.o.success("C\xf3digos de backup regenerados!"),e.invalidateQueries({queryKey:u.config})},onError:e=>{r(e.message),i.o.error(e.message)}}),E=(0,n.n)({mutationFn:e=>c.Z.removeTrustedDevice(e),onSuccess:()=>{i.o.success("Dispositivo removido com sucesso!"),e.invalidateQueries({queryKey:u.trustedDevices})},onError:e=>{r(e.message),i.o.error(e.message)}}),C=(0,a.useCallback)(async e=>(r(null),b.mutateAsync(e)),[b]),D=(0,a.useCallback)(async e=>(r(null),w.mutateAsync(e)),[w]),A=(0,a.useCallback)(async e=>(r(null),x.mutateAsync(e)),[x]),k=(0,a.useCallback)(async()=>(r(null),F.mutateAsync()),[F]),N=(0,a.useCallback)(async e=>(r(null),E.mutateAsync(e)),[E]),T=(0,a.useCallback)(async()=>{await e.invalidateQueries({queryKey:u.config}),await e.invalidateQueries({queryKey:u.trustedDevices}),await e.invalidateQueries({queryKey:u.authLogs}),await e.invalidateQueries({queryKey:u.stats})},[e]);return(0,a.useEffect)(()=>{g?r(g.message):r(null)},[g]),{config:d||null,trustedDevices:v,authLogs:m,stats:p||null,isLoading:l||f||y||h,error:t,setupTwoFactor:C,verifyTwoFactor:D,disableTwoFactor:A,regenerateBackupCodes:k,removeTrustedDevice:N,refreshConfig:T}}},31886:(e,t,r)=>{r.d(t,{A:()=>n,O:()=>i});var a=r(23464),s=r(56671);let o=a.A.create({baseURL:"http://localhost:8000",timeout:1e4,headers:{"Content-Type":"application/json"}});o.interceptors.request.use(e=>{let t=localStorage.getItem("token");return t&&(e.headers.Authorization="Bearer ".concat(t)),e},e=>Promise.reject(e)),o.interceptors.response.use(e=>e,e=>{let{response:t}=e;if((null==t?void 0:t.status)===401)localStorage.removeItem("token"),localStorage.removeItem("user"),s.o.error("Sess\xe3o expirada. Fa\xe7a login novamente."),window.location.href="/auth/login";else if((null==t?void 0:t.status)===403)s.o.error("Acesso negado.");else if((null==t?void 0:t.status)===404)s.o.error("Recurso n\xe3o encontrado.");else if((null==t?void 0:t.status)>=500)s.o.error("Erro interno do servidor. Tente novamente mais tarde.");else if("ECONNABORTED"===e.code)s.o.error("Tempo limite da requisi\xe7\xe3o excedido.");else{var r;s.o.error((null==t||null==(r=t.data)?void 0:r.message)||"Erro inesperado.")}return Promise.reject(e)});let n=o,i={get:async(e,t)=>(await o.get(e,{params:t})).data,post:async(e,t)=>(await o.post(e,t)).data,put:async(e,t)=>(await o.put(e,t)).data,delete:async e=>(await o.delete(e)).data,patch:async(e,t)=>(await o.patch(e,t)).data}},53999:(e,t,r)=>{r.d(t,{Yq:()=>n,cn:()=>o,r6:()=>i});var a=r(52596),s=r(39688);function o(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,s.QP)((0,a.$)(t))}function n(e){return new Intl.DateTimeFormat("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric"}).format(new Date(e))}function i(e){return new Intl.DateTimeFormat("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}).format(new Date(e))}},76037:(e,t,r)=>{r.d(t,{Separator:()=>i});var a=r(95155),s=r(12115),o=r(87489),n=r(53999);let i=s.forwardRef((e,t)=>{let{className:r,orientation:s="horizontal",decorative:i=!0,...c}=e;return(0,a.jsx)(o.b,{ref:t,decorative:i,orientation:s,className:(0,n.cn)("shrink-0 bg-border","horizontal"===s?"h-[1px] w-full":"h-full w-[1px]",r),...c})});i.displayName=o.b.displayName},80722:(e,t,r)=>{r.d(t,{F:()=>a.A});var a=r(31886)},88145:(e,t,r)=>{r.d(t,{E:()=>i});var a=r(95155);r(12115);var s=r(74466),o=r(53999);let n=(0,s.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function i(e){let{className:t,variant:r,...s}=e;return(0,a.jsx)("div",{className:(0,o.cn)(n({variant:r}),t),...s})}},88482:(e,t,r)=>{r.d(t,{BT:()=>u,Wu:()=>d,ZB:()=>c,Zp:()=>n,aR:()=>i});var a=r(95155),s=r(12115),o=r(53999);let n=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,o.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",r),...s})});n.displayName="Card";let i=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,o.cn)("flex flex-col space-y-1.5 p-6",r),...s})});i.displayName="CardHeader";let c=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("h3",{ref:t,className:(0,o.cn)("text-2xl font-semibold leading-none tracking-tight",r),...s})});c.displayName="CardTitle";let u=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("p",{ref:t,className:(0,o.cn)("text-sm text-muted-foreground",r),...s})});u.displayName="CardDescription";let d=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,o.cn)("p-6 pt-0",r),...s})});d.displayName="CardContent",s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,o.cn)("flex items-center p-6 pt-0",r),...s})}).displayName="CardFooter"},95954:(e,t,r)=>{r.d(t,{Z:()=>o});var a=r(80722);class s{async getConfig(){try{return(await a.F.get("".concat(this.baseUrl,"/config"))).data}catch(a){var e,t,r;if((null==(e=a.response)?void 0:e.status)===404)return null;throw Error((null==(r=a.response)||null==(t=r.data)?void 0:t.message)||"Erro ao obter configura\xe7\xe3o 2FA")}}async setupTwoFactor(e){try{return(await a.F.post("".concat(this.baseUrl,"/setup"),e)).data}catch(e){var t,r;throw Error((null==(r=e.response)||null==(t=r.data)?void 0:t.message)||"Erro ao configurar 2FA")}}async confirmSetup(e){try{return(await a.F.post("".concat(this.baseUrl,"/confirm-setup"),{code:e})).data}catch(e){var t,r;throw Error((null==(r=e.response)||null==(t=r.data)?void 0:t.message)||"C\xf3digo inv\xe1lido")}}async verifyTwoFactor(e){try{return(await a.F.post("".concat(this.baseUrl,"/verify"),e)).data}catch(e){var t,r;throw Error((null==(r=e.response)||null==(t=r.data)?void 0:t.message)||"C\xf3digo inv\xe1lido")}}async disableTwoFactor(e){try{await a.F.post("".concat(this.baseUrl,"/disable"),e)}catch(e){var t,r;throw Error((null==(r=e.response)||null==(t=r.data)?void 0:t.message)||"Erro ao desabilitar 2FA")}}async regenerateBackupCodes(){try{return(await a.F.post("".concat(this.baseUrl,"/regenerate-backup-codes"))).data.backup_codes}catch(r){var e,t;throw Error((null==(t=r.response)||null==(e=t.data)?void 0:e.message)||"Erro ao regenerar c\xf3digos de backup")}}async getTrustedDevices(){try{return(await a.F.get("".concat(this.baseUrl,"/trusted-devices"))).data}catch(r){var e,t;throw Error((null==(t=r.response)||null==(e=t.data)?void 0:e.message)||"Erro ao obter dispositivos confi\xe1veis")}}async removeTrustedDevice(e){try{await a.F.delete("".concat(this.baseUrl,"/trusted-devices/").concat(e))}catch(e){var t,r;throw Error((null==(r=e.response)||null==(t=r.data)?void 0:t.message)||"Erro ao remover dispositivo")}}async getAuthLogs(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50;try{return(await a.F.get("".concat(this.baseUrl,"/auth-logs"),{params:{limit:e}})).data}catch(e){var t,r;throw Error((null==(r=e.response)||null==(t=r.data)?void 0:t.message)||"Erro ao obter logs de autentica\xe7\xe3o")}}async getStats(){try{return(await a.F.get("".concat(this.baseUrl,"/stats"))).data}catch(r){var e,t;throw Error((null==(t=r.response)||null==(e=t.data)?void 0:e.message)||"Erro ao obter estat\xedsticas")}}async checkTrustedDevice(e){try{return(await a.F.post("".concat(this.baseUrl,"/check-trusted-device"),{device_fingerprint:e})).data.is_trusted}catch(e){return!1}}generateDeviceFingerprint(){let e=document.createElement("canvas"),t=e.getContext("2d");t&&(t.textBaseline="top",t.font="14px Arial",t.fillText("Device fingerprint",2,2));let r=[navigator.userAgent,navigator.language,screen.width+"x"+screen.height,new Date().getTimezoneOffset(),e.toDataURL(),navigator.hardwareConcurrency||0,navigator.deviceMemory||0].join("|"),a=0;for(let e=0;e<r.length;e++)a=(a<<5)-a+r.charCodeAt(e),a&=a;return Math.abs(a).toString(36)}getCurrentDeviceInfo(){let e=navigator.userAgent,t="Dispositivo Desconhecido";return t=/Mobile|Android|iPhone|iPad/.test(e)?/iPhone/.test(e)?"iPhone":/iPad/.test(e)?"iPad":/Android/.test(e)?"Android":"Mobile":/Windows/.test(e)?"Windows PC":/Mac/.test(e)?"Mac":/Linux/.test(e)?"Linux":"Desktop",/Chrome/.test(e)?t+=" - Chrome":/Firefox/.test(e)?t+=" - Firefox":/Safari/.test(e)?t+=" - Safari":/Edge/.test(e)&&(t+=" - Edge"),{name:t,fingerprint:this.generateDeviceFingerprint(),userAgent:e}}constructor(){this.baseUrl="/auth/2fa"}}let o=new s},97168:(e,t,r)=>{r.d(t,{$:()=>u,r:()=>c});var a=r(95155),s=r(12115),o=r(99708),n=r(74466),i=r(53999);let c=(0,n.F)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),u=s.forwardRef((e,t)=>{let{className:r,variant:s,size:n,asChild:u=!1,...d}=e,l=u?o.DX:"button";return(0,a.jsx)(l,{className:(0,i.cn)(c({variant:s,size:n,className:r})),ref:t,...d})});u.displayName="Button"}}]);