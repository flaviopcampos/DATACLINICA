"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9208],{3070:(e,s,r)=>{r.d(s,{Jd:()=>d,Nu:()=>p,Qc:()=>m,Tk:()=>u,iY:()=>x,kp:()=>c,xJ:()=>h});var a=r(32960),l=r(26715),n=r(5041),i=r(56671),o=r(25667);let t={all:["users"],lists:()=>[...t.all,"list"],list:e=>[...t.lists(),{filters:e}],details:()=>[...t.all,"detail"],detail:e=>[...t.details(),e],current:()=>[...t.all,"current"],sessions:e=>[...t.all,"sessions",e],audit:e=>[...t.all,"audit",e]};function c(e){return(0,a.I)({queryKey:t.list(null==e?void 0:e.filters),queryFn:()=>o.Dv.getUsers(e),staleTime:3e5,gcTime:6e5})}function d(e){let s=!(arguments.length>1)||void 0===arguments[1]||arguments[1];return(0,a.I)({queryKey:t.detail(e),queryFn:()=>o.Dv.getUserById(e),enabled:s&&!!e,staleTime:3e5,gcTime:6e5})}function u(){let e=(0,l.jE)();return(0,n.n)({mutationFn:e=>o.Dv.createUser(e),onSuccess:s=>{e.invalidateQueries({queryKey:t.lists()}),e.setQueryData(t.detail(s.id),s),i.o.success("Usu\xe1rio criado com sucesso!")},onError:e=>{var s,r;let a=(null==e||null==(r=e.response)||null==(s=r.data)?void 0:s.detail)||"Erro ao criar usu\xe1rio";i.o.error(a)}})}function m(){let e=(0,l.jE)();return(0,n.n)({mutationFn:e=>{let{id:s,userData:r}=e;return o.Dv.updateUser(s,r)},onSuccess:s=>{e.setQueryData(t.detail(s.id),s),e.invalidateQueries({queryKey:t.lists()});let r=e.getQueryData(t.current());r&&r.id===s.id&&e.setQueryData(t.current(),s),i.o.success("Usu\xe1rio atualizado com sucesso!")},onError:e=>{var s,r;let a=(null==e||null==(r=e.response)||null==(s=r.data)?void 0:s.detail)||"Erro ao atualizar usu\xe1rio";i.o.error(a)}})}function x(){let e=(0,l.jE)();return(0,n.n)({mutationFn:e=>o.Dv.deleteUser(e),onSuccess:(s,r)=>{e.removeQueries({queryKey:t.detail(r)}),e.invalidateQueries({queryKey:t.lists()}),i.o.success("Usu\xe1rio removido com sucesso!")},onError:e=>{var s,r;let a=(null==e||null==(r=e.response)||null==(s=r.data)?void 0:s.detail)||"Erro ao remover usu\xe1rio";i.o.error(a)}})}function p(){let e=(0,l.jE)();return(0,n.n)({mutationFn:e=>{let{id:s,isActive:r}=e;return o.Dv.toggleUserStatus(s,r)},onSuccess:s=>{e.setQueryData(t.detail(s.id),s),e.invalidateQueries({queryKey:t.lists()});let r=s.is_active?"ativado":"desativado";i.o.success("Usu\xe1rio ".concat(r," com sucesso!"))},onError:e=>{var s,r;let a=(null==e||null==(r=e.response)||null==(s=r.data)?void 0:s.detail)||"Erro ao alterar status do usu\xe1rio";i.o.error(a)}})}function h(){let e=(0,l.jE)();return(0,n.n)({mutationFn:e=>o.Dv.unlockUser(e),onSuccess:s=>{e.setQueryData(t.detail(s.id),s),e.invalidateQueries({queryKey:t.lists()}),i.o.success("Conta desbloqueada com sucesso!")},onError:e=>{var s,r;let a=(null==e||null==(r=e.response)||null==(s=r.data)?void 0:s.detail)||"Erro ao desbloquear conta";i.o.error(a)}})}},3803:(e,s,r)=>{r.d(s,{q:()=>R});var a=r(95155),l=r(12115),n=r(62177),i=r(90221),o=r(68309),t=r(92188),c=r(97168),d=r(89852),u=r(95784),m=r(30070),x=r(90088),p=r(88482),h=r(63872),j=r(54416),f=r(4229),v=r(71007),g=r(28883),N=r(19420),y=r(75525),C=r(57434),b=r(78749),w=r(92657);let E=o.Ik({username:o.Yj().min(3,"Username deve ter pelo menos 3 caracteres").max(50,"Username deve ter no m\xe1ximo 50 caracteres").regex(/^[a-zA-Z0-9_]+$/,"Username deve conter apenas letras, n\xfameros e underscore"),email:o.Yj().email("Email inv\xe1lido").max(255,"Email deve ter no m\xe1ximo 255 caracteres"),full_name:o.Yj().min(2,"Nome completo deve ter pelo menos 2 caracteres").max(255,"Nome completo deve ter no m\xe1ximo 255 caracteres"),password:o.Yj().min(8,"Senha deve ter pelo menos 8 caracteres").regex(/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]/,"Senha deve conter pelo menos: 1 letra min\xfascula, 1 mai\xfascula, 1 n\xfamero e 1 caractere especial").optional(),confirm_password:o.Yj().optional(),role:o.k5([t.QY.ADMIN,t.QY.DOCTOR,t.QY.NURSE,t.QY.RECEPTIONIST]),phone:o.Yj().regex(/^\(\d{2}\)\s\d{4,5}-\d{4}$/,"Telefone deve estar no formato (XX) XXXXX-XXXX").optional().or(o.eu("")),cpf:o.Yj().regex(/^\d{3}\.\d{3}\.\d{3}-\d{2}$/,"CPF deve estar no formato XXX.XXX.XXX-XX").optional().or(o.eu("")),professional_license:o.Yj().max(50,"Registro profissional deve ter no m\xe1ximo 50 caracteres").optional().or(o.eu("")),specialty:o.Yj().max(100,"Especialidade deve ter no m\xe1ximo 100 caracteres").optional().or(o.eu("")),is_active:o.zM().default(!0),clinic_id:o.Yj().optional()}).refine(e=>!e.password||!e.confirm_password||e.password===e.confirm_password,{message:"Senhas n\xe3o coincidem",path:["confirm_password"]});function R(e){var s;let{user:r,onSubmit:o,onCancel:R,isLoading:I=!1,mode:X}=e,[D,S]=(0,l.useState)(!1),[_,Q]=(0,l.useState)(!1),T=(0,n.mN)({resolver:(0,i.u)(E),defaultValues:{username:(null==r?void 0:r.username)||"",email:(null==r?void 0:r.email)||"",full_name:(null==r?void 0:r.full_name)||"",password:"",confirm_password:"",role:(null==r?void 0:r.role)||t.QY.RECEPTIONIST,phone:(null==r?void 0:r.phone)||"",cpf:(null==r?void 0:r.cpf)||"",professional_license:(null==r?void 0:r.professional_license)||"",specialty:(null==r?void 0:r.specialty)||"",is_active:null==(s=null==r?void 0:r.is_active)||s,clinic_id:(null==r?void 0:r.clinic_id)||""}}),U=T.watch("role"),Y=U===t.QY.DOCTOR,A=U===t.QY.NURSE,k=Y||A;(0,l.useEffect)(()=>{k&&(T.setValue("professional_license",T.getValues("professional_license")||""),Y&&T.setValue("specialty",T.getValues("specialty")||""))},[U,T,k,Y]);let M=async e=>{try{let s={username:e.username,email:e.email,full_name:e.full_name,role:e.role,phone:e.phone||void 0,cpf:e.cpf||void 0,professional_license:e.professional_license||void 0,specialty:e.specialty||void 0,is_active:e.is_active,clinic_id:e.clinic_id||void 0};if("create"===X)await o({...s,password:e.password});else{let r={...s};e.password&&(r.password=e.password),await o(r)}}catch(e){}};return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-2xl font-bold tracking-tight",children:"create"===X?"Criar Novo Usu\xe1rio":"Editar Usu\xe1rio"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"create"===X?"Preencha os dados para criar um novo usu\xe1rio no sistema":"Atualize as informa\xe7\xf5es do usu\xe1rio"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsxs)(c.$,{variant:"outline",onClick:R,disabled:I,children:[(0,a.jsx)(j.A,{className:"mr-2 h-4 w-4"}),"Cancelar"]}),(0,a.jsxs)(c.$,{onClick:T.handleSubmit(M),disabled:I,children:[I?(0,a.jsx)(h.LoadingSpinner,{size:"sm",className:"mr-2"}):(0,a.jsx)(f.A,{className:"mr-2 h-4 w-4"}),"create"===X?"Criar Usu\xe1rio":"Salvar Altera\xe7\xf5es"]})]})]}),(0,a.jsx)(m.lV,{...T,children:(0,a.jsxs)("form",{onSubmit:T.handleSubmit(M),className:"space-y-6",children:[(0,a.jsxs)(p.Zp,{children:[(0,a.jsxs)(p.aR,{children:[(0,a.jsxs)(p.ZB,{className:"flex items-center",children:[(0,a.jsx)(v.A,{className:"mr-2 h-5 w-5"}),"Informa\xe7\xf5es B\xe1sicas"]}),(0,a.jsx)(p.BT,{children:"Dados principais do usu\xe1rio"})]}),(0,a.jsxs)(p.Wu,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsx)(m.zB,{control:T.control,name:"full_name",render:e=>{let{field:s}=e;return(0,a.jsxs)(m.eI,{children:[(0,a.jsx)(m.lR,{children:"Nome Completo *"}),(0,a.jsx)(m.MJ,{children:(0,a.jsx)(d.p,{placeholder:"Digite o nome completo",...s})}),(0,a.jsx)(m.C5,{})]})}}),(0,a.jsx)(m.zB,{control:T.control,name:"username",render:e=>{let{field:s}=e;return(0,a.jsxs)(m.eI,{children:[(0,a.jsx)(m.lR,{children:"Username *"}),(0,a.jsx)(m.MJ,{children:(0,a.jsx)(d.p,{placeholder:"Digite o username",...s})}),(0,a.jsx)(m.Rr,{children:"Usado para login no sistema"}),(0,a.jsx)(m.C5,{})]})}})]}),(0,a.jsx)(m.zB,{control:T.control,name:"email",render:e=>{let{field:s}=e;return(0,a.jsxs)(m.eI,{children:[(0,a.jsx)(m.lR,{children:"Email *"}),(0,a.jsx)(m.MJ,{children:(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(g.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground h-4 w-4"}),(0,a.jsx)(d.p,{type:"email",placeholder:"Digite o email",className:"pl-10",...s})]})}),(0,a.jsx)(m.C5,{})]})}}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsx)(m.zB,{control:T.control,name:"phone",render:e=>{let{field:s}=e;return(0,a.jsxs)(m.eI,{children:[(0,a.jsx)(m.lR,{children:"Telefone"}),(0,a.jsx)(m.MJ,{children:(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(N.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground h-4 w-4"}),(0,a.jsx)(d.p,{placeholder:"(XX) XXXXX-XXXX",className:"pl-10",...s,onChange:e=>{let r=(e=>{let s=e.replace(/\D/g,"");return s.length<=10?s.replace(/(\d{2})(\d{4})(\d{4})/,"($1) $2-$3"):s.replace(/(\d{2})(\d{5})(\d{4})/,"($1) $2-$3")})(e.target.value);s.onChange(r)}})]})}),(0,a.jsx)(m.C5,{})]})}}),(0,a.jsx)(m.zB,{control:T.control,name:"cpf",render:e=>{let{field:s}=e;return(0,a.jsxs)(m.eI,{children:[(0,a.jsx)(m.lR,{children:"CPF"}),(0,a.jsx)(m.MJ,{children:(0,a.jsx)(d.p,{placeholder:"XXX.XXX.XXX-XX",...s,onChange:e=>{let r=e.target.value.replace(/\D/g,"").replace(/(\d{3})(\d{3})(\d{3})(\d{2})/,"$1.$2.$3-$4");s.onChange(r)}})}),(0,a.jsx)(m.C5,{})]})}})]})]})]}),(0,a.jsxs)(p.Zp,{children:[(0,a.jsxs)(p.aR,{children:[(0,a.jsxs)(p.ZB,{className:"flex items-center",children:[(0,a.jsx)(y.A,{className:"mr-2 h-5 w-5"}),"Perfil e Permiss\xf5es"]}),(0,a.jsx)(p.BT,{children:"Defina o papel do usu\xe1rio no sistema"})]}),(0,a.jsxs)(p.Wu,{className:"space-y-4",children:[(0,a.jsx)(m.zB,{control:T.control,name:"role",render:e=>{let{field:s}=e;return(0,a.jsxs)(m.eI,{children:[(0,a.jsx)(m.lR,{children:"Perfil *"}),(0,a.jsxs)(u.l6,{onValueChange:s.onChange,defaultValue:s.value,children:[(0,a.jsx)(m.MJ,{children:(0,a.jsx)(u.bq,{children:(0,a.jsx)(u.yv,{placeholder:"Selecione o perfil"})})}),(0,a.jsx)(u.gC,{children:Object.values(t.QY).map(e=>(0,a.jsx)(u.eb,{value:e,children:(0,a.jsx)("div",{className:"flex items-center justify-between w-full",children:(0,a.jsx)("span",{children:{[t.QY.ADMIN]:"Administrador",[t.QY.DOCTOR]:"M\xe9dico",[t.QY.NURSE]:"Enfermeiro",[t.QY.RECEPTIONIST]:"Recepcionista"}[e]||e})})},e))})]}),U&&(0,a.jsx)(m.Rr,{children:{[t.QY.ADMIN]:"Acesso total ao sistema, pode gerenciar usu\xe1rios e configura\xe7\xf5es",[t.QY.DOCTOR]:"Pode criar prescri\xe7\xf5es, visualizar pacientes e agendar consultas",[t.QY.NURSE]:"Pode auxiliar em consultas e gerenciar medicamentos",[t.QY.RECEPTIONIST]:"Pode agendar consultas e gerenciar pacientes"}[U]||""}),(0,a.jsx)(m.C5,{})]})}}),(0,a.jsx)(m.zB,{control:T.control,name:"is_active",render:e=>{let{field:s}=e;return(0,a.jsxs)(m.eI,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[(0,a.jsxs)("div",{className:"space-y-0.5",children:[(0,a.jsx)(m.lR,{className:"text-base",children:"Usu\xe1rio Ativo"}),(0,a.jsx)(m.Rr,{children:"Usu\xe1rios inativos n\xe3o podem acessar o sistema"})]}),(0,a.jsx)(m.MJ,{children:(0,a.jsx)(x.Switch,{checked:s.value,onCheckedChange:s.onChange})})]})}})]})]}),k&&(0,a.jsxs)(p.Zp,{children:[(0,a.jsxs)(p.aR,{children:[(0,a.jsxs)(p.ZB,{className:"flex items-center",children:[(0,a.jsx)(C.A,{className:"mr-2 h-5 w-5"}),"Informa\xe7\xf5es Profissionais"]}),(0,a.jsx)(p.BT,{children:"Dados espec\xedficos para profissionais de sa\xfade"})]}),(0,a.jsx)(p.Wu,{className:"space-y-4",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsx)(m.zB,{control:T.control,name:"professional_license",render:e=>{let{field:s}=e;return(0,a.jsxs)(m.eI,{children:[(0,a.jsxs)(m.lR,{children:[Y?"CRM":"COREN"," ",k?"*":""]}),(0,a.jsx)(m.MJ,{children:(0,a.jsx)(d.p,{placeholder:"Digite o ".concat(Y?"CRM":"COREN"),...s})}),(0,a.jsx)(m.C5,{})]})}}),Y&&(0,a.jsx)(m.zB,{control:T.control,name:"specialty",render:e=>{let{field:s}=e;return(0,a.jsxs)(m.eI,{children:[(0,a.jsx)(m.lR,{children:"Especialidade"}),(0,a.jsx)(m.MJ,{children:(0,a.jsx)(d.p,{placeholder:"Digite a especialidade",...s})}),(0,a.jsx)(m.C5,{})]})}})]})})]}),(0,a.jsxs)(p.Zp,{children:[(0,a.jsxs)(p.aR,{children:[(0,a.jsx)(p.ZB,{children:"Senha"}),(0,a.jsx)(p.BT,{children:"create"===X?"Defina uma senha segura para o usu\xe1rio":"Deixe em branco para manter a senha atual"})]}),(0,a.jsx)(p.Wu,{className:"space-y-4",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsx)(m.zB,{control:T.control,name:"password",render:e=>{let{field:s}=e;return(0,a.jsxs)(m.eI,{children:[(0,a.jsx)(m.lR,{children:"create"===X?"Senha *":"Nova Senha"}),(0,a.jsx)(m.MJ,{children:(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(d.p,{type:D?"text":"password",placeholder:"Digite a senha",...s}),(0,a.jsx)(c.$,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>S(!D),children:D?(0,a.jsx)(b.A,{className:"h-4 w-4"}):(0,a.jsx)(w.A,{className:"h-4 w-4"})})]})}),(0,a.jsx)(m.C5,{})]})}}),(0,a.jsx)(m.zB,{control:T.control,name:"confirm_password",render:e=>{let{field:s}=e;return(0,a.jsxs)(m.eI,{children:[(0,a.jsx)(m.lR,{children:"create"===X?"Confirmar Senha *":"Confirmar Nova Senha"}),(0,a.jsx)(m.MJ,{children:(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(d.p,{type:_?"text":"password",placeholder:"Confirme a senha",...s}),(0,a.jsx)(c.$,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>Q(!_),children:_?(0,a.jsx)(b.A,{className:"h-4 w-4"}):(0,a.jsx)(w.A,{className:"h-4 w-4"})})]})}),(0,a.jsx)(m.C5,{})]})}})]})})]})]})})]})}},30070:(e,s,r)=>{r.d(s,{C5:()=>v,MJ:()=>j,Rr:()=>f,eI:()=>p,lR:()=>h,lV:()=>c,zB:()=>u});var a=r(95155),l=r(12115),n=r(99708),i=r(62177),o=r(53999),t=r(82714);let c=i.Op,d=l.createContext({}),u=e=>{let{...s}=e;return(0,a.jsx)(d.Provider,{value:{name:s.name},children:(0,a.jsx)(i.xI,{...s})})},m=()=>{let e=l.useContext(d),s=l.useContext(x),{getFieldState:r,formState:a}=(0,i.xW)(),n=r(e.name,a);if(!e)throw Error("useFormField should be used within <FormField>");let{id:o}=s;return{id:o,name:e.name,formItemId:"".concat(o,"-form-item"),formDescriptionId:"".concat(o,"-form-item-description"),formMessageId:"".concat(o,"-form-item-message"),...n}},x=l.createContext({}),p=l.forwardRef((e,s)=>{let{className:r,...n}=e,i=l.useId();return(0,a.jsx)(x.Provider,{value:{id:i},children:(0,a.jsx)("div",{ref:s,className:(0,o.cn)("space-y-2",r),...n})})});p.displayName="FormItem";let h=l.forwardRef((e,s)=>{let{className:r,...l}=e,{error:n,formItemId:i}=m();return(0,a.jsx)(t.Label,{ref:s,className:(0,o.cn)(n&&"text-destructive",r),htmlFor:i,...l})});h.displayName="FormLabel";let j=l.forwardRef((e,s)=>{let{...r}=e,{error:l,formItemId:i,formDescriptionId:o,formMessageId:t}=m();return(0,a.jsx)(n.DX,{ref:s,id:i,"aria-describedby":l?"".concat(o," ").concat(t):"".concat(o),"aria-invalid":!!l,...r})});j.displayName="FormControl";let f=l.forwardRef((e,s)=>{let{className:r,...l}=e,{formDescriptionId:n}=m();return(0,a.jsx)("p",{ref:s,id:n,className:(0,o.cn)("text-sm text-muted-foreground",r),...l})});f.displayName="FormDescription";let v=l.forwardRef((e,s)=>{let{className:r,children:l,...n}=e,{error:i,formMessageId:t}=m(),c=i?String(null==i?void 0:i.message):l;return c?(0,a.jsx)("p",{ref:s,id:t,className:(0,o.cn)("text-sm font-medium text-destructive",r),...n,children:c}):null});v.displayName="FormMessage"},82714:(e,s,r)=>{r.d(s,{Label:()=>c});var a=r(95155),l=r(12115),n=r(40968),i=r(74466),o=r(53999);let t=(0,i.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),c=l.forwardRef((e,s)=>{let{className:r,...l}=e;return(0,a.jsx)(n.b,{ref:s,className:(0,o.cn)(t(),r),...l})});c.displayName=n.b.displayName},90088:(e,s,r)=>{r.d(s,{Switch:()=>o});var a=r(95155),l=r(12115),n=r(4884),i=r(53999);let o=l.forwardRef((e,s)=>{let{className:r,...l}=e;return(0,a.jsx)(n.bL,{className:(0,i.cn)("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",r),...l,ref:s,children:(0,a.jsx)(n.zi,{className:(0,i.cn)("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})})});o.displayName=n.bL.displayName},92188:(e,s,r)=>{r.d(s,{HJ:()=>l,QY:()=>a,Rx:()=>n});let a={ADMIN:"admin",DOCTOR:"doctor",NURSE:"nurse",RECEPTIONIST:"receptionist",MANAGER:"manager"},l={ACTIVE:"active",INACTIVE:"inactive",LOCKED:"locked",PENDING:"pending"},n={USER:"user",ROLE:"role",PERMISSION:"permission",MODULE:"module",SESSION:"session"}}}]);