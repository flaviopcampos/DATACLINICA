"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6580],{41524:(e,s,a)=>{a(12115),a(56671);var l=function(e){return e.CREATE="CREATE",e.READ="READ",e.UPDATE="UPDATE",e.DELETE="DELETE",e.LOGIN="LOGIN",e.LOGOUT="LOGOUT",e.EXPORT="EXPORT",e.IMPORT="IMPORT",e.BACKUP="BACKUP",e.RESTORE="RESTORE",e.PERMISSION_CHANGE="PERMISSION_CHANGE",e.SYSTEM_CONFIG="SYSTEM_CONFIG",e.DATA_ACCESS="DATA_ACCESS",e.FAILED_LOGIN="FAILED_LOGIN",e.PASSWORD_CHANGE="PASSWORD_CHANGE",e.ROLE_ASSIGNMENT="ROLE_ASSIGNMENT",e}({}),i=function(e){return e.LOW="LOW",e.MEDIUM="MEDIUM",e.HIGH="HIGH",e.CRITICAL="CRITICAL",e}({}),t=function(e){return e.AUTHENTICATION="AUTHENTICATION",e.AUTHORIZATION="AUTHORIZATION",e.DATA_MODIFICATION="DATA_MODIFICATION",e.SYSTEM_ADMINISTRATION="SYSTEM_ADMINISTRATION",e.DATA_EXPORT="DATA_EXPORT",e.SECURITY_INCIDENT="SECURITY_INCIDENT",e.COMPLIANCE="COMPLIANCE",e.BACKUP_RESTORE="BACKUP_RESTORE",e.USER_MANAGEMENT="USER_MANAGEMENT",e.CONFIGURATION="CONFIGURATION",e}({}),r=function(e){return e.SUCCESS="SUCCESS",e.FAILURE="FAILURE",e.WARNING="WARNING",e.BLOCKED="BLOCKED",e}({});l.READ,t.DATA_MODIFICATION,i.MEDIUM,r.SUCCESS,l.PERMISSION_CHANGE,t.SYSTEM_ADMINISTRATION,i.HIGH,r.SUCCESS,t.AUTHENTICATION,t.AUTHORIZATION,t.DATA_MODIFICATION,t.SYSTEM_ADMINISTRATION,t.DATA_EXPORT,t.SECURITY_INCIDENT,t.COMPLIANCE,t.BACKUP_RESTORE,t.USER_MANAGEMENT,t.CONFIGURATION,i.LOW,i.MEDIUM,i.HIGH,i.CRITICAL,r.SUCCESS,r.FAILURE,r.WARNING,r.BLOCKED,i.LOW,i.MEDIUM,i.HIGH,i.CRITICAL,t.AUTHENTICATION,t.AUTHORIZATION,t.DATA_MODIFICATION,t.SYSTEM_ADMINISTRATION,t.DATA_EXPORT,t.SECURITY_INCIDENT,t.COMPLIANCE,t.BACKUP_RESTORE,t.USER_MANAGEMENT,t.CONFIGURATION},76580:(e,s,a)=>{a.d(s,{Nz:()=>H.N,qu:()=>i.q,Y_:()=>y,qY:()=>l.q,pE:()=>G.p});var l=a(3803),i=a(64483),t=a(95155),r=a(12115),d=a(97168);a(89852),a(95784);var c=a(88145),n=a(88482);a(67133);var x=a(92188),m=a(92275),o=a(99840),N=a(34964),u=a(69663),h=a(17951),A=a(33917),j=a(51976),I=a(55670),T=a(75525),E=a(32919),f=a(40646),p=a(54861),v=a(13717),g=a(71007),C=a(79397),O=a(57434),_=a(1243),S=a(28883),R=a(19420),D=a(4516),U=a(69074),b=a(14186),M=a(53999),w=a(41524),L=a(56671);function y(e){let{user:s,mode:a,open:i,onOpenChange:y,onSave:G,loading:H=!1}=e,[P,Y]=(0,r.useState)(a),[F,B]=(0,r.useState)("details");(0,r.useEffect)(()=>{Y(a),B("details")},[a,s,i]);let{data:W,isLoading:Z}=(0,w.useUserAuditLogs)((null==s?void 0:s.id)||"",{enabled:!!(null==s?void 0:s.id)&&i&&"audit"===F}),q=async e=>{try{await (null==G?void 0:G(e)),Y("view"),L.o.success("create"===a?"Usu\xe1rio criado com sucesso!":"Usu\xe1rio atualizado com sucesso!")}catch(e){L.o.error("create"===a?"Erro ao criar usu\xe1rio":"Erro ao atualizar usu\xe1rio")}},k=(null==s?void 0:s.locked_until)&&new Date(s.locked_until)>new Date,K=(null==s?void 0:s.failed_login_attempts)&&s.failed_login_attempts>0;return(0,t.jsx)(o.lG,{open:i,onOpenChange:y,children:(0,t.jsxs)(o.Cf,{className:"max-w-4xl max-h-[90vh] overflow-hidden",children:[(0,t.jsx)(o.c7,{children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(o.L3,{className:"text-xl",children:"create"===a?"Novo Usu\xe1rio":"edit"===P?"Editar Usu\xe1rio":"Detalhes do Usu\xe1rio"}),(0,t.jsx)(o.rr,{children:"create"===a?"Preencha as informa\xe7\xf5es para criar um novo usu\xe1rio.":"edit"===P?"Edite as informa\xe7\xf5es do usu\xe1rio.":"Visualize e gerencie as informa\xe7\xf5es do usu\xe1rio."})]}),s&&"view"===P&&(0,t.jsxs)(d.$,{variant:"outline",size:"sm",onClick:()=>Y("edit"),children:[(0,t.jsx)(v.A,{className:"mr-2 h-4 w-4"}),"Editar"]})]})}),(0,t.jsx)("div",{className:"flex-1 overflow-hidden",children:"edit"===P||"create"===a?(0,t.jsx)("div",{className:"space-y-6",children:(0,t.jsx)(l.q,{user:s,onSubmit:q,onCancel:()=>{"create"===a?y(!1):Y("view")},loading:H,mode:a})}):s?(0,t.jsxs)(N.Tabs,{value:F,onValueChange:B,className:"h-full",children:[(0,t.jsxs)(N.TabsList,{className:"grid w-full grid-cols-3",children:[(0,t.jsxs)(N.TabsTrigger,{value:"details",className:"flex items-center gap-2",children:[(0,t.jsx)(g.A,{className:"h-4 w-4"}),"Detalhes"]}),(0,t.jsxs)(N.TabsTrigger,{value:"activity",className:"flex items-center gap-2",children:[(0,t.jsx)(C.A,{className:"h-4 w-4"}),"Atividade"]}),(0,t.jsxs)(N.TabsTrigger,{value:"audit",className:"flex items-center gap-2",children:[(0,t.jsx)(O.A,{className:"h-4 w-4"}),"Auditoria"]})]}),(0,t.jsxs)("div",{className:"mt-6 overflow-y-auto max-h-[60vh]",children:[(0,t.jsxs)(N.TabsContent,{value:"details",className:"space-y-6",children:[(0,t.jsx)(n.Zp,{children:(0,t.jsx)(n.Wu,{className:"p-6",children:(0,t.jsxs)("div",{className:"flex items-start space-x-6",children:[(0,t.jsxs)(u.Avatar,{className:"h-20 w-20",children:[(0,t.jsx)(u.AvatarImage,{src:s.avatar_url,alt:s.full_name}),(0,t.jsx)(u.AvatarFallback,{className:"bg-primary/10 text-xl",children:s.full_name.split(" ").map(e=>e[0]).join("").toUpperCase().slice(0,2)})]}),(0,t.jsxs)("div",{className:"flex-1 space-y-3",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-2xl font-bold",children:s.full_name}),(0,t.jsxs)("p",{className:"text-muted-foreground text-lg",children:["@",s.username]})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(()=>{var e;let a=(e=s.role,({[x.QY.ADMIN]:h.A,[x.QY.DOCTOR]:A.A,[x.QY.NURSE]:j.A,[x.QY.RECEPTIONIST]:I.A})[e]||T.A);return(0,t.jsx)(a,{className:"h-4 w-4"})})(),(0,t.jsx)(m.b,{roles:[s.role],size:"md"})]}),(0,t.jsx)("div",{className:"flex items-center space-x-2",children:(()=>{var e,a,l;let i=(e=s.is_active?"active":"inactive",k?E.A:({[x.HJ.ACTIVE]:f.A,[x.HJ.INACTIVE]:p.A})[e]||p.A);return(0,t.jsxs)(c.E,{className:(a=s.is_active?"active":"inactive",k?"bg-red-100 text-red-800 border-red-200":({[x.HJ.ACTIVE]:"bg-green-100 text-green-800 border-green-200",[x.HJ.INACTIVE]:"bg-gray-100 text-gray-800 border-gray-200"})[a]||"bg-gray-100 text-gray-800 border-gray-200"),children:[(0,t.jsx)(i,{className:"mr-1 h-3 w-3"}),(l=s.is_active?"active":"inactive",k?"Bloqueado":({[x.HJ.ACTIVE]:"Ativo",[x.HJ.INACTIVE]:"Inativo"})[l]||l)]})})()})]}),(K||k)&&(0,t.jsxs)("div",{className:"flex items-center space-x-2 p-3 bg-amber-50 border border-amber-200 rounded-md",children:[(0,t.jsx)(_.A,{className:"h-4 w-4 text-amber-600"}),(0,t.jsx)("span",{className:"text-sm text-amber-800",children:k?"Conta bloqueada at\xe9 ".concat((0,M.Yq)(s.locked_until)):"".concat(s.failed_login_attempts," tentativas de login falharam")})]})]})]})})}),(0,t.jsxs)(n.Zp,{children:[(0,t.jsx)(n.aR,{children:(0,t.jsxs)(n.ZB,{className:"flex items-center gap-2",children:[(0,t.jsx)(S.A,{className:"h-5 w-5"}),"Informa\xe7\xf5es de Contato"]})}),(0,t.jsx)(n.Wu,{className:"space-y-4",children:(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)(S.A,{className:"h-4 w-4 text-muted-foreground"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Email"}),(0,t.jsx)("p",{className:"font-medium",children:s.email})]})]}),s.phone&&(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)(R.A,{className:"h-4 w-4 text-muted-foreground"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Telefone"}),(0,t.jsx)("p",{className:"font-medium",children:s.phone})]})]}),s.cpf&&(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)(g.A,{className:"h-4 w-4 text-muted-foreground"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"CPF"}),(0,t.jsx)("p",{className:"font-medium",children:s.cpf})]})]}),s.clinic_id&&(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)(D.A,{className:"h-4 w-4 text-muted-foreground"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Cl\xednica"}),(0,t.jsx)("p",{className:"font-medium",children:s.clinic_id})]})]})]})})]}),(s.professional_license||s.specialty)&&(0,t.jsxs)(n.Zp,{children:[(0,t.jsx)(n.aR,{children:(0,t.jsxs)(n.ZB,{className:"flex items-center gap-2",children:[(0,t.jsx)(A.A,{className:"h-5 w-5"}),"Informa\xe7\xf5es Profissionais"]})}),(0,t.jsx)(n.Wu,{className:"space-y-4",children:(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.professional_license&&(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Registro Profissional"}),(0,t.jsx)("p",{className:"font-medium",children:s.professional_license})]}),s.specialty&&(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Especialidade"}),(0,t.jsx)("p",{className:"font-medium",children:s.specialty})]})]})})]}),(0,t.jsxs)(n.Zp,{children:[(0,t.jsx)(n.aR,{children:(0,t.jsxs)(n.ZB,{className:"flex items-center gap-2",children:[(0,t.jsx)(U.A,{className:"h-5 w-5"}),"Informa\xe7\xf5es do Sistema"]})}),(0,t.jsx)(n.Wu,{className:"space-y-4",children:(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)(U.A,{className:"h-4 w-4 text-muted-foreground"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Criado em"}),(0,t.jsx)("p",{className:"font-medium",children:(0,M.Yq)(s.created_at)})]})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)(U.A,{className:"h-4 w-4 text-muted-foreground"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Atualizado em"}),(0,t.jsx)("p",{className:"font-medium",children:(0,M.Yq)(s.updated_at)})]})]}),s.last_login&&(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)(b.A,{className:"h-4 w-4 text-muted-foreground"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"\xdaltimo acesso"}),(0,t.jsx)("p",{className:"font-medium",children:(0,M.Yq)(s.last_login)})]})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)(g.A,{className:"h-4 w-4 text-muted-foreground"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"ID do usu\xe1rio"}),(0,t.jsx)("p",{className:"font-medium font-mono text-xs",children:s.id})]})]})]})})]})]}),(0,t.jsx)(N.TabsContent,{value:"activity",className:"space-y-4",children:(0,t.jsxs)(n.Zp,{children:[(0,t.jsxs)(n.aR,{children:[(0,t.jsx)(n.ZB,{children:"Atividade Recente"}),(0,t.jsx)(n.BT,{children:"\xdaltimas atividades e estat\xedsticas do usu\xe1rio"})]}),(0,t.jsx)(n.Wu,{children:(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,t.jsxs)("div",{className:"text-center p-4 border rounded-lg",children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-blue-600",children:s.failed_login_attempts||0}),(0,t.jsx)("div",{className:"text-sm text-muted-foreground",children:"Tentativas Falharam"})]}),(0,t.jsxs)("div",{className:"text-center p-4 border rounded-lg",children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-green-600",children:s.last_login?"1":"0"}),(0,t.jsx)("div",{className:"text-sm text-muted-foreground",children:"Sess\xf5es Ativas"})]}),(0,t.jsxs)("div",{className:"text-center p-4 border rounded-lg",children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-purple-600",children:Math.floor((new Date().getTime()-new Date(s.created_at).getTime())/864e5)}),(0,t.jsx)("div",{className:"text-sm text-muted-foreground",children:"Dias no Sistema"})]})]})})]})}),(0,t.jsx)(N.TabsContent,{value:"audit",className:"space-y-4",children:(0,t.jsxs)(n.Zp,{children:[(0,t.jsxs)(n.aR,{children:[(0,t.jsx)(n.ZB,{children:"Log de Auditoria"}),(0,t.jsx)(n.BT,{children:"Hist\xf3rico de a\xe7\xf5es realizadas pelo usu\xe1rio"})]}),(0,t.jsx)(n.Wu,{children:Z?(0,t.jsx)("div",{className:"space-y-3",children:Array.from({length:5}).map((e,s)=>(0,t.jsxs)("div",{className:"animate-pulse",children:[(0,t.jsx)("div",{className:"h-4 bg-muted rounded w-3/4 mb-2"}),(0,t.jsx)("div",{className:"h-3 bg-muted rounded w-1/2"})]},s))}):W&&W.length>0?(0,t.jsx)("div",{className:"space-y-4",children:W.slice(0,10).map(e=>(0,t.jsxs)("div",{className:"flex items-start space-x-3 p-3 border rounded-lg",children:[(0,t.jsx)("div",{className:"h-2 w-2 bg-blue-500 rounded-full mt-2"}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("p",{className:"font-medium",children:e.action}),(0,t.jsx)("span",{className:"text-xs text-muted-foreground",children:(0,M.Yq)(e.created_at)})]}),e.resource_type&&(0,t.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Recurso: ",e.resource_type,e.resource_id&&" (".concat(e.resource_id,")")]}),e.details&&(0,t.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:"string"==typeof e.details?e.details:JSON.stringify(e.details)})]})]},e.id))}):(0,t.jsxs)("div",{className:"text-center py-8",children:[(0,t.jsx)(O.A,{className:"mx-auto h-12 w-12 text-muted-foreground mb-4"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"Nenhum log de auditoria encontrado"})]})})]})})]})]}):null})]})})}var G=a(45654),H=a(93150)}}]);