"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9235],{49026:(e,a,s)=>{s.d(a,{Fc:()=>d,TN:()=>n});var c=s(95155),t=s(12115),l=s(74466),r=s(53999);let i=(0,l.F)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),d=t.forwardRef((e,a)=>{let{className:s,variant:t,...l}=e;return(0,c.jsx)("div",{ref:a,role:"alert",className:(0,r.cn)(i({variant:t}),s),...l})});d.displayName="Alert",t.forwardRef((e,a)=>{let{className:s,...t}=e;return(0,c.jsx)("h5",{ref:a,className:(0,r.cn)("mb-1 font-medium leading-none tracking-tight",s),...t})}).displayName="AlertTitle";let n=t.forwardRef((e,a)=>{let{className:s,...t}=e;return(0,c.jsx)("div",{ref:a,className:(0,r.cn)("text-sm [&_p]:leading-relaxed",s),...t})});n.displayName="AlertDescription"},69235:(e,a,s)=>{s.d(a,{l:()=>w});var c=s(95155),t=s(12115),l=s(31857),r=s(75525),i=s(46767),d=s(78749),n=s(92657),o=s(24357),u=s(91788),m=s(97168),x=s(88482),p=s(89852),g=s(82714),f=s(49026),h=s(88145),j=s(76037),v=s(56671),b=s(31814),N=s(95954);function w(e){let{onComplete:a,onCancel:s}=e,{setupTwoFactor:w}=(0,b.NL)(),[y,k]=(0,t.useState)("method"),[C,A]=(0,t.useState)("totp"),[R,_]=(0,t.useState)(null),[S,B]=(0,t.useState)(""),[L,T]=(0,t.useState)(!1),[F,D]=(0,t.useState)(!1),[E,$]=(0,t.useState)(!1),O=async e=>{A(e),T(!0);try{let a=await w({method:e});_(a),k("setup")}catch(e){}finally{T(!1)}},Z=async()=>{if(!S.trim())return void v.o.error("Digite o c\xf3digo de verifica\xe7\xe3o");T(!0);try{await N.Z.confirmSetup(S),k("backup"),v.o.success("2FA configurado com sucesso!")}catch(e){v.o.error(e.message)}finally{T(!1)}},z=(e,a)=>{navigator.clipboard.writeText(e),v.o.success("".concat(a," copiado para a \xe1rea de transfer\xeancia"))};return"method"===y?(0,c.jsxs)(x.Zp,{className:"w-full max-w-md mx-auto",children:[(0,c.jsxs)(x.aR,{className:"text-center",children:[(0,c.jsx)("div",{className:"mx-auto mb-4 p-3 bg-blue-100 rounded-full w-fit",children:(0,c.jsx)(r.A,{className:"h-8 w-8 text-blue-600"})}),(0,c.jsx)(x.ZB,{children:"Configurar Autentica\xe7\xe3o 2FA"}),(0,c.jsx)(x.BT,{children:"Adicione uma camada extra de seguran\xe7a \xe0 sua conta"})]}),(0,c.jsxs)(x.Wu,{className:"space-y-4",children:[(0,c.jsx)("div",{className:"space-y-3",children:(0,c.jsxs)(m.$,{variant:"outline",className:"w-full h-auto p-4 justify-start",onClick:()=>O("totp"),disabled:L,children:[(0,c.jsx)(i.A,{className:"h-5 w-5 mr-3"}),(0,c.jsxs)("div",{className:"text-left",children:[(0,c.jsx)("div",{className:"font-medium",children:"App Autenticador"}),(0,c.jsx)("div",{className:"text-sm text-muted-foreground",children:"Google Authenticator, Authy, etc."})]})]})}),(0,c.jsx)("div",{className:"flex gap-2",children:(0,c.jsx)(m.$,{variant:"outline",onClick:s,className:"flex-1",children:"Cancelar"})})]})]}):"setup"===y&&R?(0,c.jsxs)(x.Zp,{className:"w-full max-w-lg mx-auto",children:[(0,c.jsxs)(x.aR,{className:"text-center",children:[(0,c.jsx)(x.ZB,{children:"Configurar App Autenticador"}),(0,c.jsx)(x.BT,{children:"Escaneie o QR Code ou digite a chave manualmente"})]}),(0,c.jsxs)(x.Wu,{className:"space-y-6",children:[(0,c.jsxs)("div",{className:"flex flex-col items-center space-y-4",children:[(0,c.jsx)("div",{className:"p-4 bg-white rounded-lg border",children:(0,c.jsx)(l.h,{value:R.qr_code_url,size:200,level:"M",includeMargin:!0})}),(0,c.jsx)("p",{className:"text-sm text-muted-foreground text-center",children:"Escaneie este c\xf3digo com seu app autenticador"})]}),(0,c.jsx)(j.Separator,{}),(0,c.jsxs)("div",{className:"space-y-2",children:[(0,c.jsx)(g.Label,{children:"Ou digite a chave manualmente:"}),(0,c.jsxs)("div",{className:"flex gap-2",children:[(0,c.jsx)(p.p,{value:F?R.manual_entry_key:"••••••••••••••••",readOnly:!0,className:"font-mono text-sm"}),(0,c.jsx)(m.$,{variant:"outline",size:"icon",onClick:()=>D(!F),children:F?(0,c.jsx)(d.A,{className:"h-4 w-4"}):(0,c.jsx)(n.A,{className:"h-4 w-4"})}),(0,c.jsx)(m.$,{variant:"outline",size:"icon",onClick:()=>z(R.manual_entry_key,"Chave"),children:(0,c.jsx)(o.A,{className:"h-4 w-4"})})]})]}),(0,c.jsx)(j.Separator,{}),(0,c.jsxs)("div",{className:"space-y-4",children:[(0,c.jsxs)("div",{className:"space-y-2",children:[(0,c.jsx)(g.Label,{htmlFor:"verification-code",children:"Digite o c\xf3digo do seu app autenticador:"}),(0,c.jsx)(p.p,{id:"verification-code",value:S,onChange:e=>B(e.target.value.replace(/\D/g,"").slice(0,6)),placeholder:"000000",className:"text-center text-lg font-mono tracking-widest",maxLength:6})]}),(0,c.jsx)(f.Fc,{children:(0,c.jsx)(f.TN,{children:"O c\xf3digo muda a cada 30 segundos. Digite o c\xf3digo atual exibido no seu app."})})]}),(0,c.jsxs)("div",{className:"flex gap-2",children:[(0,c.jsx)(m.$,{variant:"outline",onClick:()=>k("method"),className:"flex-1",children:"Voltar"}),(0,c.jsx)(m.$,{onClick:Z,disabled:L||6!==S.length,className:"flex-1",children:L?"Verificando...":"Verificar"})]})]})]}):"backup"===y&&R?(0,c.jsxs)(x.Zp,{className:"w-full max-w-lg mx-auto",children:[(0,c.jsxs)(x.aR,{className:"text-center",children:[(0,c.jsx)(x.ZB,{className:"text-green-600",children:"2FA Configurado!"}),(0,c.jsx)(x.BT,{children:"Salve seus c\xf3digos de backup em local seguro"})]}),(0,c.jsxs)(x.Wu,{className:"space-y-6",children:[(0,c.jsx)(f.Fc,{children:(0,c.jsxs)(f.TN,{children:[(0,c.jsx)("strong",{children:"Importante:"})," Estes c\xf3digos de backup podem ser usados para acessar sua conta se voc\xea perder acesso ao seu app autenticador. Cada c\xf3digo pode ser usado apenas uma vez."]})}),(0,c.jsxs)("div",{className:"space-y-3",children:[(0,c.jsxs)("div",{className:"flex items-center justify-between",children:[(0,c.jsx)(g.Label,{children:"C\xf3digos de Backup:"}),(0,c.jsxs)(h.E,{variant:"secondary",children:[R.backup_codes.length," c\xf3digos"]})]}),(0,c.jsx)("div",{className:"grid grid-cols-2 gap-2 p-4 bg-muted rounded-lg font-mono text-sm",children:R.backup_codes.map((e,a)=>(0,c.jsxs)("div",{className:"flex items-center justify-between p-2 bg-background rounded border",children:[(0,c.jsx)("span",{children:e}),(0,c.jsx)(m.$,{variant:"ghost",size:"sm",onClick:()=>z(e,"C\xf3digo ".concat(a+1)),children:(0,c.jsx)(o.A,{className:"h-3 w-3"})})]},a))})]}),(0,c.jsxs)(m.$,{variant:"outline",onClick:()=>{if(!(null==R?void 0:R.backup_codes))return;let e=new Blob([["C\xd3DIGOS DE BACKUP - DATACLINICA 2FA","=====================================","","IMPORTANTE: Guarde estes c\xf3digos em local seguro!","Cada c\xf3digo pode ser usado apenas uma vez.","",...R.backup_codes.map((e,a)=>"".concat(a+1,". ").concat(e)),"","Gerado em: ".concat(new Date().toLocaleString("pt-BR"))].join("\n")],{type:"text/plain"}),a=URL.createObjectURL(e),s=document.createElement("a");s.href=a,s.download="dataclinica-2fa-backup-codes-".concat(Date.now(),".txt"),document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(a),$(!0),v.o.success("C\xf3digos de backup baixados com sucesso!")},className:"w-full",children:[(0,c.jsx)(u.A,{className:"h-4 w-4 mr-2"}),"Baixar C\xf3digos de Backup"]}),E&&(0,c.jsx)(f.Fc,{children:(0,c.jsx)(f.TN,{className:"text-green-600",children:"✓ C\xf3digos de backup salvos com sucesso!"})}),(0,c.jsx)(m.$,{onClick:()=>{if(!E)return void v.o.error("Por favor, salve os c\xf3digos de backup antes de continuar");null==a||a()},disabled:!E,className:"w-full",children:"Concluir Configura\xe7\xe3o"})]})]}):null}},82714:(e,a,s)=>{s.d(a,{Label:()=>n});var c=s(95155),t=s(12115),l=s(40968),r=s(74466),i=s(53999);let d=(0,r.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),n=t.forwardRef((e,a)=>{let{className:s,...t}=e;return(0,c.jsx)(l.b,{ref:a,className:(0,i.cn)(d(),s),...t})});n.displayName=l.b.displayName},89852:(e,a,s)=>{s.d(a,{p:()=>r});var c=s(95155),t=s(12115),l=s(53999);let r=t.forwardRef((e,a)=>{let{className:s,type:t,...r}=e;return(0,c.jsx)("input",{type:t,className:(0,l.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",s),ref:a,...r})});r.displayName="Input"}}]);