"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8187],{16559:(e,a,s)=>{s.d(a,{$v:()=>j,EO:()=>m,Lt:()=>n,Rx:()=>g,Zr:()=>N,ck:()=>u,r7:()=>f,tv:()=>c,wd:()=>h});var t=s(95155),l=s(12115),d=s(17649),r=s(53999),i=s(97168);let n=d.bL,c=d.l9,o=d.ZL,x=l.forwardRef((e,a)=>{let{className:s,...l}=e;return(0,t.jsx)(d.hJ,{className:(0,r.cn)("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...l,ref:a})});x.displayName=d.hJ.displayName;let m=l.forwardRef((e,a)=>{let{className:s,...l}=e;return(0,t.jsxs)(o,{children:[(0,t.jsx)(x,{}),(0,t.jsx)(d.UC,{ref:a,className:(0,r.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",s),...l})]})});m.displayName=d.UC.displayName;let h=e=>{let{className:a,...s}=e;return(0,t.jsx)("div",{className:(0,r.cn)("flex flex-col space-y-2 text-center sm:text-left",a),...s})};h.displayName="AlertDialogHeader";let u=e=>{let{className:a,...s}=e;return(0,t.jsx)("div",{className:(0,r.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",a),...s})};u.displayName="AlertDialogFooter";let f=l.forwardRef((e,a)=>{let{className:s,...l}=e;return(0,t.jsx)(d.hE,{ref:a,className:(0,r.cn)("text-lg font-semibold",s),...l})});f.displayName=d.hE.displayName;let j=l.forwardRef((e,a)=>{let{className:s,...l}=e;return(0,t.jsx)(d.VY,{ref:a,className:(0,r.cn)("text-sm text-muted-foreground",s),...l})});j.displayName=d.VY.displayName;let g=l.forwardRef((e,a)=>{let{className:s,variant:l,size:n,...c}=e;return(0,t.jsx)(d.rc,{ref:a,className:(0,r.cn)((0,i.r)({variant:l,size:n}),s),...c})});g.displayName=d.rc.displayName;let N=l.forwardRef((e,a)=>{let{className:s,variant:l="outline",size:n,...c}=e;return(0,t.jsx)(d.ZD,{ref:a,className:(0,r.cn)((0,i.r)({variant:l,size:n}),"mt-2 sm:mt-0",s),...c})});N.displayName=d.ZD.displayName},18187:(e,a,s)=>{s.d(a,{TwoFactorStatus:()=>b});var t=s(95155),l=s(12115),d=s(88145),r=s(97168),i=s(88482),n=s(76037),c=s(16559),o=s(75525),x=s(69803),m=s(1243),h=s(46767),u=s(14186),f=s(6874),j=s.n(f),g=s(31814),N=s(63008),p=s(4573);function b(e){let{className:a}=e,{config:s,isLoading:f,disable2FA:b,generateBackupCodes:y,getTrustedDevices:v,getAuthLogs:w}=(0,g.NL)(),[k,C]=(0,l.useState)(!1),[A,D]=(0,l.useState)(!1),[F,S]=(0,l.useState)(0),[z,R]=(0,l.useState)(null);(0,l.useEffect)(()=>{(null==s?void 0:s.enabled)&&(v().then(e=>{S(e.length)}),w({limit:1,action:"LOGIN_SUCCESS"}).then(e=>{e.length>0&&R(new Date(e[0].created_at))}))},[s,v,w]);let E=async()=>{C(!0);try{await b(),D(!1)}catch(e){}finally{C(!1)}};return f?(0,t.jsx)(i.Zp,{className:a,children:(0,t.jsx)(i.Wu,{className:"pt-6",children:(0,t.jsxs)("div",{className:"animate-pulse space-y-4",children:[(0,t.jsx)("div",{className:"h-4 bg-gray-200 rounded w-3/4"}),(0,t.jsx)("div",{className:"h-4 bg-gray-200 rounded w-1/2"})]})})}):(0,t.jsxs)(i.Zp,{className:a,children:[(0,t.jsxs)(i.aR,{children:[(0,t.jsxs)(i.ZB,{className:"flex items-center gap-2",children:[(0,t.jsx)(o.A,{className:"h-5 w-5"}),"Autentica\xe7\xe3o de Dois Fatores (2FA)"]}),(0,t.jsx)(i.BT,{children:(null==s?void 0:s.enabled)?"Sua conta est\xe1 protegida com autentica\xe7\xe3o de dois fatores":"Adicione uma camada extra de seguran\xe7a \xe0 sua conta"})]}),(0,t.jsxs)(i.Wu,{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"space-y-1",children:[(0,t.jsxs)("h3",{className:"font-medium flex items-center gap-2",children:[(0,t.jsx)(x.A,{className:"h-4 w-4"}),"Status do 2FA"]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(d.E,{variant:(null==s?void 0:s.enabled)?"default":"outline",className:(null==s?void 0:s.enabled)?"text-green-600 bg-green-50 border-green-600":"text-red-600 border-red-600",children:(null==s?void 0:s.enabled)?"Habilitado":"Desabilitado"}),(null==s?void 0:s.enabled)&&(0,t.jsxs)("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:["desde ",(0,N.GP)(new Date(s.created_at),"dd/MM/yyyy",{locale:p.F})]})]})]}),(0,t.jsx)("div",{className:"flex items-center gap-2",children:(null==s?void 0:s.enabled)?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(r.$,{variant:"outline",size:"sm",asChild:!0,children:(0,t.jsx)(j(),{href:"/dashboard/security/2fa",children:"Gerenciar"})}),(0,t.jsxs)(c.Lt,{open:A,onOpenChange:D,children:[(0,t.jsx)(c.tv,{asChild:!0,children:(0,t.jsx)(r.$,{variant:"outline",size:"sm",className:"text-red-600 border-red-600 hover:bg-red-50",children:"Desabilitar"})}),(0,t.jsxs)(c.EO,{children:[(0,t.jsxs)(c.wd,{children:[(0,t.jsxs)(c.r7,{className:"flex items-center gap-2",children:[(0,t.jsx)(m.A,{className:"h-5 w-5 text-red-600"}),"Desabilitar Autentica\xe7\xe3o 2FA"]}),(0,t.jsx)(c.$v,{children:"Tem certeza que deseja desabilitar a autentica\xe7\xe3o de dois fatores? Isso tornar\xe1 sua conta menos segura."})]}),(0,t.jsxs)(c.ck,{children:[(0,t.jsx)(c.Zr,{children:"Cancelar"}),(0,t.jsx)(c.Rx,{onClick:E,disabled:k,className:"bg-red-600 hover:bg-red-700",children:k?"Desabilitando...":"Desabilitar 2FA"})]})]})]})]}):(0,t.jsx)(r.$,{asChild:!0,children:(0,t.jsx)(j(),{href:"/auth/2fa/setup",children:"Configurar 2FA"})})})]}),(null==s?void 0:s.enabled)&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.Separator,{}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,t.jsxs)("div",{className:"text-center p-4 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[(0,t.jsx)(h.A,{className:"h-6 w-6 mx-auto mb-2 text-blue-600"}),(0,t.jsx)("div",{className:"text-2xl font-bold",children:F}),(0,t.jsx)("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Dispositivos Confi\xe1veis"})]}),(0,t.jsxs)("div",{className:"text-center p-4 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[(0,t.jsx)(o.A,{className:"h-6 w-6 mx-auto mb-2 text-green-600"}),(0,t.jsx)("div",{className:"text-2xl font-bold",children:s.backup_codes_count||0}),(0,t.jsx)("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"C\xf3digos de Backup"})]}),(0,t.jsxs)("div",{className:"text-center p-4 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[(0,t.jsx)(u.A,{className:"h-6 w-6 mx-auto mb-2 text-purple-600"}),(0,t.jsx)("div",{className:"text-sm font-medium",children:z?(0,N.GP)(z,"dd/MM HH:mm",{locale:p.F}):"N/A"}),(0,t.jsx)("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"\xdaltimo Login"})]})]}),(0,t.jsx)(n.Separator,{}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)("h4",{className:"font-medium text-sm text-gray-900 dark:text-white",children:"A\xe7\xf5es R\xe1pidas"}),(0,t.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,t.jsx)(r.$,{variant:"outline",size:"sm",asChild:!0,children:(0,t.jsx)(j(),{href:"/dashboard/security/2fa",children:"Ver Dispositivos"})}),(0,t.jsx)(r.$,{variant:"outline",size:"sm",onClick:()=>y(),children:"Gerar Novos C\xf3digos"}),(0,t.jsx)(r.$,{variant:"outline",size:"sm",asChild:!0,children:(0,t.jsx)(j(),{href:"/dashboard/security/2fa",children:"Ver Logs"})})]})]})]})]})]})}}}]);