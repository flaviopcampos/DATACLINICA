"use strict";exports.id=9229,exports.ids=[9229],exports.modules={3560:(a,b,c)=>{c.d(b,{Z:()=>f});var d=c(64298);class e{async getConfig(){try{return(await d.F.get(`${this.baseUrl}/config`)).data}catch(a){if(a.response?.status===404)return null;throw Error(a.response?.data?.message||"Erro ao obter configura\xe7\xe3o 2FA")}}async setupTwoFactor(a){try{return(await d.F.post(`${this.baseUrl}/setup`,a)).data}catch(a){throw Error(a.response?.data?.message||"Erro ao configurar 2FA")}}async confirmSetup(a){try{return(await d.F.post(`${this.baseUrl}/confirm-setup`,{code:a})).data}catch(a){throw Error(a.response?.data?.message||"C\xf3digo inv\xe1lido")}}async verifyTwoFactor(a){try{return(await d.F.post(`${this.baseUrl}/verify`,a)).data}catch(a){throw Error(a.response?.data?.message||"C\xf3digo inv\xe1lido")}}async disableTwoFactor(a){try{await d.F.post(`${this.baseUrl}/disable`,a)}catch(a){throw Error(a.response?.data?.message||"Erro ao desabilitar 2FA")}}async regenerateBackupCodes(){try{return(await d.F.post(`${this.baseUrl}/regenerate-backup-codes`)).data.backup_codes}catch(a){throw Error(a.response?.data?.message||"Erro ao regenerar c\xf3digos de backup")}}async getTrustedDevices(){try{return(await d.F.get(`${this.baseUrl}/trusted-devices`)).data}catch(a){throw Error(a.response?.data?.message||"Erro ao obter dispositivos confi\xe1veis")}}async removeTrustedDevice(a){try{await d.F.delete(`${this.baseUrl}/trusted-devices/${a}`)}catch(a){throw Error(a.response?.data?.message||"Erro ao remover dispositivo")}}async getAuthLogs(a=50){try{return(await d.F.get(`${this.baseUrl}/auth-logs`,{params:{limit:a}})).data}catch(a){throw Error(a.response?.data?.message||"Erro ao obter logs de autentica\xe7\xe3o")}}async getStats(){try{return(await d.F.get(`${this.baseUrl}/stats`)).data}catch(a){throw Error(a.response?.data?.message||"Erro ao obter estat\xedsticas")}}async checkTrustedDevice(a){try{return(await d.F.post(`${this.baseUrl}/check-trusted-device`,{device_fingerprint:a})).data.is_trusted}catch(a){return!1}}generateDeviceFingerprint(){let a=document.createElement("canvas"),b=a.getContext("2d");b&&(b.textBaseline="top",b.font="14px Arial",b.fillText("Device fingerprint",2,2));let c=[navigator.userAgent,navigator.language,screen.width+"x"+screen.height,new Date().getTimezoneOffset(),a.toDataURL(),navigator.hardwareConcurrency||0,navigator.deviceMemory||0].join("|"),d=0;for(let a=0;a<c.length;a++)d=(d<<5)-d+c.charCodeAt(a),d&=d;return Math.abs(d).toString(36)}getCurrentDeviceInfo(){let a=navigator.userAgent,b="Dispositivo Desconhecido";return b=/Mobile|Android|iPhone|iPad/.test(a)?/iPhone/.test(a)?"iPhone":/iPad/.test(a)?"iPad":/Android/.test(a)?"Android":"Mobile":/Windows/.test(a)?"Windows PC":/Mac/.test(a)?"Mac":/Linux/.test(a)?"Linux":"Desktop",/Chrome/.test(a)?b+=" - Chrome":/Firefox/.test(a)?b+=" - Firefox":/Safari/.test(a)?b+=" - Safari":/Edge/.test(a)&&(b+=" - Edge"),{name:b,fingerprint:this.generateDeviceFingerprint(),userAgent:a}}constructor(){this.baseUrl="/auth/2fa"}}let f=new e},17581:(a,b,c)=>{c.d(b,{A:()=>d});let d=(0,c(62688).A)("smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]])},19959:(a,b,c)=>{c.d(b,{A:()=>d});let d=(0,c(62688).A)("key",[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]])},20747:(a,b,c)=>{c.d(b,{TwoFactorStatus:()=>d});let d=(0,c(61369).registerClientReference)(function(){throw Error("Attempted to call TwoFactorStatus() from the server but TwoFactorStatus is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\flavi\\Documents\\Softwares\\DATACLINICA\\frontend\\src\\components\\profile\\TwoFactorStatus.tsx","TwoFactorStatus")},22977:(a,b,c)=>{c.d(b,{TwoFactorStatus:()=>u});var d=c(60687),e=c(43210),f=c(59821),g=c(24934),h=c(55192),i=c(78377),j=c(95033),k=c(99891),l=c(19959),m=c(43649),n=c(17581),o=c(48730),p=c(85814),q=c.n(p),r=c(81198),s=c(85650),t=c(882);function u({className:a}){let{config:b,isLoading:c,disable2FA:p,generateBackupCodes:u,getTrustedDevices:v,getAuthLogs:w}=(0,r.NL)(),[x,y]=(0,e.useState)(!1),[z,A]=(0,e.useState)(!1),[B,C]=(0,e.useState)(0),[D,E]=(0,e.useState)(null),F=async()=>{y(!0);try{await p(),A(!1)}catch(a){}finally{y(!1)}};return c?(0,d.jsx)(h.Zp,{className:a,children:(0,d.jsx)(h.Wu,{className:"pt-6",children:(0,d.jsxs)("div",{className:"animate-pulse space-y-4",children:[(0,d.jsx)("div",{className:"h-4 bg-gray-200 rounded w-3/4"}),(0,d.jsx)("div",{className:"h-4 bg-gray-200 rounded w-1/2"})]})})}):(0,d.jsxs)(h.Zp,{className:a,children:[(0,d.jsxs)(h.aR,{children:[(0,d.jsxs)(h.ZB,{className:"flex items-center gap-2",children:[(0,d.jsx)(k.A,{className:"h-5 w-5"}),"Autentica\xe7\xe3o de Dois Fatores (2FA)"]}),(0,d.jsx)(h.BT,{children:b?.enabled?"Sua conta est\xe1 protegida com autentica\xe7\xe3o de dois fatores":"Adicione uma camada extra de seguran\xe7a \xe0 sua conta"})]}),(0,d.jsxs)(h.Wu,{className:"space-y-6",children:[(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsxs)("div",{className:"space-y-1",children:[(0,d.jsxs)("h3",{className:"font-medium flex items-center gap-2",children:[(0,d.jsx)(l.A,{className:"h-4 w-4"}),"Status do 2FA"]}),(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(0,d.jsx)(f.E,{variant:b?.enabled?"default":"outline",className:b?.enabled?"text-green-600 bg-green-50 border-green-600":"text-red-600 border-red-600",children:b?.enabled?"Habilitado":"Desabilitado"}),b?.enabled&&(0,d.jsxs)("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:["desde ",(0,s.GP)(new Date(b.created_at),"dd/MM/yyyy",{locale:t.F})]})]})]}),(0,d.jsx)("div",{className:"flex items-center gap-2",children:b?.enabled?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(g.$,{variant:"outline",size:"sm",asChild:!0,children:(0,d.jsx)(q(),{href:"/dashboard/security/2fa",children:"Gerenciar"})}),(0,d.jsxs)(j.Lt,{open:z,onOpenChange:A,children:[(0,d.jsx)(j.tv,{asChild:!0,children:(0,d.jsx)(g.$,{variant:"outline",size:"sm",className:"text-red-600 border-red-600 hover:bg-red-50",children:"Desabilitar"})}),(0,d.jsxs)(j.EO,{children:[(0,d.jsxs)(j.wd,{children:[(0,d.jsxs)(j.r7,{className:"flex items-center gap-2",children:[(0,d.jsx)(m.A,{className:"h-5 w-5 text-red-600"}),"Desabilitar Autentica\xe7\xe3o 2FA"]}),(0,d.jsx)(j.$v,{children:"Tem certeza que deseja desabilitar a autentica\xe7\xe3o de dois fatores? Isso tornar\xe1 sua conta menos segura."})]}),(0,d.jsxs)(j.ck,{children:[(0,d.jsx)(j.Zr,{children:"Cancelar"}),(0,d.jsx)(j.Rx,{onClick:F,disabled:x,className:"bg-red-600 hover:bg-red-700",children:x?"Desabilitando...":"Desabilitar 2FA"})]})]})]})]}):(0,d.jsx)(g.$,{asChild:!0,children:(0,d.jsx)(q(),{href:"/auth/2fa/setup",children:"Configurar 2FA"})})})]}),b?.enabled&&(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(i.Separator,{}),(0,d.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,d.jsxs)("div",{className:"text-center p-4 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[(0,d.jsx)(n.A,{className:"h-6 w-6 mx-auto mb-2 text-blue-600"}),(0,d.jsx)("div",{className:"text-2xl font-bold",children:B}),(0,d.jsx)("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Dispositivos Confi\xe1veis"})]}),(0,d.jsxs)("div",{className:"text-center p-4 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[(0,d.jsx)(k.A,{className:"h-6 w-6 mx-auto mb-2 text-green-600"}),(0,d.jsx)("div",{className:"text-2xl font-bold",children:b.backup_codes_count||0}),(0,d.jsx)("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"C\xf3digos de Backup"})]}),(0,d.jsxs)("div",{className:"text-center p-4 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[(0,d.jsx)(o.A,{className:"h-6 w-6 mx-auto mb-2 text-purple-600"}),(0,d.jsx)("div",{className:"text-sm font-medium",children:D?(0,s.GP)(D,"dd/MM HH:mm",{locale:t.F}):"N/A"}),(0,d.jsx)("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"\xdaltimo Login"})]})]}),(0,d.jsx)(i.Separator,{}),(0,d.jsxs)("div",{className:"space-y-3",children:[(0,d.jsx)("h4",{className:"font-medium text-sm text-gray-900 dark:text-white",children:"A\xe7\xf5es R\xe1pidas"}),(0,d.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,d.jsx)(g.$,{variant:"outline",size:"sm",asChild:!0,children:(0,d.jsx)(q(),{href:"/dashboard/security/2fa",children:"Ver Dispositivos"})}),(0,d.jsx)(g.$,{variant:"outline",size:"sm",onClick:()=>u(),children:"Gerar Novos C\xf3digos"}),(0,d.jsx)(g.$,{variant:"outline",size:"sm",asChild:!0,children:(0,d.jsx)(q(),{href:"/dashboard/security/2fa",children:"Ver Logs"})})]})]})]})]})]})}},32769:(a,b,c)=>{c.d(b,{A:()=>d});let d=(0,c(26373).A)("settings",[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},48730:(a,b,c)=>{c.d(b,{A:()=>d});let d=(0,c(62688).A)("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]])},51358:(a,b,c)=>{c.d(b,{BT:()=>j,Wu:()=>k,ZB:()=>i,Zp:()=>g,aR:()=>h});var d=c(37413),e=c(61120),f=c(66819);let g=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)("div",{ref:c,className:(0,f.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",a),...b}));g.displayName="Card";let h=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)("div",{ref:c,className:(0,f.cn)("flex flex-col space-y-1.5 p-6",a),...b}));h.displayName="CardHeader";let i=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)("h3",{ref:c,className:(0,f.cn)("text-2xl font-semibold leading-none tracking-tight",a),...b}));i.displayName="CardTitle";let j=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)("p",{ref:c,className:(0,f.cn)("text-sm text-muted-foreground",a),...b}));j.displayName="CardDescription";let k=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)("div",{ref:c,className:(0,f.cn)("p-6 pt-0",a),...b}));k.displayName="CardContent",e.forwardRef(({className:a,...b},c)=>(0,d.jsx)("div",{ref:c,className:(0,f.cn)("flex items-center p-6 pt-0",a),...b})).displayName="CardFooter"},54781:(a,b,c)=>{c.d(b,{E:()=>f});var d=c(37413),e=c(66819);function f({className:a,...b}){return(0,d.jsx)("div",{className:(0,e.cn)("animate-pulse rounded-md bg-muted",a),...b})}},55192:(a,b,c)=>{c.d(b,{BT:()=>j,Wu:()=>k,ZB:()=>i,Zp:()=>g,aR:()=>h});var d=c(60687),e=c(43210),f=c(96241);let g=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)("div",{ref:c,className:(0,f.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",a),...b}));g.displayName="Card";let h=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)("div",{ref:c,className:(0,f.cn)("flex flex-col space-y-1.5 p-6",a),...b}));h.displayName="CardHeader";let i=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)("h3",{ref:c,className:(0,f.cn)("text-2xl font-semibold leading-none tracking-tight",a),...b}));i.displayName="CardTitle";let j=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)("p",{ref:c,className:(0,f.cn)("text-sm text-muted-foreground",a),...b}));j.displayName="CardDescription";let k=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)("div",{ref:c,className:(0,f.cn)("p-6 pt-0",a),...b}));k.displayName="CardContent",e.forwardRef(({className:a,...b},c)=>(0,d.jsx)("div",{ref:c,className:(0,f.cn)("flex items-center p-6 pt-0",a),...b})).displayName="CardFooter"},62369:(a,b,c)=>{c.d(b,{b:()=>j});var d=c(43210),e=c(14163),f=c(60687),g="horizontal",h=["horizontal","vertical"],i=d.forwardRef((a,b)=>{var c;let{decorative:d,orientation:i=g,...j}=a,k=(c=i,h.includes(c))?i:g;return(0,f.jsx)(e.sG.div,{"data-orientation":k,...d?{role:"none"}:{"aria-orientation":"vertical"===k?k:void 0,role:"separator"},...j,ref:b})});i.displayName="Separator";var j=i},65223:(a,b,c)=>{c.d(b,{A:()=>d});let d=(0,c(26373).A)("lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]])},66819:(a,b,c)=>{c.d(b,{cn:()=>f});var d=c(75986),e=c(8974);function f(...a){return(0,e.QP)((0,d.$)(a))}},69117:(a,b,c)=>{c.d(b,{A:()=>d});let d=(0,c(26373).A)("shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]])},78377:(a,b,c)=>{c.d(b,{Separator:()=>h});var d=c(60687),e=c(43210),f=c(62369),g=c(96241);let h=e.forwardRef(({className:a,orientation:b="horizontal",decorative:c=!0,...e},h)=>(0,d.jsx)(f.b,{ref:h,decorative:c,orientation:b,className:(0,g.cn)("shrink-0 bg-border","horizontal"===b?"h-[1px] w-full":"h-full w-[1px]",a),...e}));h.displayName=f.b.displayName},81198:(a,b,c)=>{c.d(b,{NL:()=>k});var d=c(43210),e=c(31074),f=c(51423),g=c(54050),h=c(52581),i=c(3560);let j={config:["2fa","config"],trustedDevices:["2fa","trusted-devices"],authLogs:["2fa","auth-logs"],stats:["2fa","stats"]};function k(){let a=(0,e.jE)(),[b,c]=(0,d.useState)(null),{data:k,isLoading:l,error:m}=(0,f.I)({queryKey:j.config,queryFn:()=>i.Z.getConfig(),retry:!1}),{data:n=[],isLoading:o}=(0,f.I)({queryKey:j.trustedDevices,queryFn:()=>i.Z.getTrustedDevices(),enabled:!!k&&k.status===TwoFactorStatus.ENABLED}),{data:p=[],isLoading:q}=(0,f.I)({queryKey:j.authLogs,queryFn:()=>i.Z.getAuthLogs(50),enabled:!!k&&k.status===TwoFactorStatus.ENABLED}),{data:r,isLoading:s}=(0,f.I)({queryKey:j.stats,queryFn:()=>i.Z.getStats(),enabled:!!k&&k.status===TwoFactorStatus.ENABLED}),t=(0,g.n)({mutationFn:a=>i.Z.setupTwoFactor(a),onSuccess:()=>{h.o.success("2FA configurado com sucesso!"),a.invalidateQueries({queryKey:j.config})},onError:a=>{c(a.message),h.o.error(a.message)}}),u=(0,g.n)({mutationFn:a=>i.Z.verifyTwoFactor(a),onError:a=>{c(a.message),h.o.error(a.message)}}),v=(0,g.n)({mutationFn:a=>i.Z.disableTwoFactor(a),onSuccess:()=>{h.o.success("2FA desabilitado com sucesso!"),a.invalidateQueries({queryKey:j.config}),a.removeQueries({queryKey:j.trustedDevices}),a.removeQueries({queryKey:j.authLogs}),a.removeQueries({queryKey:j.stats})},onError:a=>{c(a.message),h.o.error(a.message)}}),w=(0,g.n)({mutationFn:()=>i.Z.regenerateBackupCodes(),onSuccess:()=>{h.o.success("C\xf3digos de backup regenerados!"),a.invalidateQueries({queryKey:j.config})},onError:a=>{c(a.message),h.o.error(a.message)}}),x=(0,g.n)({mutationFn:a=>i.Z.removeTrustedDevice(a),onSuccess:()=>{h.o.success("Dispositivo removido com sucesso!"),a.invalidateQueries({queryKey:j.trustedDevices})},onError:a=>{c(a.message),h.o.error(a.message)}}),y=(0,d.useCallback)(async a=>(c(null),t.mutateAsync(a)),[t]),z=(0,d.useCallback)(async a=>(c(null),u.mutateAsync(a)),[u]),A=(0,d.useCallback)(async a=>(c(null),v.mutateAsync(a)),[v]),B=(0,d.useCallback)(async()=>(c(null),w.mutateAsync()),[w]);return{config:k||null,trustedDevices:n,authLogs:p,stats:r||null,isLoading:l||o||q||s,error:b,setupTwoFactor:y,verifyTwoFactor:z,disableTwoFactor:A,regenerateBackupCodes:B,removeTrustedDevice:(0,d.useCallback)(async a=>(c(null),x.mutateAsync(a)),[x]),refreshConfig:(0,d.useCallback)(async()=>{await a.invalidateQueries({queryKey:j.config}),await a.invalidateQueries({queryKey:j.trustedDevices}),await a.invalidateQueries({queryKey:j.authLogs}),await a.invalidateQueries({queryKey:j.stats})},[a])}}},94592:(a,b,c)=>{c.d(b,{$:()=>j});var d=c(37413),e=c(61120),f=c(70403),g=c(50662),h=c(66819);let i=(0,g.F)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),j=e.forwardRef(({className:a,variant:b,size:c,asChild:e=!1,...g},j)=>{let k=e?f.DX:"button";return(0,d.jsx)(k,{className:(0,h.cn)(i({variant:b,size:c,className:a})),ref:j,...g})});j.displayName="Button"},99455:(a,b,c)=>{c.d(b,{E:()=>h});var d=c(37413);c(61120);var e=c(50662),f=c(66819);let g=(0,e.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function h({className:a,variant:b,...c}){return(0,d.jsx)("div",{className:(0,f.cn)(g({variant:b}),a),...c})}},99891:(a,b,c)=>{c.d(b,{A:()=>d});let d=(0,c(62688).A)("shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]])}};